<!DOCTYPE html>
    <html>
    <head>
        <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
        <title>Windows Admin</title>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
        <link href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css" rel="stylesheet" type="text/css">
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        <style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        
        <script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script>
    </head>
    <body>
        <h1 id="windows-admin">Windows Admin</h1>
<p>/TODO Copy in OneNote notes</p>
<p>[&quot;D:\ASUSsync\VS Code\md\res&quot;](D:\ASUSsync\VS Code\md\res)</p>
<h2 id="notes">Notes</h2>
<p>Note for Windows users on 64-bit systems</p>
<ul>
<li>Progra~1 = 'Program Files'</li>
<li>Progra~2 = 'Program Files(x86)'</li>
</ul>
<h2 id="vs-code">VS Code</h2>
<p>code _ , where _ is</p>
<ul>
<li><code>.</code>(period) Open Code in the Current dir</li>
</ul>
<h2 id="windows-functions">Windows Functions</h2>
<p><code>msconfig</code> - get to <strong>safe mode</strong></p>
<h3 id="shell-config">Shell Config</h3>
<h4 id="environment-vars">Environment Vars</h4>
<p>see with <code>gci env:</code> in Powershell,</p>
<h4 id="start-menu-location">Start Menu Location</h4>
<p><code>C:\Users\%USERNAME%\AppData\Roaming\Microsoft\Windows\Start Menu</code>
<code>%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu</code>
<code>C:\ProgramData\Microsoft\Windows\Start Menu</code></p>
<h3 id="windows-search">Windows Search</h3>
<p>The search includes text in the file name, text in the file, tags (a custom file property), and other file properties.</p>
<p>In the Search box, you can perform advanced searches by specifying properties and using boolean filters.</p>
<p>For example, <code>Name:Agenda</code> finds only files that have the word <em>agenda</em> in the file name.</p>
<p>In addition, you can use boolean filters, such as <code>AND</code>, <code>NOT</code>, <code>OR</code>, <strong>Quotes,</strong> <strong>Parentheses,</strong> <code>&gt;</code>, or <code>&lt;</code>.</p>
<p>For example, <em>&quot;Agenda AND Report&quot;</em> find files that contain both words <em>agenda</em> and <em>report.</em></p>
<p>When you type boolean filters, you need to <strong>use all capital letters.</strong></p>
<p>You can also combine properties and boolean filters together to create a more specific search.</p>
<p>[[Search Examples]]</p>
<table>
<thead>
<tr>
<th>Example</th>
<th>Description: *  Finds files that: *</th>
</tr>
</thead>
<tbody>
<tr>
<td>agenda AND report</td>
<td>*contain both agenda and report.</td>
</tr>
<tr>
<td>agenda NOT report</td>
<td>*contain agenda, but not report.</td>
</tr>
<tr>
<td>agenda OR report</td>
<td>*contain either agenda or report.</td>
</tr>
<tr>
<td>“Agenda Report”</td>
<td>*contain exact phrase “Agenda Report” (in quotes.)</td>
</tr>
<tr>
<td>(agenda report)</td>
<td>*contain both words agenda &amp; report, any order.</td>
</tr>
<tr>
<td>date: &gt;10/10/08</td>
<td>*are later than 10/10/08.</td>
</tr>
<tr>
<td>size: &lt; 100 MB</td>
<td>*are less than 100 MB.</td>
</tr>
<tr>
<td>subject: agenda AND report</td>
<td>*with sub 'agenda'&amp; any that contain 'report'</td>
</tr>
</tbody>
</table>
<p>Turn off natural language search. (default off).
Click the Start button, click Control Panel, click Appearance and Personalization, click Folder Options, click the Search tab, clear the Use natural language search check box, and then click OK.</p>
<h2 id="keyboard-shortcuts">Keyboard SHortcuts</h2>
<h3 id="windows-keys">Windows Keys</h3>
<p>Left Windows + ...</p>
<p>[T] = Cycle Task Bar Apps
[U] = Open Ease of Access Center
[=] = Open Magnifier
[M] = Minimize all Windows
[Tab] = Open Task View
[R] = Run Dialogue
[K] = Open Quick Connect
[I] = Open Windows Settins
[E] = Open File Explorer
[L] = Lock
[G] = Windows Game Bar
[.] = Open Emoji Panel
[S] = Open Search
[A] = Open Action Center
[D] = Hide/Show Desktop
[X] = Open Quick Links
[Ctrl] + [Enter] = Open Narrator
[B] = Set Focus in Notification Area</p>
<p>[Ctrl] + [Shift] + [Esc] = Open Task Manager
[Ctrl] + [Esc] = Open Start
[Alt] + [Tab] = Switch Between Apps
[Alt] + [Esc] = Cycle Between Apps
[Alt] + [Left] = Go Back
[Alt] + [Right] = Go Forward</p>
<h2 id="basic-commands">Basic Commands</h2>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>assoc</td>
<td>Displays or modifies file name extension associations.[1]</td>
</tr>
<tr>
<td>at</td>
<td>Schedules commands to run on a computer at a specified time [2]</td>
</tr>
<tr>
<td>attrib</td>
<td>Configures file attributes read only, hidden, system</td>
</tr>
<tr>
<td>bootcfg</td>
<td>Used to repair or edit the boot.ini file</td>
</tr>
<tr>
<td>cd or chdir</td>
<td>Displays the name of the current directory or changes the current folder</td>
</tr>
<tr>
<td>chkdsk</td>
<td>Checks hard drives for errors. With switches,does repairs.</td>
</tr>
<tr>
<td>cls</td>
<td>Clears the screen</td>
</tr>
<tr>
<td>copy</td>
<td>Copies a file from one location to another</td>
</tr>
<tr>
<td>del</td>
<td>Deletes one or more files</td>
</tr>
<tr>
<td>dir</td>
<td>Displays a list of a folder's files and subfolders</td>
</tr>
<tr>
<td>diskpart</td>
<td>Disk management shell. A suite of various commands</td>
</tr>
<tr>
<td>driverquery</td>
<td>Displays a list of all installed device drivers and their properties. [3]</td>
</tr>
<tr>
<td>echo</td>
<td>Used to display a message or to turn off/on messages in batch scripts</td>
</tr>
<tr>
<td>exit</td>
<td>Exits batch script or current command control</td>
</tr>
<tr>
<td>fc</td>
<td>Compares two files and displays the differences between them</td>
</tr>
<tr>
<td>find</td>
<td>Searches for a text string in a file or files. [4]</td>
</tr>
<tr>
<td>findstr</td>
<td>Searches for text string patterns in a file using regular expressions</td>
</tr>
<tr>
<td>for</td>
<td>Runs a specified command for each item in a set</td>
</tr>
<tr>
<td>fsutil</td>
<td>Displays and configures certain file system properties. Suite</td>
</tr>
<tr>
<td>ftype</td>
<td>Displays or modifies file types used in file name extension associations</td>
</tr>
<tr>
<td>getmac</td>
<td>Returns the media access control (MAC) address for your network card</td>
</tr>
<tr>
<td>goto</td>
<td>Directs the command interpreter to a labeled line in a batch program</td>
</tr>
<tr>
<td>if</td>
<td>Performs conditional processing in batch programs</td>
</tr>
<tr>
<td>ipconfig</td>
<td>Displays TCP/IP network config and refreshes DHCP and DNS[5]</td>
</tr>
<tr>
<td>md or mkdir</td>
<td>Creates a directory (folder) or subdirectory (subfolder)</td>
</tr>
<tr>
<td>more</td>
<td>Displays output one screen at a time. Used with another command</td>
</tr>
<tr>
<td>move</td>
<td>Moves a file from one folder to another</td>
</tr>
<tr>
<td>net</td>
<td>A suite of various networking and service commands</td>
</tr>
<tr>
<td>netsh</td>
<td>Network services shell . Complex suite of commands.</td>
</tr>
<tr>
<td>netstat</td>
<td>Displays active TCP con. ports on which the computer is listening,+ [6]</td>
</tr>
<tr>
<td>path</td>
<td>Sets the command path in the PATH environment variable, [7]</td>
</tr>
<tr>
<td>pathping</td>
<td>Network performance and conditions at intermediate hops btw host and dest.</td>
</tr>
<tr>
<td>pause</td>
<td>Used in batch scripts</td>
</tr>
<tr>
<td>ping</td>
<td>Checks connectivity to other networked computers</td>
</tr>
<tr>
<td>popd, pushd</td>
<td>Changes the directory being referenced in a command prompt. [8]</td>
</tr>
<tr>
<td>powercfg</td>
<td>Manages the power settings such as hibernation. Has numerous switches</td>
</tr>
<tr>
<td>reg</td>
<td>Adds, changes, and displays registry entries. A suite of various commands</td>
</tr>
<tr>
<td>rd or rmdir</td>
<td>Deletes a directory (folder)</td>
</tr>
<tr>
<td>ren or rename</td>
<td>Changes the name of a file or a set of files</td>
</tr>
<tr>
<td>sc</td>
<td>Used to obtain information about services and to configure them. Suite.</td>
</tr>
<tr>
<td>schtasks</td>
<td>Schedules commands and programs to run periodically or at a specific time</td>
</tr>
<tr>
<td>set</td>
<td>Displays, sets, or removes environment variables</td>
</tr>
<tr>
<td>sfc</td>
<td>System file checker scans and verifies all protected system files</td>
</tr>
<tr>
<td>shutdown</td>
<td>Shuts down or restarts a computer</td>
</tr>
<tr>
<td>sort</td>
<td>Alphabetizes strings from a text file or the output of a command.</td>
</tr>
<tr>
<td>start</td>
<td>Starts an application or opens a new command window</td>
</tr>
<tr>
<td>subst</td>
<td>Associates a folder with a drive letter</td>
</tr>
<tr>
<td>systeminfo</td>
<td>Displays configuration information on computer and OS</td>
</tr>
<tr>
<td>taskkill</td>
<td>Ends one or more tasks or processes</td>
</tr>
<tr>
<td>tasklist</td>
<td>Lists running tasks, applications and services with their PID</td>
</tr>
<tr>
<td>tree</td>
<td>Graphically displays the directory structure of a folder or drive</td>
</tr>
<tr>
<td>type</td>
<td>Displays the contents of a text file</td>
</tr>
<tr>
<td>vssadmin</td>
<td>For administering and configuring volume shadow copies</td>
</tr>
<tr>
<td>xcopy</td>
<td>Tool for copying and backing up files and folders</td>
</tr>
</tbody>
</table>
<ol>
<li>Used alone, displays a list of all the current file name associations</li>
<li>Requires the Schedule service. Superseded by schtasks</li>
<li>Requires administrator privileges. (Not available in Windows XP Home)</li>
<li>Can also be used with output from another command.</li>
<li>Dynamic Host Configuration Protocol (DHCP) and Domain Name System (DNS) settings</li>
<li>Ethernet statistics, the IP routing table, statistics for the IP, ICMP, TCP, and UDP protocols</li>
<li>Which is the set of directories used to search for executable files</li>
<li>Pushd changes the directory and stores the previous directory. Popd changes the current directory to the directory stored by the pushd command
=======</li>
</ol>
<ul>
<li><code>Command</code>- Description|</li>
<li><code>-------------</code>- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------</li>
<li><code>assoc</code>- Displays or modifies file name extension associations. Used alone, displays a list of all the current file name associations</li>
<li><code>at</code>- Schedules commands and programs to run on a computer at a specified time and date. Requires the Schedule service. Superseded by schtasks</li>
<li><code></code>-</li>
<li><code>attrib</code>- Configures file attributes read only, hidden, system</li>
<li><code>bootcfg</code>- Used to repair or edit the boot.ini file</li>
<li><code>cd or chdir</code>- Displays the name of the current directory or changes the current folder</li>
<li><code>chkdsk</code>- Checks hard drives for errors. With switches,does repairs.</li>
<li><code>cls</code>- Clears the screen</li>
<li><code>copy</code>- Copies a file from one location to another</li>
<li><code>del</code>- Deletes one or more files</li>
<li><code>dir</code>- Displays a list of a folder's files and subfolders</li>
<li><code>diskpart</code>- Disk management shell. A suite of various commands</li>
<li><code>driverquery</code>- Displays a list of all installed device drivers and their properties. Requires administrator privileges. (Not available in Windows XP Home)</li>
<li><code>echo</code>- Used to display a message or to turn off/on messages in batch scripts</li>
<li><code>exit</code>- Exits batch script or current command control</li>
<li><code>fc</code>- Compares two files and displays the differences between them</li>
<li><code>find</code>- Searches for a text string in a file or files. Can also be used with output from another command.</li>
<li><code>findstr</code>- Searches for text string patterns in a file using regular expressions</li>
<li><code>for</code>- Runs a specified command for each item in a set</li>
<li><code>fsutil</code>- Displays and configures certain file system properties. A suite of various commands</li>
<li><code>ftype</code>- Displays or modifies file types used in file name extension associations</li>
<li><code>getmac</code>- Returns the media access control (MAC) address for your network card</li>
<li><code>goto</code>- Directs the Windows command interpreter to a labeled line in a batch program</li>
<li><code>if</code>- Performs conditional processing in batch programs</li>
<li><code>ipconfig</code>- Displays all current TCP/IP network configuration values and refreshes Dynamic Host Configuration Protocol (DHCP) and Domain Name System (DNS) settings</li>
<li><code>md or mkdir</code>- Creates a directory (folder) or subdirectory (subfolder)</li>
<li><code>more</code>- Displays one screen of output at a time. Used with another command that has extensive output</li>
<li><code>move</code>- Moves a file from one folder to another</li>
<li><code>net</code>- A suite of various networking and service commands</li>
<li><code>netsh</code>- Network services shell . Complex suite of commands.</li>
<li><code>netstat</code>- Displays active TCP connections, ports on which the computer is listening, Ethernet statistics, the IP routing table, statistics for the IP, ICMP, TCP, and UDP protocols</li>
<li><code>path</code>- Sets the command path in the PATH environment variable, which is the set of directories used to search for executable files</li>
<li><code>pathping</code>- Provides information about network performance and conditions at intermediate hops between a source and destination</li>
<li><code>pause</code>- Used in batch scripts</li>
<li><code>ping</code>- Checks connectivity to other networked computers, routers, or Internet sites</li>
<li><code>popd, pushd</code>- Changes the directory being referenced in a command prompt. Pushd changes the directory and stores the previous directory. Popd changes the current directory to the directory stored by the pushd command</li>
<li><code>powercfg</code>- Manages the power settings such as hibernation. Has numerous switches</li>
<li><code>reg</code>- Adds, changes, and displays registry entries. A suite of various commands</li>
<li><code>rd or rmdir</code>- Deletes a directory (folder)</li>
<li><code>ren or rename</code>- Changes the name of a file or a set of files</li>
<li><code>sc</code>- Used to obtain information about services and to configure them. A suite of various commands</li>
<li><code>schtasks</code>- Schedules commands and programs to run periodically or at a specific time</li>
<li><code>set</code>- Displays, sets, or removes environment variables</li>
<li><code>sfc</code>- System file checker scans and verifies the versions of all protected system files</li>
<li><code>shutdown</code>- Shuts down or restarts a computer</li>
<li><code>sort</code>- Alphabetizes strings from a text file or the output of a command.</li>
<li><code>start</code>- Starts an application or opens a new command window</li>
<li><code>subst</code>- Associates a folder with a drive letter</li>
<li><code>systeminfo</code>- Displays detailed configuration information about a computer and its operating system</li>
<li><code>taskkill</code>- Ends one or more tasks or processes</li>
<li><code>tasklist</code>- Displays a list of applications and services with their Process ID (PID) for all tasks running</li>
<li><code>tree</code>- Graphically displays the directory structure of a folder or drive</li>
<li><code>type</code>- Displays the contents of a text file</li>
<li><code>vssadmin</code>- For administering and configuring volume shadow copies</li>
<li><code>xcopy</code>- Powerful command with many switches for copying and backing up files and folders</li>
</ul>
<h3 id="list-com-interfaces">List COM interfaces</h3>
<p>Where can I find all of the COM objects that can be created in Powershell?</p>
<p>gci HKLM:\Software\Classes -ea 0| ? {_.PSChildName -match '^\w+\.\w+' -and
(gp &quot;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>(</mo></mrow><annotation encoding="application/x-tex">(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span></span></span></span>_.PSPath)\CLSID&quot; -ea 0)} | ft PSChildName</p>
<p>From <a href="https://stackoverflow.com/questions/660319/where-can-i-find-all-of-the-com-objects-that-can-be-created-in-powershell">https://stackoverflow.com/questions/660319/where-can-i-find-all-of-the-com-objects-that-can-be-created-in-powershell</a></p>
<p>How to get a list of COM objects via WMI &amp; PowerShell
Posted: October 26th, 2013 | Tags: COM, wmi | Category: PowerShell | § 
Let’s see what WMI can tell us about COM objects on the system.
Get a list of all WMI classes with the word “COM” in them (doing a case sensitive match to avoid entries like “computer”).</p>
<pre><code class="language-ps1"><div>1   PS&gt; gwmi -list | ?{ $_.Name -cmatch &quot;COM&quot; }
2    
3      NameSpace: ROOT\cimv2
4    
5   Name                                Methods              Properties
6   ----                                -------              ----------
7   MSFT_WMI_GenericNonCOMEvent         {}                   {ProcessId, PropertyNames, PropertyValues, ProviderName...}
8   Win32_COMApplication                {}                   {Caption, Description, InstallDate, Name...}
9   Win32_DCOMApplication               {}                   {AppID, Caption, Description, InstallDate...}
10  Win32_COMClass                      {}                   {Caption, Description, InstallDate, Name...}
11  Win32_ClassicCOMClass               {}                   {Caption, ComponentId, Description, InstallDate...}
12  Win32_COMSetting                    {}                   {Caption, Description, SettingID}
13  Win32_ClassicCOMClassSetting        {}                   {AppID, AutoConvertToClsid, AutoTreatAsClsid, Caption...}
14  Win32_DCOMApplicationSetting        {GetLaunchSecurit... {AppID, AuthenticationLevel, Caption, CustomSurrogate...}
15  Win32_ClassicCOMClassSettings       {}                   {Element, Setting}
16  Win32_COMApplicationSettings        {}                   {Element, Setting}
17  Win32_DCOMApplicationAccessAllow... {}                   {Element, Setting}
18  Win32_COMApplicationClasses         {}                   {GroupComponent, PartComponent}
19  Win32_ClassicCOMApplicationClasses  {}                   {GroupComponent, PartComponent}
20  Win32_DCOMApplicationLaunchAllow... {}                   {Element, Setting}
</div></code></pre>
<h2 id="command-line">Command Line</h2>
<h3 id="more-generally-the-syntax">More Generally, the syntax</h3>
<p>The following table describes the notation used to indicate <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/command-line-syntax-key">command-line syntax.</a></p>
<table>
<thead>
<tr>
<th>Notation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Text without brackets or braces</td>
<td>Items you must type as shown</td>
</tr>
<tr>
<td><Text inside angle brackets></td>
<td>Placeholder for which you must supply a value</td>
</tr>
<tr>
<td>[Text inside square brackets]</td>
<td>Optional items</td>
</tr>
<tr>
<td>{Text inside braces}</td>
<td>Set of required items; choose one</td>
</tr>
<tr>
<td>Vertical bar (|)</td>
<td>Separator for mutually exclusive items; choose one</td>
</tr>
<tr>
<td>Ellipsis (…)</td>
<td>Items that can be repeated</td>
</tr>
</tbody>
</table>
<h3 id="more">More</h3>
<p><a href="https://ss64.com/nt/for.html">SS64 Batch Help</a></p>
<p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/windows-commands">Microsoft (Server) Reference</a></p>
<p>remote desktop command line (use /console if all slots full)
c:&gt; mstsc /v:SERVERNAME [/console]
list other RDP sessions on the server
c:&gt; query session
kick someone off -- useful when paired with sysinternals psexec, or powershell remoting
c:&gt; logoff SESSIONID</p>
<p>use mstsc /admin instead. Use mstsc /? for a list of commands.</p>
<p>Never knew aboput clip, and while investigating a problem yesterday I found another command I knew nothing about, the &quot;where&quot; command, it displays the location of a file.</p>
<p>where dotnet.exe
C:\Program Files\dotnet\dotnet.exe</p>
<p>Create a text file
copy con lazydog.txt
The quick brown fox jumps over the lazy dog
Ctrl-z</p>
<p>cd \win*
type *.log[tab][tab][tab][tab]
cd syste[tab][tab]</p>
<p>Command prompt also supports drag and drop: If you want to copy the exact path to a folder or file to run the file or change the present working directory, you can simply drag and drop the file or the folder on the command prompt.
And there are more command history features available via function keys:
F1: Pastes per character last used command
F2: Pastes last used command only to a specified command character
F3: Pastes Last used command
F4: Delete command only to a specified command character
F5: Pastes last used command without cycling
F6: Pastes ^Z
F7: Provides a list of already used commands (selectable)
F8: Pastes cycleable used commands
F9: Will let you paste command from the list of recently used commands</p>
<p>I didn't know about clip, but then I've been using the UnxUtils collection for years and that has gclip, which does the same thing. I would probably have discovered clip by now if it wasn't for that.
Someone mentioned pushd and popd; there's a good use case for these that people may not be aware of. While you can navigate to a UNC path in File Explorer you can't cd to one on the command line, but you can use pushd to achieve the same thing. It will actually map a drive to the share with the next available drive letter, before changing to the directory. When the previous directory is popped off the stack with popd, the mapped drive is released.
I find Rob van der Woude's Scripting Pages to be a great resource for researching command line and batch language stuff. Look under Scripting Languages | Batch Files in the sidebar. There is info on a number of other scripting languages there too.
<a href="http://www.robvanderwoude.com/">http://www.robvanderwoude.com/</a></p>
<p>copy con autoexec.bat
prompt <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi></mrow><annotation encoding="application/x-tex">p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">p</span></span></span></span>g
win
^Z</p>
<p>Redirecting output to txtfile always handy
Like:
dir /b | find &quot;.exe&quot; &gt; findlist.txt | notepad findlist.txt
<a href="https://technet.microsoft.com/en-us/library/bb490982.aspx">https://technet.microsoft.com/en-us/library/bb490982.aspx</a></p>
<p>SET /A for integer arithmetic, including bitwise operators.
The FOR command, for, well, just about anything. FORFILES.EXE, for one special case thereof.
DOSKEY.EXE for command prompt macros, and also macros for any command-line application.
GETMAC.EXE for getting adapter MAC addresses on the command line.
The CMD batch language itself.
And many, many more...</p>
<p>@echo off
setlocal
if &quot;%echo%&quot; neq &quot;&quot; echo %echo%
pushd %~dp0
What it does:
turn off output of commands.
make changes to the environment local to the script
check if the env-var echo contains something. by doing &quot;set echo=on&quot; before calling the script I can switch on output of commands for debugging.
Set the current directory to the scripts directory. this is optional, but most of my scripts assume relative path (My old saying: The absolute path is the singleton of config management)</p>
<p>Catching errors:
dir I-do-not-exist || goto :error
goto :eof
:error
echo ERROR in %~dpnx0 %*
exit /b 1
Explanation:
&quot;||&quot; executes the follwing command if the first fails
skip the &quot;:error&quot; block
echo the file in which the error occured (full path) and all the parameters
return some error code</p>
<p>Something I always have to do on new machines is create a new environment variable DIRCMD and set to /ogn
setx DIRCMD /ogn
Then output from 'dir' is always sorted correctly with directories grouped at the top, can't believe it's not the default</p>
<p>I often use findstr to locate strings in files. A 'memory helper' for parameters is 'sin' to search for sub directories, case insensitive, display line number. Example to find foobar in txt files:
findstr /s /i /n foobar *.txt</p>
<p>doskey.exe can clear, set the size of, and list the command history of an executable that's attached to the current console. The implementation uses the following undocumented console APIs:
doskey /reinstall /exename=[ExeName]
VOID ExpungeConsoleCommandHistory(LPTSTR ExeName)
doskey /listsize=[Number] /exename=[ExeName]
BOOL SetConsoleNumberOfCommands(DWORD Number,
LPTSTR ExeName)
doskey /history /exename=[ExeName]
DWORD GetConsoleCommandHistoryLength(LPTSTR ExeName)
DWORD GetConsoleCommandHistory(LPTSTR CommandBuffer,
DWORD CommandBufferLength,
LPTSTR ExeName)
I can't be the only person frustrated by how opening a new console doesn't load the command history from previous (not current) instances of console applications. The console needs a SetConsoleCommandHistory function. Please ask the team that owns the console subsystem (conhost.exe, conhostv2.dll, condrv.sys) and doskey.exe to implement something like this -- and to document these functions as public APIs. A doskey &quot;/historyfile&quot; option could support [ExeName] sections, like the current &quot;/macrofile&quot; option.
cmd.exe supports an AutoRun registry value, which would allow running doskey.exe to load command history, but it doesn't allow automatically saving history. I'd prefer that cmd.exe handled this automatically (but only for its own history) by appending to a per-user history file stored in &quot;%APPDATA%\Microsoft\Command Processor\history.txt&quot;, which reflects the location of its registry key, &quot;HKCU\SOFTWARE\Microsoft\Command Processor&quot;.</p>
<p>Sorry, one more favorite of mine
start .
Open a File Explorer for the current directory. Because sometimes dir doesn't cut it.</p>
<p>dir /s | more
for pausing output per page</p>
<p>dir /a,
Hidden dir parameter - shows all files (hidden, system, etc) without have to specify the full list of things to unhide. (note that is a comma after the &quot;/a&quot;)</p>
<p>&quot;mklink&quot; is a good use of &quot;cmd&quot;. I prefer symbolic links to shortcuts. I haven't seen a way to make symbolic links in the file manager.</p>
<p>Try this on command line on NTFS drive:
echo hidden &gt; test.txt:hidden
echo hidden2 &gt;&gt; test.txt:hidden
do a dir test.txt , what's the file size?
do a type test.txt or use notepad to edit , it's empty
do a more &lt; test.txt:hidden
you see what you have echo and pipe and append into the test.txt section hidden ;-)</p>
<p>hostname
whoami</p>
<p>Don't forget pushd and popd.
'Pushd' changes directory to the parameter and remembers the current directory on a stack. It's a little better than 'cd' because you can also change folders and drive letters in one command.
'Popd' pops the directory off the stack and changes to it -- including changing drive letters.
So with pushd and popd you can really drill in and then pop back. I use a DOSKEY macrofile that makes 'cd' a macro for pushd and '.' a macro for popd. This turns the '.' key into a back button.</p>
<p>'Call' for subroutines
To execute a set of custom commands based on command line arguments</p>
<ol>
<li>Parse/validate command line arguments</li>
<li>Use ECHO to write .bat file to execute the sequence of commands</li>
<li>Call that batch file
This provides equivalent function call functionality to bash.
Current command set:</li>
</ol>
<ul>
<li>The built in dos batch commands</li>
<li>gnuwin32 - most of the basic unix commands</li>
<li>sysinternals suite</li>
<li>image processing</li>
<li>optipng - compress and fix badly formatted png files</li>
<li>imagej - open dicom and lots of basic image formats, image processing, opens source</li>
<li>xpdf - extract text from pdf, render pdf pages to 300 or higher dpi image files, extrac images from pdf, split pdf into individual pages, concatenate pdf files into a single pdf, ...</li>
<li>jpegtran - optimize jpeg files, drop partial blocks from edge of file</li>
<li>imagemagick</li>
<li>gnuwin32's tiff2pdf convert a multipage tiff file to a single pdf</li>
<li>media</li>
<li>mplayer</li>
<li>videolan</li>
<li>audio</li>
<li>lame
That's let me watch/convert from most video and audio formats, convert/extract/build pdf files, ...
If VS would only add one thing.....tell the actual DLL that was not found when it reports a DLL or one of its dependencies could not be loaded........................
The OS has the information since it could not find/load the DLL and should have a way to report it back to VS in debug mode.....</li>
</ul>
<h3 id="command-line-commands">Command Line Commands</h3>
<p>ADDUSERS Add or list users to/from a CSV file
ADmodcmd Active Directory Bulk Modify
ARP      Address Resolution Protocol
ASSOC    Change file extension associations•
ATTRIB   Change file attributes
b
BCDBOOT  Create or repair a system partition
BCDEDIT  Manage Boot Configuration Data
BITSADMIN Background Intelligent Transfer Service
BROWSTAT Get domain, browser and PDC info
c
CACLS    Change file permissions
CALL     Call one batch program from another•
CERTREQ  Request certificate from a certification authority
CERTUTIL Utility for certification authority (CA) files and services
CD       Change Directory - move to a specific Folder•
CHANGE   Change Terminal Server Session properties
CHCP     Change the active console Code Page
CHKDSK   Check Disk - check and repair disk problems
CHKNTFS  Check the NTFS file system
<code>CHOICE</code>   Accept keyboard input to a batch file
CIPHER   Encrypt or Decrypt files/folders
CleanMgr Automated cleanup of Temp files, recycle bin
CLIP     Copy STDIN to the Windows clipboard
CLS      Clear the screen•
CMD      Start a new CMD shell
CMDKEY   Manage stored usernames/passwords
COLOR    Change colors of the CMD window•
COMP     Compare the contents of two files or sets of files
COMPACT  Compress files or folders on an NTFS partition
COMPRESS Compress one or more files
CONVERT  Convert a FAT drive to NTFS
COPY     Copy one or more files to another location•
Coreinfo Show the mapping between logical &amp; physical processors
CSCcmd   Client-side caching (Offline Files)
CSVDE    Import or Export Active Directory data
d
DATE     Display or set the date•
DEFRAG   Defragment hard drive
DEL      Delete one or more files•
DELPROF  Delete user profiles
DELTREE  Delete a folder and all subfolders
DevCon   Device Manager Command Line Utility
DIR      Display a list of files and folders•
DIRQUOTA File Server Resource Manager Disk quotas
DIRUSE   Display disk usage
DISKPART Disk Administration
DISKSHADOW Volume Shadow Copy Service
DISKUSE  Show the space used in folders
DISM     Deployment Image Servicing and Management
DNSCMD   Manage DNS servers
DOSKEY   Edit command line, recall commands, and create macros
DriverQuery Display installed device drivers
DSACLs   Active Directory ACLs
DSAdd    Add items to active directory (user group computer)
DSGet    View items in active directory (user group computer)
DSQuery  Search for items in active directory (user group computer)
DSMod    Modify items in active directory (user group computer)
DSMove   Move an Active directory Object
DSRM     Remove items from Active Directory
Dsmgmt   Directory Service Management
e
ECHO     Display message on screen•
ENDLOCAL End localisation of environment changes in a batch file•
ERASE    Delete one or more files•
EVENTCREATE Add a message to the Windows event log
EXIT     Quit the current script/routine and set an errorlevel•
EXPAND   Uncompress CAB files
EXPLORER Open Windows Explorer
EXTRACT  Uncompress CAB files
f
FC       Compare two files
FIND     Search for a text string in a file
FINDSTR  Search for strings in files
FLTMC    Manage MiniFilter drivers
FOR /F   Loop command: against a set of files•
FOR /F   Loop command: against the results of another command•
FOR      Loop command: all options Files, Directory, List•
FORFILES Batch process multiple files
FORMAT   Format a disk
FREEDISK Check free disk space
FSUTIL   File and Volume utilities
FTP      File Transfer Protocol
FTYPE    File extension file type associations•
g
GETMAC   Display the Media Access Control (MAC) address
GOTO     Direct a batch program to jump to a labelled line•
GPRESULT Display Resultant Set of Policy information
GPUPDATE Update Group Policy settings
h
HELP     Online Help
HOSTNAME Display the host name of the computer
i
iCACLS   Change file and folder permissions
IEXPRESS Create a self extracting ZIP file archive
IF       Conditionally perform a command•
IFMEMBER Is the current user a member of a group
IPCONFIG Configure IP
INUSE    Replace files that are in use by the OS
l
LABEL    Edit a disk label
LGPO     Local Group Policy Object utility
LODCTR   Load PerfMon performance counters
LOGMAN   Manage Performance Monitor logs
LOGOFF   Log a user off
LOGTIME  Log the date and time in a file
m
MAKECAB  Create .CAB files
MAPISEND Send email from the command line
MBSAcli  Baseline Security Analyzer
MEM      Display memory usage
MD       Create new folders•
MKLINK   Create a symbolic link (linkd) •
MODE     Configure a system device COM/LPT/CON
MORE     Display output, one screen at a time
MOUNTVOL Manage a volume mount point
MOVE     Move files from one folder to another•
MOVEUSER Move a user from one domain to another
MSG      Send a message
MSIEXEC  Microsoft Windows Installer
MSINFO32 System Information
MSTSC    Terminal Server Connection (Remote Desktop Protocol)
n
NET      Manage network resources
NETDOM   Domain Manager
NETSH    Configure Network Interfaces, Windows Firewall &amp; Remote access
NBTSTAT  Display networking statistics (NetBIOS over TCP/IP)
NETSTAT  Display networking statistics (TCP/IP)
NLSINFO  Display locale information (reskit).
NLTEST   Network Location Test (AD)
NOW      Display the current Date and Time
NSLOOKUP Name server lookup
NTBACKUP Windows Backup folders to tape
NTDSUtil Active Directory Domain Services management
NTRIGHTS Edit user account rights
NVSPBIND Modify network bindings
o
OPENFILES Query or display open files
p
PATH     Display or set a search path for executable files•
PATHPING Trace route plus network latency and packet loss
PAUSE    Suspend processing of a batch file and display a message•
PERMS    Show permissions for a user
PERFMON  Performance Monitor
PING     Test a network connection
POPD     Return to a previous directory saved by PUSHD•
PORTQRY  Display the status of ports and services
POWERCFG Configure power settings
PRINT    Print a text file
PRINTBRM Print queue Backup/Recovery
PRNCNFG  Configure or rename a printer
PRNMNGR  Add, delete, list printers and printer connections
ProcDump Monitor an application for CPU spikes
PROMPT   Change the command prompt•
PsExec     Execute process remotely
PsFile     Show files opened remotely
PsGetSid   Display the SID of a computer or a user
PsInfo     List information about a system
PsKill     Kill processes by name or process ID
PsList     List detailed information about processes
PsLoggedOn Who's logged on (locally or via resource sharing)
PsLogList  Event log records
PsPasswd   Change account password
PsPing     Measure network performance
PsService  View and control services
PsShutdown Shutdown or reboot a computer
PsSuspend  Suspend processes
PUSHD    Save and then change the current directory•
q
QGREP    Search file(s) for lines that match a given pattern
Query Process / QPROCESS  Display processes
Query Session / QWinsta   Display all sessions (TS/Remote Desktop)
Query TermServer /QAppSrv List all servers (TS/Remote Desktop)
Query User    / QUSER     Display user sessions (TS/Remote Desktop)
r
RASDIAL  Manage RAS connections
RASPHONE Manage RAS connections
RD       Delete folder(s)•
RECOVER  Recover a damaged file from a defective disk
REG      Registry: Read, Set, Export, Delete keys and values
REGEDIT  Import or export registry settings
REGSVR32 Register or unregister a DLL
REGINI   Change Registry Permissions
REM      Record comments (remarks) in a batch file•
REN      Rename a file or files•
REPLACE  Replace or update one file with another
Reset Session  Delete a Remote Desktop Session
RMTSHARE Share a folder or a printer
ROBOCOPY Robust File and Folder Copy
ROUTE    Manipulate network routing tables
RUN      Start | RUN commands
RUNAS    Execute a program under a different user account
RUNDLL32 Run a DLL command (add/remove print connections)</p>
<p>s
SC       Service Control
SCHTASKS Schedule a command to run at a specific time
SET      Display, set, or remove session environment variables•
SETLOCAL Control the visibility of environment variables•
SetSPN   Edit Service Principal Names
SETX     Set environment variables
SFC      System File Checker
SHARE    List or edit a file share or print share
ShellRunAs Run a command under a different user account
SHIFT    Shift the position of batch file parameters•
SHORTCUT Create a windows shortcut (.LNK file)
SHUTDOWN Shutdown the computer
SIGCHECK Display file version no. VirusTotal status &amp; timestamp
SLEEP    Wait for x seconds
SLMGR    Software Licensing Management (Vista/2008)
SORT     Sort input
START    Start a program, command or batch file•
STRINGS  Search for ANSI and UNICODE strings in binary files
SUBINACL Edit file and folder Permissions, Ownership and Domain
SUBST    Associate a path with a drive letter
SYSMON   Monitor and log system activity to the Windows event log
SYSTEMINFO List system configuration
t
TAKEOWN  Take ownership of a file
TASKLIST List running applications and services
TASKKILL End a running process
TELNET   Communicate with another host using the TELNET protocol
TIME     Display or set the system time•
TIMEOUT  Delay processing of a batch file/command
TITLE    Set the window title for a CMD.EXE session•
<s>TLIST    Task list with full path</s>
TOUCH    Change file timestamps
TRACERT  Trace route to a remote host
TREE     Graphical display of folder structure
TSDISCON Disconnect a Remote Desktop Session
TSKILL   End a running process
TYPE     Display the contents of a text file•
TypePerf Write performance data to a log file
TZUTIL   Time Zone Utility
v
VER      Display version information•
VERIFY   Verify that files have been saved•
VMConnect Connect to a Hyper-V Virtual Machine
VOL      Display a disk label•
VSSADMIN Display volume shadow copy backups and shadow copy writers/providers.
w
W32TM    Time Service
WAITFOR  Wait for or send a signal
WBADMIN  Windows Backup Admin
WECUTIL  Windows Event Collector Utility
WEVTUTIL Clear event logs, enable/disable/query logs
WHERE    Locate and display files in a directory tree
WHOAMI   Output the current UserName and domain
WINDIFF  Compare the contents of two files or sets of files
WINRM    Windows Remote Management
WINRS    Windows Remote Shell
WMIC     WMI Commands
WPEUTIL  Run WinPE commands
WPR      Windows Performance Recorder
WUSA     Windows Update Standalone Installer
WUAUCLT  Windows Update
x
XCACLS   Change file and folder permissions
XCOPY    Copy files and folders
::       Comment / Remark•</p>
<p>ARP
AT <em>deprecated</em>
A</p>
<h3 id="fsutil">FSUTIL</h3>
<p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/fsutil">A reference</a></p>
<p><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/ff621566(v=ws.11)">Source2</a></p>
<p><strong>You must be logged on as an administrator</strong> or a member of the Administrators group to use Fsutil. The Fsutil command is quite powerful and should be used only by advanced users who have a thorough knowledge of Windows operating systems.</p>
<p>You <strong>have to enable Windows Subsystem for Linux before you can run Fsutil.</strong> Run the following command as Administrator in PowerShell to enable this optional feature:</p>
<p><code>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux</code></p>
<p>You'll be prompted to restart your computer once it's installed. After your computer restarts, you'll be able to run Fsutil as an administrator</p>
<p>C:\temp$ fsutil</p>
<p>---- Commands Supported ----</p>
<ul>
<li>8dot3name       8dot3name management</li>
<li>behavior        Control file system behavior</li>
<li>dirty           Manage volume dirty bit</li>
<li>file            File specific commands</li>
<li>fsinfo          File system information</li>
<li>hardlink        Hardlink management</li>
<li>objectid        Object ID management</li>
<li>quota           Quota management</li>
<li>repair          Self healing management</li>
<li>reparsepoint    Reparse point management</li>
<li>resource        Transactional Resource Manager management</li>
<li>sparse          Sparse file control</li>
<li>tiering         Storage tiering property management</li>
<li>transaction     Transaction management</li>
<li>usn             USN management</li>
<li>volume          Volume management</li>
<li>wim             Transparent wim hosting management</li>
</ul>
<h4 id="subcommand--description">Subcommand &amp; Description</h4>
<ul>
<li>
<p><code>Fsutil 8dot3name</code> - Queries or changes the settings for short name behavior on the system, for example, generates 8.3 character-length file names. Removes short names for all files within a directory. Scans a directory and identifies registry keys that might be impacted if short names were stripped from the files in the directory.</p>
</li>
<li>
<p><code>Fsutil behavior</code> - Queries or sets volume behavior.</p>
</li>
<li>
<p><code>Fsutil dirty</code> - Queries whether the volume's dirty bit is set or sets a volume's dirty bit. When a volume's dirty bit is set, autochk automatically checks the volume for errors the next time the computer is restarted.</p>
</li>
<li>
<p><code>Fsutil file</code> - Finds a file by user name (if Disk Quotas are enabled), queries allocated ranges for a file, sets a file's short name, sets a file's valid data length, sets zero data for a file, creates a new file of a specified size, finds a file ID if given the name, or finds a file link name for a specified file ID.</p>
</li>
<li>
<p><code>Fsutil fsinfo</code> - Lists all drives and queries the drive type, volume information, NTFS-specific volume information, or file system statistics.</p>
</li>
<li>
<p><code>Fsutil hardlink</code> - Lists hard links for a file, or creates a hard link (a directory entry for a file). Every file can be considered to have at least one hard link. On NTFS volumes, each file can have multiple hard links, so a single file can appear in many directories (or even in the same directory, with different names). Because all of the links reference the same file, programs can open any of the links and modify the file. A file is deleted from the file system only after all links to it are deleted. After you create a hard link, programs can use it like any other file name.</p>
</li>
<li>
<p><code>Fsutil objectid</code> - Manages object identifiers, which are used by the Windows operating system to track objects such as files and directories.</p>
</li>
<li>
<p><code>Fsutil quota</code> - Manages disk quotas on NTFS volumes to provide more precise control of network-based storage. Disk quotas are implemented on a per-volume basis and enable both hard- and soft-storage limits to be implemented on a per-user basis.</p>
</li>
<li>
<p><code>Fsutil repair</code> - Queries or sets the self-healing state of the volume. Self-healing NTFS attempts to correct corruptions of the NTFS file system online without requiring Chkdsk.exe to be run. Includes initiating on-disk verification and waiting for repair completion.</p>
</li>
<li>
<p><code>Fsutil reparsepoint</code> - Queries or deletes reparse points (NTFS file system objects that have a definable attribute containing user-controlled data). Reparse points are used to extend functionality in the input/output (I/O) subsystem. They are used for directory junction points and volume mount points. They are also used by file system filter drivers to mark certain files as special to that driver.</p>
</li>
<li>
<p><code>Fsutil resource</code> - Creates a Secondary Transactional Resource Manager, starts or stops a Transactional Resource Manager, displays information about a Transactional Resource Manager or modifies its behavior.</p>
</li>
<li>
<p><code>Fsutil sparse</code> - Manages sparse files. A sparse file is a file with one or more regions of unallocated data in it. A program will see these unallocated regions as containing bytes with the value zero, but no disk space is used to represent these zeros. All meaningful or nonzero data is allocated, whereas all non-meaningful data (large strings of data composed of zeros) is not allocated. When a sparse file is read, allocated data is returned as stored and unallocated data is returned as zeros (by default in accordance with the C2 security requirement specification). Sparse file support allows data to be deallocated from anywhere in the file.</p>
</li>
<li>
<p><code>Fsutil tiering</code> - Enables management of storage tier functions, such as setting and disabling flags and listing of tiers.</p>
</li>
<li>
<p><code>Fsutil transaction</code> - Commits a specified transaction, rolls back a specified transaction, or displays info about the transaction.</p>
</li>
<li>
<p><code>Fsutil usn</code> - Manages the update sequence number (USN) change journal, which provides a persistent log of all changes made to files on the volume.</p>
</li>
<li>
<p><code>Fsutil volume</code> - Manages a volume. Dismounts a volume, queries to see how much free space is available on a disk, or finds a file that is using a specified cluster.</p>
</li>
<li>
<p><code>Fsutil wim</code> - Provides functions to discover and manage WIM-backed files.</p>
</li>
</ul>
<h4 id="a-detailed-list-of-possible-actions-2nd-level">A detailed list of possible actions (2nd Level)</h4>
<ul>
<li>---- 8DOT3NAME Commands Supported ----
<ul>
<li>query   Query the current setting for the shortname behaviour on the system</li>
<li>scan    Scan for impacted registry entries</li>
<li>set     Change the setting that controls the shortname behavior on the system</li>
<li>strip   Remove the shortnames for all files within a directory</li>
</ul>
</li>
<li>---- BEHAVIOR Commands Supported ----
<ul>
<li>query           Query the file system behavior parameters</li>
<li>set             Change the file system behavior parameters
<ul>
<li>allowExtChar</li>
<li>bugcheckOnCorrupt</li>
<li>disable8dot3 [<Volume Path>]</li>
<li>disableCompression</li>
<li>disableCompressionLimit</li>
<li>disableDeleteNotify [NTFS|ReFS]</li>
<li>disableEncryption</li>
<li>disableFileMetadataOptimization</li>
<li>disableLastAccess</li>
<li>disableSpotCorruptionHandling</li>
<li>encryptPagingFile</li>
<li>memoryUsage</li>
<li>mftZone</li>
<li>quotaNotify</li>
<li>symlinkEvaluation</li>
<li>disableWriteAutoTiering [<Volume Path>]</li>
<li>disableTxf [<Volume Path>]</li>
</ul>
</li>
</ul>
</li>
<li>---- DIRTY Commands Supported ----
<ul>
<li>query           Query the dirty bit</li>
<li>set             Set the dirty bit</li>
</ul>
</li>
<li>---- FILE Commands Supported ----
<ul>
<li>createNew                Creates a new file of a specified size</li>
<li>findBySID                Find a file by security identifier</li>
<li>layout                   Query all the information available about the file</li>
<li>optimizeMetadata         Optimize metadata for a file</li>
<li>queryAllocRanges         Query the allocated ranges for a file</li>
<li>queryCaseSensitiveInfo   Query the case sensitive information for a directory</li>
<li>queryExtents             Query the extents for a file</li>
<li>queryExtentsAndRefCounts Query the extents and their corresponding refcounts for a file</li>
<li>queryFileID              Queries the file ID of the specified file</li>
<li>queryFileNameById        Displays a random link name for the file ID</li>
<li>queryOptimizeMetadata    Query the optimize metadata state for a file</li>
<li>queryValidData           Queries the valid data length for a file</li>
<li>setCaseSensitiveInfo     Set the case sensitive information for a directory</li>
<li>setShortName             Set the short name for a file</li>
<li>setValidData             Set the valid data length for a file</li>
<li>setZeroData              Set the zero data for a file</li>
<li>setEOF                   Sets the end of file for an existing file</li>
<li>setStrictlySequential    Sets ReFS SMR file as strictly sequential</li>
</ul>
</li>
<li>---- FSINFO Commands Supported ----
<ul>
<li>drives          List all drives</li>
<li>driveType       Query drive type for a drive</li>
<li>ntfsInfo        Query NTFS specific volume information</li>
<li>refsInfo        Query REFS specific volume information</li>
<li>sectorInfo      Query sector information</li>
<li>statistics      Query file system statistics</li>
<li>volumeInfo      Query volume information</li>
</ul>
</li>
<li>---- HARDLINK Commands Supported ----
<ul>
<li>create          Create a hardlink</li>
<li>list            Enumerate hardlinks on a file</li>
</ul>
</li>
<li>---- OBJECTID Commands Supported ----
<ul>
<li>create          Create the object identifier</li>
<li>delete          Delete the object identifier</li>
<li>query           Query the object identifier</li>
<li>set             Change the object identifier</li>
</ul>
</li>
<li>---- QUOTA Commands Supported ----
<ul>
<li>disable         Disable quota tracking and enforcement</li>
<li>enforce         Enable quota enforcement</li>
<li>modify          Set disk quota for a user</li>
<li>query           Query disk quotas</li>
<li>track           Enable quota tracking</li>
<li>violations      Display quota violations</li>
</ul>
</li>
<li>---- REPAIR Commands Supported ----
<ul>
<li>enumerate      Enumerate the entries of a volume's corruption log</li>
<li>initiate       Initiate the repair of a file</li>
<li>query          Query the self healing state of the volume</li>
<li>set            Set the self healing state of the volume</li>
<li>state          Query the corruption state of the volume(s)</li>
<li>wait           Wait for repair(s) to complete</li>
</ul>
</li>
<li>---- REPARSEPOINT Commands Supported ----
<ul>
<li>delete          Delete a reparse point</li>
<li>query           Query a reparse point</li>
</ul>
</li>
<li>---- RESOURCE Commands Supported ----
<ul>
<li>create          Create a Secondary Transactional Resource Manager</li>
<li>info            Display information relating to a Transactional Resource Manager</li>
<li>setAutoReset    Set whether a default Transactional Resource Manager will clean its transactional metadata on next mount</li>
<li>setAvailable    Set a Transactional Resource Manager to prefer availability over consistency</li>
<li>setConsistent   Set a Transactional Resource Manager to prefer consistency over availability</li>
<li>setLog          Change characteristics of a running Transactional Resource Manager</li>
<li>start           Start a Transactional Resource Manager</li>
<li>stop            Stop a Transactional Resource Manager</li>
</ul>
</li>
<li>---- SPARSE Commands Supported ----
<ul>
<li>queryFlag       Query sparse</li>
<li>queryRange      Query range</li>
<li>setFlag         Set sparse</li>
<li>setRange        Set sparse range</li>
</ul>
</li>
<li>---- TIERING Commands Supported ----
<ul>
<li>clearFlags      Disable tiering behavior flags of a volume</li>
<li>queryFlags      Display the tiering behavior flags of a volume</li>
<li>regionList      List the regions of a volume and their respective storage tiers</li>
<li>setFlags        Enable tiering behavior flags of a volume</li>
<li>tierList        List the storage tiers associated with a volume</li>
</ul>
</li>
<li>---- TRANSACTION Commands Supported ----
<ul>
<li>commit          Commit a specified transaction</li>
<li>fileinfo        Display transaction information for a specific file</li>
<li>list            Display currently running transactions</li>
<li>query           Display information on a specified transaction</li>
<li>rollback        Rollback a specified transaction</li>
</ul>
</li>
<li>---- USN Commands Supported ----
<ul>
<li>createJournal           Create a USN journal</li>
<li>deleteJournal           Delete a USN journal</li>
<li>enableRangeTracking     Enable write range tracking for a volume</li>
<li>enumData                Enumerate USN data</li>
<li>queryJournal            Query the USN data for a volume</li>
<li>readJournal             Reads the USN records in the USN journal</li>
<li>readData                Read the USN data for a file</li>
</ul>
</li>
<li>---- WIM Commands Supported ----
<ul>
<li>enumFiles           Enumerate WIM backed files</li>
<li>enumWims            Enumerate backing WIM files</li>
<li>removeWim           Remove a WIM from backing files</li>
<li>queryFile           Query the origin of a specific file</li>
</ul>
</li>
</ul>
<h3 id="clip">clip</h3>
<p>PIPE COMMAND OUTPUT TO THE CLIPBOARD
In Vista they added clip.exe. It captures any standard input and puts in the clipboard.</p>
<p>That means you can</p>
<pre><code class="language-bat"><div><span class="hljs-built_in">dir</span> /s | clip
<span class="hljs-built_in">ver</span> | clip
<span class="hljs-built_in">ipconfig</span> /all | clip
</div></code></pre>
<h3 id="type">type</h3>
<p>type followed by the filename prints the contents of the file. Use the pipe (|) and clip to copy to the clipboard. Works in the same way cat does in PowerShell.</p>
<p>type somefile.txt | clip</p>
<h3 id="f7">F7</h3>
<p>F7 GIVES YOU A GRAPHICAL (TEXT) HISTORY</p>
<p>If you have already typed a few commands, you can press F7 to get an ANSI popup with a list of commands you've typed. 4DOS anyone?</p>
<p>F11 or &quot;ALT-ENTER&quot; in the command prompt (any prompt, cmd, powershell, or bash) will make it full screen. I like to put my command prompt on another virtual desktop and then use CTRL-WIN-ARROWS to move between them.</p>
<h3 id="">?</h3>
<p>cd | clip
dir /b /s | clip
mode con rate=32 delay=1
echo AT&amp;F&amp;C1&amp;D2M1L3S11=33 &gt; COM</p>
<h3 id="mpcmdrunexe-windows-defen">mpcmdrun.exe (Windows Defen</h3>
<p><code>MpCmdRun.exe</code> - Runs the Windows Defender Commandline tool, but it is not on path.</p>
<p>Usage: MpCmdRun.exe [command] [-options]</p>
<pre><code class="language-bat"><div><span class="hljs-built_in">cd</span> "<span class="hljs-variable">%ProgramFiles%</span>\Windows Defender\"
MpCmdRun.exe -?
#or better yet- just use:
"<span class="hljs-variable">%ProgramFiles%</span>\Windows Defender\MpCmdRun.exe" -?
</div></code></pre>
<table>
<thead>
<tr>
<th>Command</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-? or -h</td>
<td>Displays all available options for this tool</td>
</tr>
<tr>
<td>-Scan  [^Scan]</td>
<td>Scans for malicious software</td>
</tr>
<tr>
<td>-Trace [^Trace]</td>
<td>Starts diagnostic tracing</td>
</tr>
<tr>
<td>-GetFiles</td>
<td>Collects support information</td>
</tr>
<tr>
<td>-GetFilesDiagTrack</td>
<td>Same as Getfiles but outputs to temporary DiagTrack folder</td>
</tr>
<tr>
<td>-RemoveDefinitions</td>
<td>See details below for each <a href="RemoveDefinitions">^Remove</a></td>
</tr>
<tr>
<td>-SignatureUpdate</td>
<td>Checks for new Security intelligence updates</td>
</tr>
<tr>
<td>-Restore [^Restore]</td>
<td>Restores or lists quarantined item(s)</td>
</tr>
<tr>
<td>-AddDynamicSignature [-Path]</td>
<td>Loads dynamic Security intelligence</td>
</tr>
<tr>
<td>-ListAllDynamicSignatures</td>
<td>Lists the loaded dynamic Security intelligence</td>
</tr>
<tr>
<td>-RemoveDynamicSignature [-SignatureSetID]</td>
<td>Removes dynamic Security intelligence</td>
</tr>
<tr>
<td>-CheckExclusion -path</td>
<td>Checks whether a path is excluded</td>
</tr>
</tbody>
</table>
<p><strong>Scan</strong> has the following sub options
[^Scan]: [-ScanType #] [-File [-DisableRemediation] [-BootSectorScan]] [-Timeout ] [-Cancel]</p>
<p>Restore has the folloing options
[^Restore]:  [-ListAll | [[-Name ] [-All] | [-FilePath ]] [-Path ]]</p>
<p>[^Trace]: [-Grouping #] [-Level #]</p>
<p>[^SignatureUpdate]: [-UNC | -MMPC]
To run, use:</p>
<p>[-All] Restores the installed Security intelligence to a previous backup copy or to the original default set
[-DynamicSignatures] Removes only the dynamically downloaded Security intelligence
[-Engine]  Restores the previous installed engine
<code>&quot;%ProgramFiles%\Windows Defender\MpCmdRun.exe&quot; -scan -scantype 3 -File &lt;Path&gt; -DisableRemediation</code></p>
<p>Scantype 3 means a specific directory/file. File gives the file, and disabling remediation prevents any outcomes except to terminal (deleting, logging, attempting clean.)</p>
<h3 id="taskkill">taskkill</h3>
<p>Kill a task, then immediately restart it.</p>
<pre><code class="language-bat"><div><span class="hljs-built_in">taskkill</span> /f /im explorer.exe &amp; <span class="hljs-built_in">start</span> explorer.exe
</div></code></pre>
<p>Taskkill:</p>
<pre><code class="language-bat"><div><span class="hljs-built_in">TASKKILL</span> [/S system [/U username [/P [password]]]]
         { [/FI filter] [/PID processid | /IM imagename] } [/T] [/F]
<span class="hljs-function">
Description:
    <span class="hljs-title">This</span> <span class="hljs-title">tool</span> <span class="hljs-title">is</span> <span class="hljs-title">used</span> <span class="hljs-title">to</span> <span class="hljs-title">terminate</span> <span class="hljs-title">tasks</span> <span class="hljs-title">by</span> <span class="hljs-title">process</span> <span class="hljs-title">id</span> (<span class="hljs-title">PID</span>) <span class="hljs-title">or</span> <span class="hljs-title">image</span> <span class="hljs-title">name</span>.

<span class="hljs-title">Parameter</span> <span class="hljs-title">List</span>:
    /<span class="hljs-title">S</span>    <span class="hljs-title">system</span>           <span class="hljs-title">Specifies</span> <span class="hljs-title">the</span> <span class="hljs-title">remote</span> <span class="hljs-title">system</span> <span class="hljs-title">to</span> <span class="hljs-title">connect</span> <span class="hljs-title">to</span>.

    /<span class="hljs-title">U</span>    [<span class="hljs-title">domain</span>\]<span class="hljs-title">user</span>    <span class="hljs-title">Specifies</span> <span class="hljs-title">the</span> <span class="hljs-title">user</span> <span class="hljs-title">context</span> <span class="hljs-title">under</span> <span class="hljs-title">which</span> <span class="hljs-title">the</span>
                           <span class="hljs-title">command</span> <span class="hljs-title">should</span> <span class="hljs-title">execute</span>.

    /<span class="hljs-title">P</span>    [<span class="hljs-title">password</span>]       <span class="hljs-title">Specifies</span> <span class="hljs-title">the</span> <span class="hljs-title">password</span> <span class="hljs-title">for</span> <span class="hljs-title">the</span> <span class="hljs-title">given</span> <span class="hljs-title">user</span>
                           <span class="hljs-title">context</span>. <span class="hljs-title">Prompts</span> <span class="hljs-title">for</span> <span class="hljs-title">input</span> <span class="hljs-title">if</span> <span class="hljs-title">omitted</span>.

    /<span class="hljs-title">FI</span>   <span class="hljs-title">filter</span>           <span class="hljs-title">Applies</span> <span class="hljs-title">a</span> <span class="hljs-title">filter</span> <span class="hljs-title">to</span> <span class="hljs-title">select</span> <span class="hljs-title">a</span> <span class="hljs-title">set</span> <span class="hljs-title">of</span> <span class="hljs-title">tasks</span>.
                           <span class="hljs-title">Allows</span> "*" <span class="hljs-title">to</span> <span class="hljs-title">be</span> <span class="hljs-title">used</span>. <span class="hljs-title">ex</span>. <span class="hljs-title">imagename</span> <span class="hljs-title">eq</span> <span class="hljs-title">acme</span>*

    /<span class="hljs-title">PID</span>  <span class="hljs-title">processid</span>        <span class="hljs-title">Specifies</span> <span class="hljs-title">the</span> <span class="hljs-title">PID</span> <span class="hljs-title">of</span> <span class="hljs-title">the</span> <span class="hljs-title">process</span> <span class="hljs-title">to</span> <span class="hljs-title">be</span> <span class="hljs-title">terminated</span>.
                           <span class="hljs-title">Use</span> <span class="hljs-title">TaskList</span> <span class="hljs-title">to</span> <span class="hljs-title">get</span> <span class="hljs-title">the</span> <span class="hljs-title">PID</span>.

    /<span class="hljs-title">IM</span>   <span class="hljs-title">imagename</span>        <span class="hljs-title">Specifies</span> <span class="hljs-title">the</span> <span class="hljs-title">image</span> <span class="hljs-title">name</span> <span class="hljs-title">of</span> <span class="hljs-title">the</span> <span class="hljs-title">process</span>
                           <span class="hljs-title">to</span> <span class="hljs-title">be</span> <span class="hljs-title">terminated</span>. <span class="hljs-title">Wildcard</span> '*' <span class="hljs-title">can</span> <span class="hljs-title">be</span> <span class="hljs-title">used</span>
                           <span class="hljs-title">to</span> <span class="hljs-title">specify</span> <span class="hljs-title">all</span> <span class="hljs-title">tasks</span> <span class="hljs-title">or</span> <span class="hljs-title">image</span> <span class="hljs-title">names</span>.

    /<span class="hljs-title">T</span>                     <span class="hljs-title">Terminates</span> <span class="hljs-title">the</span> <span class="hljs-title">specified</span> <span class="hljs-title">process</span> <span class="hljs-title">and</span> <span class="hljs-title">any</span>
                           <span class="hljs-title">child</span> <span class="hljs-title">processes</span> <span class="hljs-title">which</span> <span class="hljs-title">were</span> <span class="hljs-title">started</span> <span class="hljs-title">by</span> <span class="hljs-title">it</span>.

    /<span class="hljs-title">F</span>                     <span class="hljs-title">Specifies</span> <span class="hljs-title">to</span> <span class="hljs-title">forcefully</span> <span class="hljs-title">terminate</span> <span class="hljs-title">the</span> <span class="hljs-title">process</span>(<span class="hljs-title">es</span>).

    /?                     <span class="hljs-title">Displays</span> <span class="hljs-title">this</span> <span class="hljs-title">help</span> <span class="hljs-title">message</span>.

<span class="hljs-title">Filters</span>:
    <span class="hljs-title">Filter</span> <span class="hljs-title">Name</span>   <span class="hljs-title">Valid</span> <span class="hljs-title">Operators</span>           <span class="hljs-title">Valid</span> <span class="hljs-title">Value</span>(<span class="hljs-title">s</span>)
    -----------   ---------------           -------------------------
    <span class="hljs-title">STATUS</span>        <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">RUNNING</span> |
                                            <span class="hljs-title">NOT</span> <span class="hljs-title">RESPONDING</span> | <span class="hljs-title">UNKNOWN</span>
    <span class="hljs-title">IMAGENAME</span>     <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">Image</span> <span class="hljs-title">name</span>
    <span class="hljs-title">PID</span>           <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>, <span class="hljs-title">gt</span>, <span class="hljs-title">lt</span>, <span class="hljs-title">ge</span>, <span class="hljs-title">le</span>    <span class="hljs-title">PID</span> <span class="hljs-title">value</span>
    <span class="hljs-title">SESSION</span>       <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>, <span class="hljs-title">gt</span>, <span class="hljs-title">lt</span>, <span class="hljs-title">ge</span>, <span class="hljs-title">le</span>    <span class="hljs-title">Session</span> <span class="hljs-title">number</span>.
    <span class="hljs-title">CPUTIME</span>       <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>, <span class="hljs-title">gt</span>, <span class="hljs-title">lt</span>, <span class="hljs-title">ge</span>, <span class="hljs-title">le</span>    <span class="hljs-title">CPU</span> <span class="hljs-title">time</span> <span class="hljs-title">in</span> <span class="hljs-title">the</span> <span class="hljs-title">format</span>
                                            <span class="hljs-title">of</span> <span class="hljs-title">hh:mm</span>:<span class="hljs-title">ss</span>.
                                            <span class="hljs-title">hh</span> - <span class="hljs-title">hours</span>,
                                            <span class="hljs-title">mm</span> - <span class="hljs-title">minutes</span>, <span class="hljs-title">ss</span> - <span class="hljs-title">seconds</span>
    <span class="hljs-title">MEMUSAGE</span>      <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>, <span class="hljs-title">gt</span>, <span class="hljs-title">lt</span>, <span class="hljs-title">ge</span>, <span class="hljs-title">le</span>    <span class="hljs-title">Memory</span> <span class="hljs-title">usage</span> <span class="hljs-title">in</span> <span class="hljs-title">KB</span>
    <span class="hljs-title">USERNAME</span>      <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">User</span> <span class="hljs-title">name</span> <span class="hljs-title">in</span> [<span class="hljs-title">domain</span>\]<span class="hljs-title">user</span>
                                            <span class="hljs-title">format</span>
    <span class="hljs-title">MODULES</span>       <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">DLL</span> <span class="hljs-title">name</span>
    <span class="hljs-title">SERVICES</span>      <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">Service</span> <span class="hljs-title">name</span>
    <span class="hljs-title">WINDOWTITLE</span>   <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">Window</span> <span class="hljs-title">title</span>

    <span class="hljs-title">NOTE</span>
    ----
    1) <span class="hljs-title">Wildcard</span> '*' <span class="hljs-title">for</span> /<span class="hljs-title">IM</span> <span class="hljs-title">switch</span> <span class="hljs-title">is</span> <span class="hljs-title">accepted</span> <span class="hljs-title">only</span> <span class="hljs-title">when</span> <span class="hljs-title">a</span> <span class="hljs-title">filter</span> <span class="hljs-title">is</span> <span class="hljs-title">applied</span>.
    2) <span class="hljs-title">Termination</span> <span class="hljs-title">of</span> <span class="hljs-title">remote</span> <span class="hljs-title">processes</span> <span class="hljs-title">will</span> <span class="hljs-title">always</span> <span class="hljs-title">be</span> <span class="hljs-title">done</span> <span class="hljs-title">forcefully</span> (/<span class="hljs-title">F</span>).
    3) "<span class="hljs-title">WINDOWTITLE</span>" <span class="hljs-title">and</span> "<span class="hljs-title">STATUS</span>" <span class="hljs-title">filters</span> <span class="hljs-title">are</span> <span class="hljs-title">not</span> <span class="hljs-title">considered</span> <span class="hljs-title">when</span> <span class="hljs-title">a</span> <span class="hljs-title">remote</span>
       <span class="hljs-title">machine</span> <span class="hljs-title">is</span> <span class="hljs-title">specified</span>.

<span class="hljs-title">Examples</span>:
    <span class="hljs-title">TASKKILL</span> /<span class="hljs-title">IM</span> <span class="hljs-title">notepad.exe</span>
    <span class="hljs-title">TASKKILL</span> /<span class="hljs-title">PID</span> 1230 /<span class="hljs-title">PID</span> 1241 /<span class="hljs-title">PID</span> 1253 /<span class="hljs-title">T</span>
    <span class="hljs-title">TASKKILL</span> /<span class="hljs-title">F</span> /<span class="hljs-title">IM</span> <span class="hljs-title">cmd.exe</span> /<span class="hljs-title">T</span>
    <span class="hljs-title">TASKKILL</span> /<span class="hljs-title">F</span> /<span class="hljs-title">FI</span> "<span class="hljs-title">PID</span> <span class="hljs-title">ge</span> 1000" /<span class="hljs-title">FI</span> "<span class="hljs-title">WINDOWTITLE</span> <span class="hljs-title">ne</span> <span class="hljs-title">untitle</span>*"
    <span class="hljs-title">TASKKILL</span> /<span class="hljs-title">F</span> /<span class="hljs-title">FI</span> "<span class="hljs-title">USERNAME</span> <span class="hljs-title">eq</span> <span class="hljs-title">NT</span> <span class="hljs-title">AUTHORITY</span>\<span class="hljs-title">SYSTEM</span>" /<span class="hljs-title">IM</span> <span class="hljs-title">notepad.exe</span>
    <span class="hljs-title">TASKKILL</span> /<span class="hljs-title">S</span> <span class="hljs-title">system</span> /<span class="hljs-title">U</span> <span class="hljs-title">domain</span>\<span class="hljs-title">username</span> /<span class="hljs-title">FI</span> "<span class="hljs-title">USERNAME</span> <span class="hljs-title">ne</span> <span class="hljs-title">NT</span>*" /<span class="hljs-title">IM</span> *
    <span class="hljs-title">TASKKILL</span> /<span class="hljs-title">S</span> <span class="hljs-title">system</span> /<span class="hljs-title">U</span> <span class="hljs-title">username</span> /<span class="hljs-title">P</span> <span class="hljs-title">password</span> /<span class="hljs-title">FI</span> "<span class="hljs-title">IMAGENAME</span> <span class="hljs-title">eq</span> <span class="hljs-title">note</span>*"
</span></div></code></pre>
<p>See also: Tasklist</p>
<h3 id="tasklist">Tasklist</h3>
<pre><code class="language-bat"><div>TASKLIST [/S system [/U username [/P [password]]]]
         [/M [module] | /SVC | /V] [/FI filter] [/FO <span class="hljs-built_in">format</span>] [/NH]
<span class="hljs-function">
Description:
    <span class="hljs-title">This</span> <span class="hljs-title">tool</span> <span class="hljs-title">displays</span> <span class="hljs-title">a</span> <span class="hljs-title">list</span> <span class="hljs-title">of</span> <span class="hljs-title">currently</span> <span class="hljs-title">running</span> <span class="hljs-title">processes</span> <span class="hljs-title">on</span>
    <span class="hljs-title">either</span> <span class="hljs-title">a</span> <span class="hljs-title">local</span> <span class="hljs-title">or</span> <span class="hljs-title">remote</span> <span class="hljs-title">machine</span>.

<span class="hljs-title">Parameter</span> <span class="hljs-title">List</span>:
   /<span class="hljs-title">S</span>     <span class="hljs-title">system</span>           <span class="hljs-title">Specifies</span> <span class="hljs-title">the</span> <span class="hljs-title">remote</span> <span class="hljs-title">system</span> <span class="hljs-title">to</span> <span class="hljs-title">connect</span> <span class="hljs-title">to</span>.

   /<span class="hljs-title">U</span>     [<span class="hljs-title">domain</span>\]<span class="hljs-title">user</span>    <span class="hljs-title">Specifies</span> <span class="hljs-title">the</span> <span class="hljs-title">user</span> <span class="hljs-title">context</span> <span class="hljs-title">under</span> <span class="hljs-title">which</span>
                           <span class="hljs-title">the</span> <span class="hljs-title">command</span> <span class="hljs-title">should</span> <span class="hljs-title">execute</span>.

   /<span class="hljs-title">P</span>     [<span class="hljs-title">password</span>]       <span class="hljs-title">Specifies</span> <span class="hljs-title">the</span> <span class="hljs-title">password</span> <span class="hljs-title">for</span> <span class="hljs-title">the</span> <span class="hljs-title">given</span>
                           <span class="hljs-title">user</span> <span class="hljs-title">context</span>. <span class="hljs-title">Prompts</span> <span class="hljs-title">for</span> <span class="hljs-title">input</span> <span class="hljs-title">if</span> <span class="hljs-title">omitted</span>.

   /<span class="hljs-title">M</span>     [<span class="hljs-title">module</span>]         <span class="hljs-title">Lists</span> <span class="hljs-title">all</span> <span class="hljs-title">tasks</span> <span class="hljs-title">currently</span> <span class="hljs-title">using</span> <span class="hljs-title">the</span> <span class="hljs-title">given</span>
                           <span class="hljs-title">exe</span>/<span class="hljs-title">dll</span> <span class="hljs-title">name</span>. <span class="hljs-title">If</span> <span class="hljs-title">the</span> <span class="hljs-title">module</span> <span class="hljs-title">name</span> <span class="hljs-title">is</span> <span class="hljs-title">not</span>
                           <span class="hljs-title">specified</span> <span class="hljs-title">all</span> <span class="hljs-title">loaded</span> <span class="hljs-title">modules</span> <span class="hljs-title">are</span> <span class="hljs-title">displayed</span>.

   /<span class="hljs-title">SVC</span>                    <span class="hljs-title">Displays</span> <span class="hljs-title">services</span> <span class="hljs-title">hosted</span> <span class="hljs-title">in</span> <span class="hljs-title">each</span> <span class="hljs-title">process</span>.

   /<span class="hljs-title">APPS</span>                   <span class="hljs-title">Displays</span> <span class="hljs-title">Store</span> <span class="hljs-title">Apps</span> <span class="hljs-title">and</span> <span class="hljs-title">their</span> <span class="hljs-title">associated</span> <span class="hljs-title">processes</span>.

   /<span class="hljs-title">V</span>                      <span class="hljs-title">Displays</span> <span class="hljs-title">verbose</span> <span class="hljs-title">task</span> <span class="hljs-title">information</span>.

   /<span class="hljs-title">FI</span>    <span class="hljs-title">filter</span>           <span class="hljs-title">Displays</span> <span class="hljs-title">a</span> <span class="hljs-title">set</span> <span class="hljs-title">of</span> <span class="hljs-title">tasks</span> <span class="hljs-title">that</span> <span class="hljs-title">match</span> <span class="hljs-title">a</span>
                           <span class="hljs-title">given</span> <span class="hljs-title">criteria</span> <span class="hljs-title">specified</span> <span class="hljs-title">by</span> <span class="hljs-title">the</span> <span class="hljs-title">filter</span>.

   /<span class="hljs-title">FO</span>    <span class="hljs-title">format</span>           <span class="hljs-title">Specifies</span> <span class="hljs-title">the</span> <span class="hljs-title">output</span> <span class="hljs-title">format</span>.
                           <span class="hljs-title">Valid</span> <span class="hljs-title">values</span>: "<span class="hljs-title">TABLE</span>", "<span class="hljs-title">LIST</span>", "<span class="hljs-title">CSV</span>".

   /<span class="hljs-title">NH</span>                     <span class="hljs-title">Specifies</span> <span class="hljs-title">that</span> <span class="hljs-title">the</span> "<span class="hljs-title">Column</span> <span class="hljs-title">Header</span>" <span class="hljs-title">should</span>
                           <span class="hljs-title">not</span> <span class="hljs-title">be</span> <span class="hljs-title">displayed</span> <span class="hljs-title">in</span> <span class="hljs-title">the</span> <span class="hljs-title">output</span>.
                           <span class="hljs-title">Valid</span> <span class="hljs-title">only</span> <span class="hljs-title">for</span> "<span class="hljs-title">TABLE</span>" <span class="hljs-title">and</span> "<span class="hljs-title">CSV</span>" <span class="hljs-title">formats</span>.

   /?                      <span class="hljs-title">Displays</span> <span class="hljs-title">this</span> <span class="hljs-title">help</span> <span class="hljs-title">message</span>.

<span class="hljs-title">Filters</span>:
    <span class="hljs-title">Filter</span> <span class="hljs-title">Name</span>     <span class="hljs-title">Valid</span> <span class="hljs-title">Operators</span>           <span class="hljs-title">Valid</span> <span class="hljs-title">Value</span>(<span class="hljs-title">s</span>)
    -----------     ---------------           --------------------------
    <span class="hljs-title">STATUS</span>          <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">RUNNING</span> | <span class="hljs-title">SUSPENDED</span>
                                              <span class="hljs-title">NOT</span> <span class="hljs-title">RESPONDING</span> | <span class="hljs-title">UNKNOWN</span>
    <span class="hljs-title">IMAGENAME</span>       <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">Image</span> <span class="hljs-title">name</span>
    <span class="hljs-title">PID</span>             <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>, <span class="hljs-title">gt</span>, <span class="hljs-title">lt</span>, <span class="hljs-title">ge</span>, <span class="hljs-title">le</span>    <span class="hljs-title">PID</span> <span class="hljs-title">value</span>
    <span class="hljs-title">SESSION</span>         <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>, <span class="hljs-title">gt</span>, <span class="hljs-title">lt</span>, <span class="hljs-title">ge</span>, <span class="hljs-title">le</span>    <span class="hljs-title">Session</span> <span class="hljs-title">number</span>
    <span class="hljs-title">SESSIONNAME</span>     <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">Session</span> <span class="hljs-title">name</span>
    <span class="hljs-title">CPUTIME</span>         <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>, <span class="hljs-title">gt</span>, <span class="hljs-title">lt</span>, <span class="hljs-title">ge</span>, <span class="hljs-title">le</span>    <span class="hljs-title">CPU</span> <span class="hljs-title">time</span> <span class="hljs-title">in</span> <span class="hljs-title">the</span> <span class="hljs-title">format</span>
                                              <span class="hljs-title">of</span> <span class="hljs-title">hh:mm</span>:<span class="hljs-title">ss</span>.
                                              <span class="hljs-title">hh</span> - <span class="hljs-title">hours</span>,
                                              <span class="hljs-title">mm</span> - <span class="hljs-title">minutes</span>, <span class="hljs-title">ss</span> - <span class="hljs-title">seconds</span>
    <span class="hljs-title">MEMUSAGE</span>        <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>, <span class="hljs-title">gt</span>, <span class="hljs-title">lt</span>, <span class="hljs-title">ge</span>, <span class="hljs-title">le</span>    <span class="hljs-title">Memory</span> <span class="hljs-title">usage</span> <span class="hljs-title">in</span> <span class="hljs-title">KB</span>
    <span class="hljs-title">USERNAME</span>        <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">User</span> <span class="hljs-title">name</span> <span class="hljs-title">in</span> [<span class="hljs-title">domain</span>\]<span class="hljs-title">user</span>
                                              <span class="hljs-title">format</span>
    <span class="hljs-title">SERVICES</span>        <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">Service</span> <span class="hljs-title">name</span>
    <span class="hljs-title">WINDOWTITLE</span>     <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">Window</span> <span class="hljs-title">title</span>
    <span class="hljs-title">MODULES</span>         <span class="hljs-title">eq</span>, <span class="hljs-title">ne</span>                    <span class="hljs-title">DLL</span> <span class="hljs-title">name</span>

<span class="hljs-title">NOTE</span>: "<span class="hljs-title">WINDOWTITLE</span>" <span class="hljs-title">and</span> "<span class="hljs-title">STATUS</span>" <span class="hljs-title">filters</span> <span class="hljs-title">are</span> <span class="hljs-title">not</span> <span class="hljs-title">supported</span> <span class="hljs-title">when</span> <span class="hljs-title">querying</span>
      <span class="hljs-title">a</span> <span class="hljs-title">remote</span> <span class="hljs-title">machine</span>.

<span class="hljs-title">Examples</span>:
    <span class="hljs-title">TASKLIST</span>
    <span class="hljs-title">TASKLIST</span> /<span class="hljs-title">M</span>
    <span class="hljs-title">TASKLIST</span> /<span class="hljs-title">V</span> /<span class="hljs-title">FO</span> <span class="hljs-title">CSV</span>
    <span class="hljs-title">TASKLIST</span> /<span class="hljs-title">SVC</span> /<span class="hljs-title">FO</span> <span class="hljs-title">LIST</span>
    <span class="hljs-title">TASKLIST</span> /<span class="hljs-title">APPS</span> /<span class="hljs-title">FI</span> "<span class="hljs-title">STATUS</span> <span class="hljs-title">eq</span> <span class="hljs-title">RUNNING</span>"
    <span class="hljs-title">TASKLIST</span> /<span class="hljs-title">M</span> <span class="hljs-title">wbem</span>*
    <span class="hljs-title">TASKLIST</span> /<span class="hljs-title">S</span> <span class="hljs-title">system</span> /<span class="hljs-title">FO</span> <span class="hljs-title">LIST</span>
    <span class="hljs-title">TASKLIST</span> /<span class="hljs-title">S</span> <span class="hljs-title">system</span> /<span class="hljs-title">U</span> <span class="hljs-title">domain</span>\<span class="hljs-title">username</span> /<span class="hljs-title">FO</span> <span class="hljs-title">CSV</span> /<span class="hljs-title">NH</span>
    <span class="hljs-title">TASKLIST</span> /<span class="hljs-title">S</span> <span class="hljs-title">system</span> /<span class="hljs-title">U</span> <span class="hljs-title">username</span> /<span class="hljs-title">P</span> <span class="hljs-title">password</span> /<span class="hljs-title">FO</span> <span class="hljs-title">TABLE</span> /<span class="hljs-title">NH</span>
    <span class="hljs-title">TASKLIST</span> /<span class="hljs-title">FI</span> "<span class="hljs-title">USERNAME</span> <span class="hljs-title">ne</span> <span class="hljs-title">NT</span> <span class="hljs-title">AUTHORITY</span>\<span class="hljs-title">SYSTEM</span>" /<span class="hljs-title">FI</span> "<span class="hljs-title">STATUS</span> <span class="hljs-title">eq</span> <span class="hljs-title">running</span>"
</span></div></code></pre>
<h3 id="rundll-and-its-command">RunDll and its command</h3>
<p>Can be run in AHK - from Help on RUn</p>
<p>If Target contains any commas, they must be escaped as shown three times in the following example:</p>
<pre><code>    Run rundll32.exe shell32.dll`,Control_RunDLL desk.cpl`,`, 3  ; Opens Control Panel &gt; Display Properties &gt; Settings
</code></pre>
<p>When running a program via ComSpec (cmd.exe) -- perhaps because you need to redirect the program's input or output -- if the path or name of the executable contains spaces, the entire string should be enclosed in an outer pair of quotes. In the following example, the outer quotes are shown in red and all the inner quotes are shown in black:</p>
<pre><code>    Run %ComSpec% /c &quot;&quot;C:\My Utility.exe&quot; &quot;param 1&quot; &quot;second param&quot; &gt;&quot;C:\My File.txt&quot;&quot;
</code></pre>
<p>If Target cannot be launched, an error window is displayed and the current thread is exited, unless the string UseErrorLevel is included in the third parameter or the error is caught by a Try/Catch statement.</p>
<p>Performance may be slightly improved if Target is an exact path, e.g. Run, C:\Windows\Notepad.exe &quot;C:\My Documents\Test.txt&quot; rather than Run, C:\My Documents\Test.txt.</p>
<p>Special CLSID folders may be opened via Run. For example:</p>
<pre><code>    Run ::{20d04fe0-3aea-1069-a2d8-08002b30309d}  ; Opens the &quot;My Computer&quot; folder.
    Run ::{645ff040-5081-101b-9f08-00aa002f954e}  ; Opens the Recycle Bin.
</code></pre>
<h3 id="rundll-commands">RunDll Commands</h3>
<p>List  of Rundll32 Commands in Windows 10</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Rundll32 command</th>
</tr>
</thead>
<tbody>
<tr>
<td>About Windows</td>
<td>Rundll32.exe shell32.dll,ShellAbout</td>
</tr>
<tr>
<td>Add Network Location Wizard</td>
<td>Rundll32 %SystemRoot%\system32\shwebsvc.dll,AddNetPlaceRunDll</td>
</tr>
<tr>
<td>Add Printer Wizard</td>
<td>Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL AddPrinter</td>
</tr>
<tr>
<td>Add Standard TCP/IP Printer Port Wizard</td>
<td>Rundll32.exe tcpmonui.dll,LocalAddPortUI</td>
</tr>
<tr>
<td>Control Panel</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL</td>
</tr>
<tr>
<td>Date and Time</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL timedate.cpl</td>
</tr>
<tr>
<td>Date and Time - Additional Clocks tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,1</td>
</tr>
<tr>
<td>Desktop Icon Settings</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,0</td>
</tr>
<tr>
<td>Device Installation Settings</td>
<td>Rundll32.exe %SystemRoot%\System32\newdev.dll DeviceInternetSettingUi</td>
</tr>
<tr>
<td>Device Manager</td>
<td>Rundll32.exe devmgr.dll DeviceManager_Execute</td>
</tr>
<tr>
<td>Display Settings</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL desk.cpl</td>
</tr>
<tr>
<td>Ease of Access Center</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL access.cpl</td>
</tr>
<tr>
<td>Environment Variables</td>
<td>Rundll32.exe sysdm.cpl,EditEnvironmentVariables</td>
</tr>
<tr>
<td><em>File Explorer Options</em></td>
<td></td>
</tr>
<tr>
<td>- General tab</td>
<td>Rundll32.exe shell32.dll,Options_RunDLL 0</td>
</tr>
<tr>
<td>- Search tab</td>
<td>Rundll32.exe shell32.dll,Options_RunDLL 2</td>
</tr>
<tr>
<td>- View tab</td>
<td>Rundll32.exe shell32.dll,Options_RunDLL 7</td>
</tr>
<tr>
<td>- Fonts folder</td>
<td>Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL FontsFolder</td>
</tr>
<tr>
<td>Forgotten Password Wizard</td>
<td>Rundll32.exe keymgr.dll,PRShowSaveWizardExW</td>
</tr>
<tr>
<td>Game Controllers</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL joy.cpl</td>
</tr>
<tr>
<td>Hibernate or Sleep</td>
<td>Rundll32.exe powrprof.dll,SetSuspendState</td>
</tr>
<tr>
<td>Indexing Options</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL srchadmin.dll</td>
</tr>
<tr>
<td>Infared</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL irprops.cpl</td>
</tr>
<tr>
<td><em>Internet Explorer</em></td>
<td></td>
</tr>
<tr>
<td>- delete browsing history</td>
<td>Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 255</td>
</tr>
<tr>
<td>- delete browsing (&amp; addon) history</td>
<td>Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 4351</td>
</tr>
<tr>
<td>- delete cookies &amp; site data</td>
<td>Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 2</td>
</tr>
<tr>
<td>- delete download history</td>
<td>Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 16384</td>
</tr>
<tr>
<td>- delete form data</td>
<td>Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 16</td>
</tr>
<tr>
<td>- delete history</td>
<td>Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 1</td>
</tr>
<tr>
<td>- delete passwords</td>
<td>Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 32</td>
</tr>
<tr>
<td>- delete temp Internet files</td>
<td>Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 8</td>
</tr>
<tr>
<td>- Organize Favorites</td>
<td>Rundll32.exe shdocvw.dll,DoOrganizeFavDlg</td>
</tr>
<tr>
<td>- General tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl</td>
</tr>
<tr>
<td>- Security tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,1</td>
</tr>
<tr>
<td>- Privacy tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,2</td>
</tr>
<tr>
<td>- Content tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,3</td>
</tr>
<tr>
<td>- Connections tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,4</td>
</tr>
<tr>
<td>- Programs tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,5</td>
</tr>
<tr>
<td>- Advanced tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,6</td>
</tr>
<tr>
<td>Keyboard Properties</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL main.cpl @1</td>
</tr>
<tr>
<td>Lock PC</td>
<td>Rundll32.exe user32.dll,LockWorkStation</td>
</tr>
<tr>
<td>Map Network Drive wizard</td>
<td>Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL Connect</td>
</tr>
<tr>
<td><em>Mouse Properties</em></td>
<td></td>
</tr>
<tr>
<td>- Mouse swap left and right button</td>
<td>Rundll32.exe user32.dll,SwapMouseButton</td>
</tr>
<tr>
<td>- Buttons tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL main.cpl</td>
</tr>
<tr>
<td>- Pointers tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,1</td>
</tr>
<tr>
<td>- Pointer Options tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,2</td>
</tr>
<tr>
<td>- Wheel tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,3</td>
</tr>
<tr>
<td>- Hardware tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,4</td>
</tr>
<tr>
<td>Network Connections</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL ncpa.cpl</td>
</tr>
<tr>
<td>ODBC Data Source Administrator</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL odbccp32.cpl</td>
</tr>
<tr>
<td><em>Offline Files</em></td>
<td></td>
</tr>
<tr>
<td>- General tab</td>
<td>Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,0</td>
</tr>
<tr>
<td>- Disk Usage tab</td>
<td>Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,1</td>
</tr>
<tr>
<td>- Encryption tab</td>
<td>Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,2</td>
</tr>
<tr>
<td>- Network tab</td>
<td>Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,3</td>
</tr>
<tr>
<td>Pen and Touch</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL tabletpc.cpl</td>
</tr>
<tr>
<td>Personalization - Background</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,2</td>
</tr>
<tr>
<td>Power Options</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL powercfg.cpl</td>
</tr>
<tr>
<td>Printer User Interface</td>
<td>Rundll32.exe Printui.dll,PrintUIEntry /?</td>
</tr>
<tr>
<td>Printers folder</td>
<td>Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL PrintersFolder</td>
</tr>
<tr>
<td>Process idle tasks</td>
<td>Rundll32.exe advapi32.dll,ProcessIdleTasks</td>
</tr>
<tr>
<td>Programs and Features</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,0</td>
</tr>
<tr>
<td><em>Region</em></td>
<td></td>
</tr>
<tr>
<td>- Formats tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,0</td>
</tr>
<tr>
<td>- Location tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,1</td>
</tr>
<tr>
<td>- Administrative tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,2</td>
</tr>
<tr>
<td>Safely Remove Hardware</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL HotPlug.dll</td>
</tr>
<tr>
<td>Screen Saver Settings</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,1</td>
</tr>
<tr>
<td>Security and Maintenance</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL wscui.cpl</td>
</tr>
<tr>
<td>Set Program Access and Comp Defaults</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,3</td>
</tr>
<tr>
<td>Set Up a Network wizard</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL NetSetup.cpl</td>
</tr>
<tr>
<td>Sleep or Hibernate</td>
<td>Rundll32.exe powrprof.dll,SetSuspendState</td>
</tr>
<tr>
<td><em>Sound</em></td>
<td></td>
</tr>
<tr>
<td>- Playback tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,0</td>
</tr>
<tr>
<td>- Recording tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,1</td>
</tr>
<tr>
<td>- Sounds tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,2</td>
</tr>
<tr>
<td>- Communications tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,3</td>
</tr>
<tr>
<td>Speech Properties [5]</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL</td>
</tr>
<tr>
<td></td>
<td>(...)  %SystemRoot%\System32\Speech\SpeechUX\sapi.cpl,,1</td>
</tr>
<tr>
<td>Start Settings</td>
<td>Rundll32.exe shell32.dll,Options_RunDLL 3</td>
</tr>
<tr>
<td>Stored User Names and Passwords</td>
<td>Rundll32.exe keymgr.dll,KRShowKeyMgr</td>
</tr>
<tr>
<td><em>System Properties</em></td>
<td></td>
</tr>
<tr>
<td>- Computer Name tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,1</td>
</tr>
<tr>
<td>- Hardware tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,2</td>
</tr>
<tr>
<td>- Advanced tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,3</td>
</tr>
<tr>
<td>- System Protection tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,4</td>
</tr>
<tr>
<td>- Remote tab</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,5</td>
</tr>
<tr>
<td>Taskbar Settings</td>
<td>Rundll32.exe shell32.dll,Options_RunDLL 1</td>
</tr>
<tr>
<td>Text Services and Input Languages</td>
<td>Rundll32.exe Shell32.dll,Control_RunDLL input.dll,,</td>
</tr>
<tr>
<td></td>
<td>(...){C07337D3-DB2C-4D0B-9A93-B722A6C106E2}</td>
</tr>
<tr>
<td>User Accounts</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL nusrmgr.cpl</td>
</tr>
<tr>
<td>Windows Features</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,2</td>
</tr>
<tr>
<td>Windows Firewall</td>
<td>Rundll32.exe shell32.dll,Control_RunDLL firewall.cpl</td>
</tr>
<tr>
<td>Windows To Go Startup Options</td>
<td>Rundll32.exe pwlauncher.dll,</td>
</tr>
<tr>
<td></td>
<td>(...)ShowPortableWorkspaceLauncherConfigurationUX</td>
</tr>
</tbody>
</table>
<h3 id="shell-commands">Shell:: Commands</h3>
<table>
<thead>
<tr>
<th>Shell Command</th>
<th>Opens</th>
</tr>
</thead>
<tbody>
<tr>
<td>shell:3D Objects</td>
<td><code>%UserProfile%\3D Objects</code></td>
</tr>
<tr>
<td>shell:AccountPictures</td>
<td><code>%AppData%\Microsoft\Windows\AccountPictures</code></td>
</tr>
<tr>
<td>shell:AddNewProgramsFolder</td>
<td><code>Control Panel\All Control Panel Items\Get Programs</code></td>
</tr>
<tr>
<td>shell:Administrative Tools</td>
<td><code>%AppData%\Microsoft\Windows\Start Menu\Programs\Administrative Tools</code></td>
</tr>
<tr>
<td>shell:AppData</td>
<td><code>%AppData%</code></td>
</tr>
<tr>
<td>shell:Application Shortcuts</td>
<td><code>%LocalAppData%\Microsoft\Windows\Application Shortcuts</code></td>
</tr>
<tr>
<td>shell:AppsFolder</td>
<td><code>Applications</code></td>
</tr>
<tr>
<td>shell:AppUpdatesFolder</td>
<td><code>Installed Updates</code></td>
</tr>
<tr>
<td>shell:Cache</td>
<td><code>%LocalAppData%\Microsoft\Windows\INetCache</code></td>
</tr>
<tr>
<td>shell:Camera Roll</td>
<td><code>%UserProfile%\Pictures\Camera Roll</code></td>
</tr>
<tr>
<td>shell:CD Burning</td>
<td><code>%LocalAppData%\Microsoft\Windows\Burn\Burn</code></td>
</tr>
<tr>
<td>shell:ChangeRemoveProgramsFolder</td>
<td><code>Control Panel\All Control Panel Items\Programs and Features</code></td>
</tr>
<tr>
<td>shell:Common Administrative Tools</td>
<td><code>%ProgramData%\Microsoft\Windows\Start ...</code></td>
</tr>
<tr>
<td>...</td>
<td><code>(...) Menu\Programs\Administrative Tools</code></td>
</tr>
<tr>
<td>shell:Common AppData</td>
<td><code>%ProgramData%</code></td>
</tr>
<tr>
<td>shell:Common Desktop</td>
<td><code>%Public%\Desktop</code></td>
</tr>
<tr>
<td>shell:Common Documents</td>
<td><code>%Public%\Documents</code></td>
</tr>
<tr>
<td>shell:CommonDownloads</td>
<td><code>%Public%\Downloads</code></td>
</tr>
<tr>
<td>shell:CommonMusic</td>
<td><code>%Public%\Music</code></td>
</tr>
<tr>
<td>shell:CommonPictures</td>
<td><code>%Public%\Pictures</code></td>
</tr>
<tr>
<td>shell:Common Programs</td>
<td><code>%ProgramData%\Microsoft\Windows\Start Menu\Programs</code></td>
</tr>
<tr>
<td>shell:CommonRingtones</td>
<td><code>%ProgramData%\Microsoft\Windows\Ringtones</code></td>
</tr>
<tr>
<td>shell:Common Start Menu</td>
<td><code>%ProgramData%\Microsoft\Windows\Start Menu</code></td>
</tr>
<tr>
<td>shell:Common Startup</td>
<td><code>%ProgramData%\Microsoft\Windows\Start Menu\Programs\Startup</code></td>
</tr>
<tr>
<td>shell:Common Templates</td>
<td><code>%ProgramData%\Microsoft\Windows\Templates</code></td>
</tr>
<tr>
<td>shell:CommonVideo</td>
<td><code>%Public%\Videos</code></td>
</tr>
<tr>
<td>shell:ConflictFolder</td>
<td><code>Control Panel\All Control Panel Items\Sync Center\Conflicts</code></td>
</tr>
<tr>
<td>shell:ConnectionsFolder</td>
<td><code>Control Panel\All Control Panel Items\Network Connections</code></td>
</tr>
<tr>
<td>shell:Contacts</td>
<td><code>%UserProfile%\Contacts</code></td>
</tr>
<tr>
<td>shell:ControlPanelFolder</td>
<td><code>Control Panel\All Control Panel Items</code></td>
</tr>
<tr>
<td>shell:Cookies</td>
<td><code>%LocalAppData%\Microsoft\Windows\INetCookies</code></td>
</tr>
<tr>
<td>shell:Cookies\Low</td>
<td><code>%LocalAppData%\Microsoft\Windows\INetCookies\Low</code></td>
</tr>
<tr>
<td>shell:CredentialManager</td>
<td><code>%AppData%\Microsoft\Credentials</code></td>
</tr>
<tr>
<td>shell:CryptoKeys</td>
<td><code>%AppData%\Microsoft\Crypto</code></td>
</tr>
<tr>
<td>shell:desktop</td>
<td><code>Desktop</code></td>
</tr>
<tr>
<td>shell:device Metadata Store</td>
<td><code>%ProgramData%\Microsoft\Windows\DeviceMetadataStore</code></td>
</tr>
<tr>
<td>shell:documentsLibrary</td>
<td><code>Libraries\Documents</code></td>
</tr>
<tr>
<td>shell:downloads</td>
<td><code>%UserProfile%\Downloads</code></td>
</tr>
<tr>
<td>shell:dpapiKeys</td>
<td><code>%AppData%\Microsoft\Protect</code></td>
</tr>
<tr>
<td>shell:Favorites</td>
<td><code>%UserProfile%\Favorites</code></td>
</tr>
<tr>
<td>shell:Fonts</td>
<td><code>%WinDir%\Fonts</code></td>
</tr>
<tr>
<td>shell:Games (removed in 1803)</td>
<td><code>Games</code></td>
</tr>
<tr>
<td>shell:GameTasks</td>
<td><code>%LocalAppData%\Microsoft\Windows\GameExplorer</code></td>
</tr>
<tr>
<td>shell:History</td>
<td><code>%LocalAppData%\Microsoft\Windows\History</code></td>
</tr>
<tr>
<td>shell:HomeGroupCurrentUserFolder</td>
<td><code>Homegroup\(user-name)</code></td>
</tr>
<tr>
<td>shell:HomeGroupFolder</td>
<td><code>Homegroup</code></td>
</tr>
<tr>
<td>shell:ImplicitAppShortcuts</td>
<td><code>%AppData%\Microsoft\Internet Explorer\Quick</code></td>
</tr>
<tr>
<td>...</td>
<td><code>(...) Launch\User Pinned\ImplicitAppShortcuts</code></td>
</tr>
<tr>
<td>shell:InternetFolder</td>
<td><code>Internet Explorer</code></td>
</tr>
<tr>
<td>shell:Libraries</td>
<td><code>Libraries</code></td>
</tr>
<tr>
<td>shell:Links</td>
<td><code>%UserProfile%\Links</code></td>
</tr>
<tr>
<td>shell:Local AppData</td>
<td><code>%LocalAppData%</code></td>
</tr>
<tr>
<td>shell:LocalAppDataLow</td>
<td><code>%UserProfile%\AppData\LocalLow</code></td>
</tr>
<tr>
<td>shell:MusicLibrary</td>
<td><code>Libraries\Music</code></td>
</tr>
<tr>
<td>shell:MyComputerFolder</td>
<td><code>This PC</code></td>
</tr>
<tr>
<td>shell:My Music</td>
<td><code>%UserProfile%\Music</code></td>
</tr>
<tr>
<td>shell:My Pictures</td>
<td><code>%UserProfile%\Pictures</code></td>
</tr>
<tr>
<td>shell:My Video</td>
<td><code>%UserProfile%\Videos</code></td>
</tr>
<tr>
<td>shell:NetHood</td>
<td><code>%AppData%\Microsoft\Windows\Network Shortcuts</code></td>
</tr>
<tr>
<td>shell:NetworkPlacesFolder</td>
<td><code>Network</code></td>
</tr>
<tr>
<td>shell:OneDrive</td>
<td><code>OneDrive</code></td>
</tr>
<tr>
<td>shell:OneDriveCameraRoll</td>
<td><code>%UserProfile%\OneDrive\Pictures\Camera Roll</code></td>
</tr>
<tr>
<td>shell:OneDriveDocuments</td>
<td><code>%UserProfile%\OneDrive\Documents</code></td>
</tr>
<tr>
<td>shell:OneDriveMusic</td>
<td><code>%UserProfile%\OneDrive\Music</code></td>
</tr>
<tr>
<td>shell:OneDrivePictures</td>
<td><code>%UserProfile%\OneDrive\Pictures</code></td>
</tr>
<tr>
<td>shell:Personal</td>
<td><code>%UserProfile%\Documents</code></td>
</tr>
<tr>
<td>shell:PicturesLibrary</td>
<td><code>Libraries\Pictures</code></td>
</tr>
<tr>
<td>shell:PrintersFolder</td>
<td><code>All Control Panel Items\Printers</code></td>
</tr>
<tr>
<td>shell:PrintHood</td>
<td><code>%AppData%\Microsoft\Windows\Printer Shortcuts</code></td>
</tr>
<tr>
<td>shell:Profile</td>
<td><code>%UserProfile%</code></td>
</tr>
<tr>
<td>shell:ProgramFiles</td>
<td><code>%ProgramFiles%</code></td>
</tr>
<tr>
<td>shell:ProgramFilesCommon</td>
<td><code>%ProgramFiles%\Common Files</code></td>
</tr>
<tr>
<td>shell:ProgramFilesCommonX64</td>
<td><code>%ProgramFiles%\Common Files (64-bit Windows only)</code></td>
</tr>
<tr>
<td>shell:ProgramFilesCommonX86</td>
<td><code>%ProgramFiles(x86)%\Common Files (64-bit Windows only)</code></td>
</tr>
<tr>
<td>shell:ProgramFilesX64</td>
<td><code>%ProgramFiles% (64-bit Windows only)</code></td>
</tr>
<tr>
<td>shell:ProgramFilesX86</td>
<td><code>%ProgramFiles(x86)% (64-bit Windows only)</code></td>
</tr>
<tr>
<td>shell:Programs</td>
<td><code>%AppData%\Microsoft\Windows\Start Menu\Programs</code></td>
</tr>
<tr>
<td>shell:Public</td>
<td><code>%Public%</code></td>
</tr>
<tr>
<td>shell:PublicAccountPictures</td>
<td><code>%Public%\AccountPictures</code></td>
</tr>
<tr>
<td>shell:PublicGameTasks</td>
<td><code>%ProgramData%\Microsoft\Windows\GameExplorer</code></td>
</tr>
<tr>
<td>shell:PublicLibraries</td>
<td><code>%Public%\Libraries</code></td>
</tr>
<tr>
<td>shell:Quick Launch</td>
<td><code>%AppData%\Microsoft\Internet Explorer\Quick Launch</code></td>
</tr>
<tr>
<td>shell:Recent</td>
<td><code>%AppData%\Microsoft\Windows\Recent</code></td>
</tr>
<tr>
<td>shell:RecordedTVLibrary</td>
<td><code>Libraries\Recorded TV</code></td>
</tr>
<tr>
<td>shell:RecycleBinFolder</td>
<td><code>Recycle Bin</code></td>
</tr>
<tr>
<td>shell:ResourceDir</td>
<td><code>%WinDir%\Resources</code></td>
</tr>
<tr>
<td>shell:Ringtones</td>
<td><code>%ProgramData%\Microsoft\Windows\Ringtones</code></td>
</tr>
<tr>
<td>shell:Roamed Tile Images</td>
<td><code>%LocalAppData%\Microsoft\Windows\RoamedTileImages</code></td>
</tr>
<tr>
<td>shell:Roaming Tiles</td>
<td><code>%AppData%\Microsoft\Windows\RoamingTiles</code></td>
</tr>
<tr>
<td>shell:SavedGames</td>
<td><code>%UserProfile%\Saved Games</code></td>
</tr>
<tr>
<td>shell:Screenshots</td>
<td><code>%UserProfile%\Pictures\Screenshots</code></td>
</tr>
<tr>
<td>shell:Searches</td>
<td><code>%UserProfile%\Searches</code></td>
</tr>
<tr>
<td>shell:SearchHistoryFolder</td>
<td><code>%LocalAppData%\Microsoft\Windows\ConnectedSearch\History</code></td>
</tr>
<tr>
<td>shell:SearchHomeFolder</td>
<td><code>search-ms:</code></td>
</tr>
<tr>
<td>shell:SearchTemplatesFolder</td>
<td><code>%LocalAppData%\Microsoft\Windows\ConnectedSearch\Templates</code></td>
</tr>
<tr>
<td>shell:SendTo</td>
<td><code>%AppData%\Microsoft\Windows\SendTo</code></td>
</tr>
<tr>
<td>shell:Start Menu</td>
<td><code>%AppData%\Microsoft\Windows\Start Menu</code></td>
</tr>
<tr>
<td>shell:StartMenuAllPrograms</td>
<td><code>StartMenuAllPrograms</code></td>
</tr>
<tr>
<td>shell:Startup</td>
<td><code>%AppData%\Microsoft\Windows\Start Menu\Programs\Startup</code></td>
</tr>
<tr>
<td>shell:SyncCenterFolder</td>
<td><code>Control Panel\All Control Panel Items\Sync Center</code></td>
</tr>
<tr>
<td>shell:SyncResultsFolder</td>
<td><code>Control Panel\All Control Panel Items\Sync Center\Sync Results</code></td>
</tr>
<tr>
<td>shell:SyncSetupFolder</td>
<td><code>Control Panel\All Control Panel Items\Sync Center\Sync Setup</code></td>
</tr>
<tr>
<td>shell:System</td>
<td><code>%WinDir%\System32</code></td>
</tr>
<tr>
<td>shell:SystemCertificates</td>
<td><code>%AppData%\Microsoft\SystemCertificates</code></td>
</tr>
<tr>
<td>shell:SystemX86</td>
<td><code>%WinDir%\SysWOW64</code></td>
</tr>
<tr>
<td>shell:Templates</td>
<td><code>%AppData%\Microsoft\Windows\Templates</code></td>
</tr>
<tr>
<td>shell:ThisPCDesktopFolder</td>
<td><code>Desktop</code></td>
</tr>
<tr>
<td>shell:UsersFilesFolder</td>
<td><code>%UserProfile%</code></td>
</tr>
<tr>
<td>shell:User Pinned</td>
<td><code>%AppData%\Microsoft\Internet Explorer\Quick Launch\User Pinned</code></td>
</tr>
<tr>
<td>shell:UserProfiles</td>
<td><code>%HomeDrive%\Users</code></td>
</tr>
<tr>
<td>shell:UserProgramFiles</td>
<td><code>%LocalAppData%\Programs</code></td>
</tr>
<tr>
<td>shell:UserProgramFilesCommon</td>
<td><code>%LocalAppData%\Programs\Common</code></td>
</tr>
<tr>
<td>shell:UsersLibrariesFolder</td>
<td><code>Libraries</code></td>
</tr>
<tr>
<td>shell:VideosLibrary</td>
<td><code>Libraries\Videos</code></td>
</tr>
<tr>
<td>shell:Windows</td>
<td><code>%WinDir%</code></td>
</tr>
</tbody>
</table>
<h3 id="mmc-syntax">MMC Syntax</h3>
<table>
<thead>
<tr>
<th>Admin Snap-in</th>
<th>Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>Services Management</td>
<td>Services.msc</td>
</tr>
<tr>
<td>Performance Monitor</td>
<td>PerfMon.msc</td>
</tr>
<tr>
<td>Task Scheduler</td>
<td>TaskSchd.msc</td>
</tr>
<tr>
<td>Server Roles, Features</td>
<td>ServerManager.msc</td>
</tr>
<tr>
<td>Component Services</td>
<td>Comexp.msc</td>
</tr>
<tr>
<td>Computer Management</td>
<td>Compmgmt.msc</td>
</tr>
<tr>
<td>Win Mangement Instrum</td>
<td>WmiMgmt.msc</td>
</tr>
<tr>
<td>Notifications/Start menu/pol</td>
<td>DevModeRunAsUserConfig.msc</td>
</tr>
<tr>
<td>SQL Server configuration Man</td>
<td>SQLServerManager11.msc</td>
</tr>
<tr>
<td>Event Viewer</td>
<td>Eventvwr.msc</td>
</tr>
<tr>
<td>AD Domains and Trusts</td>
<td>Domain.msc</td>
</tr>
<tr>
<td>AD Sites and Services</td>
<td>DSsite.msc</td>
</tr>
<tr>
<td>ADSI Edit</td>
<td>ADSIedit.msc</td>
</tr>
<tr>
<td><strong><em>Disc, File</em></strong></td>
<td></td>
</tr>
<tr>
<td>Win Local Backup</td>
<td>WLBadmin.msc</td>
</tr>
<tr>
<td>Disk Manager</td>
<td>DiskMgmt.msc</td>
</tr>
<tr>
<td>Failover cluster Manager</td>
<td>Cluadmin.exe</td>
</tr>
<tr>
<td>Storage Mgmt</td>
<td>StorageMgmt.msc</td>
</tr>
<tr>
<td>Win Server Backup (Local+Rem)</td>
<td>WBadmin.msc</td>
</tr>
<tr>
<td>Disk Defragmenter</td>
<td>Defrag.exe (formerly Dfrg.msc)</td>
</tr>
<tr>
<td>Distributed File Service Mgmt</td>
<td>DFSmgmt.msc</td>
</tr>
<tr>
<td>Shared Folders open files</td>
<td>FSmgmt.msc</td>
</tr>
<tr>
<td>File Server Resource manager</td>
<td>FSRM.msc</td>
</tr>
<tr>
<td><strong><em>Hardware</em></strong></td>
<td></td>
</tr>
<tr>
<td>Device Manager</td>
<td>Devmgmt.msc</td>
</tr>
<tr>
<td>DNS Manager</td>
<td>DNSmgmt.msc</td>
</tr>
<tr>
<td>NAP client configuration</td>
<td>NapCLCfg</td>
</tr>
<tr>
<td>Quality of Service Control Man</td>
<td>ACSsnap.msc</td>
</tr>
<tr>
<td>Telephony Management</td>
<td>TAPImgmt.msc</td>
</tr>
<tr>
<td><strong><em>Policy</em></strong></td>
<td></td>
</tr>
<tr>
<td>Local Group Policy Editor</td>
<td>GPedit.msc</td>
</tr>
<tr>
<td>Group Policy Management</td>
<td>GPmc.msc</td>
</tr>
<tr>
<td>Local Security Settings Manager</td>
<td>SecPol.msc</td>
</tr>
<tr>
<td>Group Policy Management Editor</td>
<td>GPme.msc</td>
</tr>
<tr>
<td>Group Policy Starter GPO Editor</td>
<td>GPTedit.msc</td>
</tr>
<tr>
<td>Resultant Set of Policy</td>
<td>RSOP.msc</td>
</tr>
<tr>
<td>Print Management</td>
<td>PrintManagement.msc</td>
</tr>
<tr>
<td><strong><em>Remote Access</em></strong></td>
<td></td>
</tr>
<tr>
<td>Win Firewall</td>
<td>WF.msc</td>
</tr>
<tr>
<td>Teminal Services RDP</td>
<td>MSTSC</td>
</tr>
<tr>
<td>Remote Desktop</td>
<td>TSmmc.msc</td>
</tr>
<tr>
<td>Terminal Server Manager</td>
<td>TSadmin.exe</td>
</tr>
<tr>
<td>Teminal Services RDP to Console</td>
<td>MSTSC /v:[server] /console</td>
</tr>
<tr>
<td><strong><em>Security</em></strong></td>
<td></td>
</tr>
<tr>
<td>Certificate Templates</td>
<td>Certtmpl.msc</td>
</tr>
<tr>
<td>AD Users and Computers</td>
<td>DSA.msc</td>
</tr>
<tr>
<td>Trusted Platform Module</td>
<td>TPM.msc</td>
</tr>
<tr>
<td>Embedded Lockdown Manager</td>
<td>EmbeddedLockdown.msc</td>
</tr>
<tr>
<td>Local Users and Groups Manager</td>
<td>LUsrMgr.msc</td>
</tr>
<tr>
<td>Certificates Management Cur user</td>
<td>Certmgr.msc</td>
</tr>
<tr>
<td>Certificates Management Local mach</td>
<td>Certlm.msc</td>
</tr>
<tr>
<td>Authorization manager</td>
<td>AZman.msc</td>
</tr>
<tr>
<td>Certification Authority Management</td>
<td>Certsrv.msc</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td>From &lt;<a href="https://ss64.com/nt/syntax-mmc.html">https://ss64.com/nt/syntax-mmc.html</a></td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="control-panel">Control Panel</h3>
<p>!!!Note To create a shortcut:
1) Right click or press and hold on your desktop, click/tap on New, and click/tap on Shortcut.</p>
<pre><code>2) Copy the command you want from the table below as the &quot;location&quot;, and click/tap on Next.

3) Type a name you want for this shortcut, and click/tap on Finish.

4) If you like, you can Pin to Start, Pin to taskbar, add to All apps, add to Quick Launch, assign a keyboard shortcut to, or move this shortcut to where you like for easy use.
</code></pre>
<p>(Open Control Panel in last used view)  <code>%windir%\System32\control.exe</code></p>
<p>OR</p>
<p>(Always Open Control Panel in category view) <code>%windir%\explorer.exe shell:::{26EE0668-A00A-44D7-9371-BEB064C98683}</code></p>
<p>OR</p>
<p>(Always Open Control Panel in icons view) - x1<code>%windir%\explorer.exe shell:::{21EC2020-3AEA-1069-A2DD-08002B30309D}</code></p>
<p>| Date and Time (Date and Time) control /name Microsoft.DateAndTime                            |</p>
<table>
<thead>
<tr>
<th>Control Panel Item</th>
<th>Commands</th>
</tr>
</thead>
<tbody>
<tr>
<td>Add a Device wizard</td>
<td>%windir%\System32\DevicePairingWizard.exe</td>
</tr>
<tr>
<td>Add Hardware wizard</td>
<td>%windir%\System32\hdwwiz.exe</td>
</tr>
<tr>
<td>Add a Printer wizard</td>
<td>rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL AddPrinter</td>
</tr>
<tr>
<td>Additional Clocks</td>
<td>rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,1</td>
</tr>
<tr>
<td>Administrative Tools</td>
<td>control /name Microsoft.AdministrativeTools</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td><strong>control admintools</strong></td>
</tr>
<tr>
<td>AutoPlay</td>
<td>control /name Microsoft.AutoPlay</td>
</tr>
<tr>
<td>Backup and Restore (Win 7)</td>
<td>control /name Microsoft.BackupAndRestoreCenter</td>
</tr>
<tr>
<td>BitLocker Drive Encryption</td>
<td>control /name Microsoft.BitLockerDriveEncryption</td>
</tr>
<tr>
<td>Color and Appearance</td>
<td>explorer shell:::{ED834ED6-4B5A-4bfe-8F11-A626DCB6A921}...</td>
</tr>
<tr>
<td></td>
<td>(cont...) -Microsoft.Personalization\pageColorization</td>
</tr>
<tr>
<td>Color Management</td>
<td>control /name Microsoft.ColorManagement</td>
</tr>
<tr>
<td>Credential Manager</td>
<td>control /name Microsoft.CredentialManager</td>
</tr>
<tr>
<td></td>
<td>control timedate.cpl</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td><strong>control date/time</strong></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,0</td>
</tr>
<tr>
<td>Date and Time (Add'l Clocks)</td>
<td>rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,1</td>
</tr>
<tr>
<td>Default Programs</td>
<td>control /name Microsoft.DefaultPrograms</td>
</tr>
<tr>
<td>Desktop Background</td>
<td>explorer shell:::{ED834ED6-4B5A-4bfe-8F11-A626DCB6A921}</td>
</tr>
<tr>
<td></td>
<td>(cont...) -Microsoft.Personalization\pageWallpaper</td>
</tr>
<tr>
<td>Desktop Icon Settings</td>
<td>rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,0</td>
</tr>
<tr>
<td>Device Manager</td>
<td>control /name Microsoft.DeviceManager</td>
</tr>
<tr>
<td></td>
<td>control hdwwiz.cpl</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>devmgmt.msc</td>
</tr>
<tr>
<td>Devices and Printers</td>
<td>control /name Microsoft.DevicesAndPrinters</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control printers</td>
</tr>
<tr>
<td>Ease of Access Center</td>
<td>control /name Microsoft.EaseOfAccessCenter</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control access.cpl</td>
</tr>
<tr>
<td>File Explorer Opts (General tab)</td>
<td>control /name Microsoft.FolderOpts</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td><strong>control folders</strong></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Options_RunDLL 0</td>
</tr>
<tr>
<td>File Explorer Opts (View tab)</td>
<td>rundll32.exe shell32.dll,Options_RunDLL 7</td>
</tr>
<tr>
<td>File Explorer Opts (Search tab</td>
<td>rundll32.exe shell32.dll,Options_RunDLL 2</td>
</tr>
<tr>
<td>File History</td>
<td>control /name Microsoft.FileHistory</td>
</tr>
<tr>
<td>Fonts</td>
<td>control /name Microsoft.Fonts</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td><strong>control fonts</strong></td>
</tr>
<tr>
<td>Game Controllers</td>
<td>control /name Microsoft.GameControllers</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control joy.cpl</td>
</tr>
<tr>
<td>Get Programs</td>
<td>control /name Microsoft.GetPrograms</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,1</td>
</tr>
<tr>
<td>HomeGroup</td>
<td>control /name Microsoft.HomeGroup</td>
</tr>
<tr>
<td>Indexing Opts</td>
<td>control /name Microsoft.IndexingOptions</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL srchadmin.dll</td>
</tr>
<tr>
<td>Infrared</td>
<td>control /name Microsoft.Infrared</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control irprops.cpl</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control /name Microsoft.InfraredOptions</td>
</tr>
<tr>
<td>Internet Prop (General tab)</td>
<td>control /name Microsoft.InternetOptions</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control inetcpl.cpl</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,0</td>
</tr>
<tr>
<td>Internet Prop (Security tab)</td>
<td>rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,1</td>
</tr>
<tr>
<td>Internet Prop (Privacy tab)</td>
<td>rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,2</td>
</tr>
<tr>
<td>Internet Prop (Content tab)</td>
<td>rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,3</td>
</tr>
<tr>
<td>Internet Prop (Connections tab)</td>
<td>rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,4</td>
</tr>
<tr>
<td>Internet Prop (Programs tab)</td>
<td>rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,5</td>
</tr>
<tr>
<td>Internet Prop (Advanced tab)</td>
<td>rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,6</td>
</tr>
<tr>
<td>iSCSI Initiator</td>
<td>control /name Microsoft.iSCSIInitiator</td>
</tr>
<tr>
<td>Keyboard</td>
<td>control /name Microsoft.Keyboard</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control keyboard</td>
</tr>
<tr>
<td>Language</td>
<td>control /name Microsoft.Language</td>
</tr>
<tr>
<td>Mouse Prop</td>
<td>control /name Microsoft.Mouse</td>
</tr>
<tr>
<td>(Buttons tab 0)</td>
<td></td>
</tr>
<tr>
<td></td>
<td>control main.cpl</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control mouse</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL main.cpl,,0</td>
</tr>
<tr>
<td>Mouse Prop</td>
<td>control main.cpl,,1</td>
</tr>
<tr>
<td>(Pointers tab 1)</td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL main.cpl,,1</td>
</tr>
<tr>
<td>Mouse Prop</td>
<td>control main.cpl,,2</td>
</tr>
<tr>
<td>(Pointer Opt tab 2)</td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL main.cpl,,2</td>
</tr>
<tr>
<td>Mouse Prop</td>
<td>control main.cpl,,3</td>
</tr>
<tr>
<td>(Wheel tab 3)</td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL main.cpl,,3</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL main.cpl,,4</td>
</tr>
<tr>
<td>Network and Sharing Center</td>
<td>control /name Microsoft.NetworkAndSharingCenter</td>
</tr>
<tr>
<td>Network Connections</td>
<td>control ncpa.cpl</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control netconnections</td>
</tr>
<tr>
<td>Network Setup Wizard</td>
<td>control netsetup.cpl</td>
</tr>
<tr>
<td>Notification Area Icons</td>
<td>explorer shell:::{05d7b0f4-2121-4eff-bf6b-ed3f69b894d9}</td>
</tr>
<tr>
<td>ODBC Data Source Administrator</td>
<td>control odbccp32.cpl</td>
</tr>
<tr>
<td>Offline Files</td>
<td>control /name Microsoft.OfflineFiles</td>
</tr>
<tr>
<td>Perf Opts (Vis Effects)</td>
<td>%windir%\system32\SystemPropertiesPerformance.exe</td>
</tr>
<tr>
<td>Perf Opts (DEP)</td>
<td>%windir%\system32\SystemPropertiesDataExecutionPrevention.exe</td>
</tr>
<tr>
<td>Personalization</td>
<td>explorer shell:::{ED834ED6-4B5A-4bfe-8F11-A626DCB6A921}</td>
</tr>
<tr>
<td>Phone and Modem</td>
<td>control /name Microsoft.PhoneAndModem</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control telephon.cpl</td>
</tr>
<tr>
<td>Power Opts</td>
<td>control /name Microsoft.PowerOptions</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td><em>Power Opts</em></td>
<td>control powercfg.cpl</td>
</tr>
<tr>
<td>- Advanced settings</td>
<td>control powercfg.cpl,,1</td>
</tr>
<tr>
<td>- Create a Power Plan</td>
<td>control /name Microsoft.PowerOptions /page pageCreateNewPlan</td>
</tr>
<tr>
<td>- Edit Plan Settings</td>
<td>control /name Microsoft.PowerOptions /page pagePlanSettings</td>
</tr>
<tr>
<td>- System Settings</td>
<td>control /name Microsoft.PowerOptions /page pageGlobalSettings</td>
</tr>
<tr>
<td>Presentation Settings</td>
<td>%windir%\system32\PresentationSettings.exe</td>
</tr>
<tr>
<td>Programs and Features</td>
<td>control /name Microsoft.ProgramsAndFeatures</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control appwiz.cpl</td>
</tr>
<tr>
<td>Recovery</td>
<td>control /name Microsoft.Recovery</td>
</tr>
<tr>
<td>Region (Formats tab)</td>
<td>control /name Microsoft.RegionAndLanguage</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control /name Microsoft.RegionalAndLanguageOptions /page /p:&quot;Formats&quot;</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control intl.cpl</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control international</td>
</tr>
<tr>
<td>Region (Location tab)</td>
<td>control /name Microsoft.RegionalAndLanguageOptions /page /p:&quot;Location&quot;</td>
</tr>
<tr>
<td>Region (Administrative tab)</td>
<td>control /name Microsoft.RegionalAndLanguageOptions /page /p:&quot;Administrative&quot;</td>
</tr>
<tr>
<td>RemoteApp and Desktop Connections</td>
<td>control /name Microsoft.RemoteAppAndDesktopConnections</td>
</tr>
<tr>
<td>Scanners and Cameras</td>
<td>control /name Microsoft.ScannersAndCameras</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control sticpl.cpl</td>
</tr>
<tr>
<td>Screen Saver Settings</td>
<td>rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,1</td>
</tr>
<tr>
<td>Security and Maintenance</td>
<td>control /name Microsoft.ActionCenter</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control wscui.cpl</td>
</tr>
<tr>
<td>Set Associations</td>
<td>control /name Microsoft.DefaultPrograms /page pageFileAssoc</td>
</tr>
<tr>
<td>Set Default Programs</td>
<td>control /name Microsoft.DefaultPrograms /page pageDefaultProgram</td>
</tr>
<tr>
<td>Set Program Acc and Defaults</td>
<td>rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,3</td>
</tr>
<tr>
<td>Sound (Playback tab)</td>
<td>control /name Microsoft.Sound</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control mmsys.cpl</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>%windir%\System32\rundll32.exe shell32.dll,Control_RunDLL mmsys.cpl,,0</td>
</tr>
<tr>
<td>Sound (Recording tab)</td>
<td>%windir%\System32\rundll32.exe shell32.dll,Control_RunDLL mmsys.cpl,,1</td>
</tr>
<tr>
<td>Sound (Sounds tab)</td>
<td>%windir%\System32\rundll32.exe shell32.dll,Control_RunDLL mmsys.cpl,,2</td>
</tr>
<tr>
<td>Sound (Communications tab)</td>
<td>%windir%\System32\rundll32.exe shell32.dll,Control_RunDLL mmsys.cpl,,3</td>
</tr>
<tr>
<td>Speech Recognition</td>
<td>control /name Microsoft.SpeechRecognition</td>
</tr>
<tr>
<td>Storage Spaces</td>
<td>control /name Microsoft.StorageSpaces</td>
</tr>
<tr>
<td>Sync Center</td>
<td>control /name Microsoft.SyncCenter</td>
</tr>
<tr>
<td>System</td>
<td>control /name Microsoft.System</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td>control sysdm.cpl</td>
</tr>
<tr>
<td>System Icons</td>
<td>explorer shell:::{05d7b0f4-2121-4eff-bf6b-ed3f69b894d9} \SystemIcons,,0</td>
</tr>
<tr>
<td>System Prop (Computer Name)</td>
<td>%windir%\System32\SystemPropertiesComputerName.exe</td>
</tr>
<tr>
<td>System Prop (Hardware)</td>
<td>%windir%\System32\SystemPropertiesHardware.exe</td>
</tr>
<tr>
<td>System Prop (Advanced)</td>
<td>%windir%\System32\SystemPropertiesAdvanced.exe</td>
</tr>
<tr>
<td>System Prop (System Protection)</td>
<td>%windir%\System32\SystemPropertiesProtection.exe</td>
</tr>
<tr>
<td>System Prop (Remote)</td>
<td>%windir%\System32\SystemPropertiesRemote.exe</td>
</tr>
<tr>
<td>Tablet PC Settings</td>
<td>control /name Microsoft.TabletPCSettings</td>
</tr>
<tr>
<td>Text to Speech</td>
<td>control /name Microsoft.TextToSpeech</td>
</tr>
<tr>
<td>Troubleshooting</td>
<td></td>
</tr>
<tr>
<td>User Accounts</td>
<td>control /name Microsoft.UserAccounts</td>
</tr>
<tr>
<td></td>
<td>control userpasswords</td>
</tr>
<tr>
<td>User Accounts (netplwiz)</td>
<td>netplwiz</td>
</tr>
<tr>
<td></td>
<td>control userpasswords2</td>
</tr>
<tr>
<td>Windows Defender Antivirus</td>
<td>%ProgramFiles%\Windows Defender\MSASCui.exe</td>
</tr>
<tr>
<td>Windows Defender Firewall</td>
<td>control /name Microsoft.WindowsFirewall</td>
</tr>
<tr>
<td></td>
<td>control firewall.cpl</td>
</tr>
<tr>
<td>Windows Features</td>
<td>%windir%\System32\OptionalFeatures.exe</td>
</tr>
<tr>
<td></td>
<td>rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,2</td>
</tr>
<tr>
<td>Windows Mobility Center</td>
<td>control /name Microsoft.MobilityCenter</td>
</tr>
<tr>
<td>Windows To Go</td>
<td>%windir%\System32\pwcreator.exe</td>
</tr>
<tr>
<td>Work Folders</td>
<td>%windir%\System32\WorkFolders.exe</td>
</tr>
</tbody>
</table>
<p>*[DEP]: Data Execution Prevention</p>
<h3 id="turn-off-the-monitors">Turn off the monitors</h3>
<pre><code class="language-powershell"><div><span class="hljs-comment">#PS</span>
<span class="hljs-built_in">Add-Type</span> <span class="hljs-string">'[DllImport("user32.dll")] public static extern int SendMessage(int hWnd, int hMsg, int wParam, int lParam);'</span> -Name a -Pas)::SendMessage(-<span class="hljs-number">1</span>,<span class="hljs-number">0</span>x0112,<span class="hljs-number">0</span>xF170,<span class="hljs-number">2</span>)
</div></code></pre>
<pre><code class="language-batch"><div>powershell (Add-Type '[DllImport(\&quot;user32.dll\&quot;)]^public static extern int SendMessage(int hWnd, int hMsg, int wParam, int lParam);' -Name a -Pas)::SendMessage(-1,0x0112,0xF170,2)
</div></code></pre>
<p>Seems to leave a process running though. It doesn't end on its own. May be worth investigating.</p>
<h3 id="sfc">SFC</h3>
<pre><code class="language-bat"><div>SFC /scannow
<span class="hljs-built_in">findstr</span> /c:"[SR]" <span class="hljs-variable">%windir%</span>\Logs\CBS\CBS.log &gt;<span class="hljs-variable">%userprofile%</span>\Desktop\sfcdetails.txt &amp;&amp; notepad.exe "<span class="hljs-variable">%userprofile%</span>\Desktop\sfcdetails.txt"
</div></code></pre>
<h3 id="dism">DISM</h3>
<pre><code class="language-bat"><div>Dism /Online /Cleanup-Image /CheckHealth
Dism /Online /Cleanup-Image /ScanHealth
Dism /Online /Cleanup-Image /RestoreHealth
</div></code></pre>
<h3 id="reg">reg</h3>
<p>reg is a command line function to edit the registry.  An example from elsewhere in the document.</p>
<pre><code class="language-batch"><div>reg add &quot;HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot; /v &quot;LaunchTo&quot; /t REG_DWORD /d 1 /f
</div></code></pre>
<p>REG Operation [Parameter List]</p>
<p>Operation =  [ QUERY | ADD | DELETE | COPY | SAVE | LOAD | UNLOAD | RESTORE | COMPARE | EXPORT | IMPORT  | FLAGS ]</p>
<p>Return Code: (Except for REG COMPARE)   0 - Successful, 1 - Failed</p>
<p>For help on a specific operation type:  <code>REG Operation /?</code>. Examples:</p>
<p>REG QUERY /?
REG ADD /?
REG DELETE /?
REG COPY /?
REG SAVE /?
REG RESTORE /?
REG LOAD /?
REG UNLOAD /?
REG COMPARE /?
REG EXPORT /?
REG IMPORT /?
REG FLAGS /?</p>
<p>C:\Windows\system32&gt;reg add /?</p>
<ul>
<li>
<p>REG ADD KeyName [/v ValueName | /ve] [/t Type] [/s Separator] [/d Data] [/f] [/reg:32 | /reg:64]</p>
<ul>
<li>KeyName  [\Machine]FullKey
<ul>
<li>Machine  Name of remote machine - omitting defaults to the current machine. Only HKLM and HKU are available on remote machines.</li>
<li>FullKey  ROOTKEY\SubKey</li>
<li>ROOTKEY  [ HKLM | HKCU | HKCR | HKU | HKCC ]
<ul>
<li>SubKey   The full name of a registry key under the selected ROOTKEY.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>/v       The value name, under the selected Key, to add.</p>
</li>
<li>
<p>/ve      adds an empty value name (Default) for the key.</p>
</li>
<li>
<p>/t       RegKey data types</p>
<ul>
<li>[ REG_SZ | REG_MULTI_SZ | REG_EXPAND_SZ | REG_DWORD | REG_QWORD | REG_BINARY | REG_NONE ] If omitted, REG_SZ is assumed.</li>
</ul>
</li>
<li>
<p>/s       Specify one character that you use as the separator in your data string for REG_MULTI_SZ. If omitted, use &quot;\0&quot; as the separator.</p>
</li>
<li>
<p>/d       The data to assign to the registry ValueName being added.</p>
</li>
<li>
<p>/f       Force overwriting the existing registry entry without prompt.</p>
</li>
<li>
<p>/reg:32  Specifies the key should be accessed using the 32-bit registry view.</p>
</li>
<li>
<p>/reg:64  Specifies the key should be accessed using the 64-bit registry view.</p>
</li>
</ul>
<p>Examples:</p>
<ul>
<li><code>REG ADD \\ABC\HKLM\Software\MyCo</code> - Adds a key HKLM\Software\MyCo on remote machine ABC</li>
<li><code>REG ADD HKLM\Software\MyCo /v Data /t REG_BINARY /d fe340ead</code> - Adds a value (name: Data, type: REG_BINARY, data: fe340ead)</li>
<li><code>REG ADD HKLM\Software\MyCo /v MRU /t REG_MULTI_SZ /d fax\0mail</code> - Adds a value (name: MRU, type: REG_MULTI_SZ, data: fax\0mail\0\0)</li>
<li><code>REG ADD HKLM\Software\MyCo /v Path /t REG_EXPAND_SZ /d ^%systemroot^%</code> - Adds a value (name: Path, type: REG_EXPAND_SZ, data: %systemroot%)   Notice:  Use the caret symbol ( ^ ) inside the expand string</li>
</ul>
<h4 id="query">Query</h4>
<pre><code class="language-batch"><div>reg Query /?

REG QUERY KeyName [/v [ValueName] | /ve] [/s]
          [/f Data [/k] [/d] [/c] [/e]] [/t Type] [/z] [/se Separator]
          [/reg:32 | /reg:64]

  KeyName  [\\Machine\]FullKey
           Machine - Name of remote machine, omitting defaults to the
                     current machine. Only HKLM and HKU are available on
                     remote machines
           FullKey - in the form of ROOTKEY\SubKey name
                ROOTKEY - [ HKLM | HKCU | HKCR | HKU | HKCC ]
                SubKey  - The full name of a registry key under the
                          selected ROOTKEY

  /v       Queries for a specific registry key values.
           If omitted, all values for the key are queried.

           Argument to this switch can be optional only when specified
           along with /f switch. This specifies to search in valuenames only.

  /ve      Queries for the default value or empty value name (Default).

  /s       Queries all subkeys and values recursively (like dir /s).

  /se      Specifies the separator (length of 1 character only) in
           data string for REG_MULTI_SZ. Defaults to &quot;\0&quot; as the separator.

  /f       Specifies the data or pattern to search for.
           Use double quotes if a string contains spaces. Default is &quot;*&quot;.

  /k       Specifies to search in key names only.

  /d       Specifies the search in data only.

  /c       Specifies that the search is case sensitive.
           The default search is case insensitive.

  /e       Specifies to return only exact matches.
           By default all the matches are returned.

  /t       Specifies registry value data type.
           Valid types are:
             REG_SZ, REG_MULTI_SZ, REG_EXPAND_SZ,
             REG_DWORD, REG_QWORD, REG_BINARY, REG_NONE
           Defaults to all types.

  /z       Verbose: Shows the numeric equivalent for the type of the valuename.

  /reg:32  Specifies the key should be accessed using the 32-bit registry view.

  /reg:64  Specifies the key should be accessed using the 64-bit registry view.

Examples:

  REG QUERY HKLM\Software\Microsoft\ResKit /v Version
    Displays the value of the registry value Version

  REG QUERY \\ABC\HKLM\Software\Microsoft\ResKit\Nt\Setup /s
    Displays all subkeys and values under the registry key Setup
    on remote machine ABC

  REG QUERY HKLM\Software\Microsoft\ResKit\Nt\Setup /se #
    Displays all the subkeys and values with &quot;#&quot; as the seperator
    for all valuenames whose type is REG_MULTI_SZ.

  REG QUERY HKLM /f SYSTEM /t REG_SZ /c /e
    Displays Key, Value and Data with case sensitive and exact
    occurrences of &quot;SYSTEM&quot; under HKLM root for the data type REG_SZ

  REG QUERY HKCU /f 0F /d /t REG_BINARY
    Displays Key, Value and Data for the occurrences of &quot;0F&quot; in data
    under HKCU root for the data type REG_BINARY

  REG QUERY HKLM\SOFTWARE /ve
    Displays Value and Data for the empty value (Default)
    under HKLM\SOFTWARE
</div></code></pre>
<h3 id="powercfg">Powercfg</h3>
<p>Edit the power configuration settings</p>
<ul>
<li><code>powercfg /list</code> - list the power profiles</li>
<li><code>powercfg /query</code> -display the current power settings.</li>
<li><code>powercfg /export C:\somefile.POW {GUID of profile}</code></li>
<li><code>powercfg /change [option]</code>
monitor-timeout-ac
monitor-timeout-dc
disk-timeout-ac
disk-timeout-dc
standby-timeout-ac
standby-timeout-dc
hibernate-timeout-ac
hibernate-timeout-dc</li>
</ul>
<h3 id="sleepstudy">SleepStudy</h3>
<p><code>powercfg sleepstudy</code></p>
<p>passing this will output an HTML file into the file you are in.</p>
<h3 id="logman">Logman</h3>
<p><code>logman</code> looks at the currently running loggers from performance manager.</p>
<h3 id="netsh">netsh</h3>
<p>View the Windows Network Config Script:</p>
<p>This shows all the settings</p>
<pre><code class="language-batch"><div>netsh
&gt;dump
</div></code></pre>
<h3 id="attrib">Attrib</h3>
<p>Sets and changes file attributes.</p>
<p><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/attrib">Docs</a></p>
<ul>
<li>R - <strong>ReadOnly</strong></li>
<li>A - <strong>Archive file attribute.</strong></li>
<li>S - System file attribute.</li>
<li>H - Hidden file attribute.</li>
<li>O - <em>Offline attribute.</em></li>
<li>I - <strong>Not content indexed file attribute.</strong></li>
<li>X - <em>No scrub file attribute.</em></li>
<li>V - <em>Integrity attribute.</em></li>
<li>P - <em>Pinned attribute.</em></li>
<li>U - <em>Unpinned attribute.</em></li>
<li>B - <em>SMR Blob attribute.</em></li>
</ul>
<p>A few useful aspects:</p>
<p>Navigate to a root dir, and run <code>ATTRIB /S /D -A</code> -  this clears the archive attribute.  Any file that changes from that point on will have it set.  Then you can run backup only files with <code>+A</code> attribute.</p>
<p>I am interesting in checking out if the <code>-I</code> flag might help my computer or laptop from wasting time.</p>
<p>Read Only and Hidden are visible in Properties.  Archive and Index are under advanced.  I am not sure what the remaining attributes do or where to find them.  Interestingly, the italicized items dont even appear in documentation.</p>
<h3 id="bcdedit">BCDEdit</h3>
<h4 id="safemode">Safemode</h4>
<p>Re-allow the <strong>F8</strong> menu upon startup. May not work with Windows 10.</p>
<pre><code class="language-batch"><div>bcdedit /set {bootmgr} displaybootmenu yes
echo to turn off
bcdedit /set {bootmgr} displaybootmenu no
</div></code></pre>
<h3 id="wmic-windows-management-instrumentation-console">WMIC Windows Management Instrumentation Console</h3>
<p><code>wmic diskdrive list brief</code></p>
<h3 id="takeown">Takeown</h3>
<p><code>takeown /r /f c:\windows\csc</code></p>
<h3 id="diskpart">Diskpart</h3>
<p>To make it stop trying to connect to a dead drive</p>
<pre><code class="language-batch"><div>diskpart
    automount disable
    automount scrub
</div></code></pre>
<h3 id="services-sc">Services (sc)</h3>
<p>See the <a href="#Batch-File">Streamline Windows Batch File</a> for more examples?</p>
<pre><code class="language-bat"><div>sc <span class="hljs-built_in">start</span> vmms
sc queryex eventlog vmms
</div></code></pre>
<h3 id="vssadmin">VSSADMIN</h3>
<p>Take a look and see where your computer is storing ShadowCopy Backups</p>
<p><code>vssadmin list providers</code> list the things making shadowcopies.  Just Windows usually.</p>
<p><code>vssadmin list volumes</code> -list the drives where shadow copies are kept</p>
<p><code>vssadmin list shadows</code> - more interesting, lists the specific backups. Like this:</p>
<pre><code>    Contents of shadow copy set ID: {91131afe-b83c-44cd-b243-142b8ed9d4b7}
    Contained 1 shadow copies at creation time: 3/24/2019 5:02:29 AM
        Shadow Copy ID: {db24bd58-fcb5-4fe4-877f-af5c43cadc5f}
            Original Volume: (X:)\\?\Volume{8e24b15f-7991-4509-bdcd-46e88aafab92}\
            Shadow Copy Volume: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy36
            Originating Machine: DESKTOP
            Service Machine: DESKTOP
            Provider: 'Microsoft Software Shadow Copy provider 1.0'
            Type: DataVolumeRollback
            Attributes: Persistent, No auto release, No writers, Differential
</code></pre>
<p><code>vssadmin list shadowstorage</code> -shows by drive how much space is taken up and how much is left.
Shadow Copy Storage association
For volume: (P:)\?\Volume{11696a83-1b1a-44da-b6af-a7dca2d81c33}<br>
Shadow Copy Storage volume: (P:)\?\Volume{11696a83-1b1a-44da-b6af-a7dca2d81c33}<br>
Used Shadow Copy Storage space: 32.1 MB (0%)
Allocated Shadow Copy Storage space: 5.12 GB (1%)
Maximum Shadow Copy Storage space: 102 GB (26%)</p>
<p><code>vssadmin list writers</code> - not that interesting lists services that use VSS. <strong>Will tell you if there is an error from each service</strong></p>
<p><code>vssadmin Resize ShadowStorage</code> -</p>
<p><code>vssadmin Delete Shadows /For=C:</code></p>
<h3 id="schtasks">schtasks</h3>
<p>Description: Enables an administrator to create, delete, query, change, run and end scheduled tasks on a local or remote system.</p>
<p>SCHTASKS /parameter [arguments]</p>
<p>Parameter List:</p>
<ul>
<li>/Create         Creates a new scheduled task.</li>
<li>/Delete         Deletes the scheduled task(s).</li>
<li>/Query          Displays all scheduled tasks.</li>
<li>/Change         Changes the properties of scheduled task.</li>
<li>/Run            Runs the scheduled task on demand.</li>
<li>/End            Stops the currently running scheduled task.</li>
<li>/ShowSid        Shows the security identifier corresponding to a scheduled task name.</li>
<li>/?              Displays this help message.</li>
</ul>
<p>Examples:</p>
<ul>
<li>SCHTASKS</li>
<li>SCHTASKS /?</li>
<li>SCHTASKS /Run /?</li>
<li>SCHTASKS /End /?</li>
<li>SCHTASKS /Create /?</li>
<li>SCHTASKS /Delete /?</li>
<li>SCHTASKS /Query  /?</li>
<li>SCHTASKS /Change /?</li>
<li>SCHTASKS /ShowSid /?</li>
</ul>
<p>Just typing <code>schtasks</code> will list all the scheduled and disabled tasks.</p>
<p>See the <a href="#Batch-File">Streamline Windows Batch File</a> for more examples?</p>
<h3 id="install-windows-feature-wsl">Install Windows Feature (WSL)</h3>
<pre><code class="language-powershell"><div>Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
</div></code></pre>
<h3 id="winrar">Winrar</h3>
<p>Program is contained in &quot;C:\Program Files\WinRar\WinRAR.exe&quot; usually</p>
<pre><code class="language-batch"><div>&quot;C:\Program Files\WinRar\WinRAR.exe&quot;
#To Add
cd d:\SaveDirectory
&quot;C:\Program Files\WinRar\WinRAR.exe&quot; a fileName.rar &quot;D:\ASUSsync\VS Code\md\*

#Append date to filename with -ag
mkdir d:\asussync\backups\
&quot;C:\Program Files\WinRar\WinRAR.exe&quot; a -ag+YYMMDD &quot;D:\ASUSsync\Backups\vsCodeBackUp.rar&quot; &quot;D:\ASUSsync\VS Code\md\*&quot;  &quot;D:\ASUSsync\ASUSVS-WorkSpace.code-workspace&quot; &quot;D:\ASUSsync\VS Code\.vscode\*&quot;

#Using a file list and using version numbers and month string
&quot;C:\Program Files\WinRar\WinRAR.exe&quot; a -ag+YYMMM{v}nn-- -@+ &quot;D:\ASUSsync\Backups\vsCodeBackUp.rar&quot; @&quot;D:\Asussync\backups\backups.txt&quot;
</div></code></pre>
<h4 id="backup">Backup</h4>
<p>!!!Warning Warning: This is a pop-up mess...Diasble Javascript before you go <a href="http://rareelement.tripod.com/winrar_sk.htm">Source</a></p>
<h5 id="full-backup">Full Backup</h5>
<p>Intro: This is a backup of ALL the existing files in source folder.
Comment: This backup may be done once a while to get a complete snapshot of all the file at that moment.
Restoration: To restore a file, files can be directly retrieved from this archive (if no newer backup exists)</p>
<p>Command line:
<code>winrar.exe a -se -rr3% -ac -ag+YYYYMMDD_full_ -k -m5 -ms -os -r -ep1 e:\mydoc.rar @mydocpath.txt</code></p>
<table>
<thead>
<tr>
<th>command/switch</th>
<th>Purpose Used</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>add files to archive</td>
</tr>
<tr>
<td>-se</td>
<td>solid archive based on file extensions[1]</td>
</tr>
<tr>
<td>-ac</td>
<td>clear archive attribute after archival</td>
</tr>
<tr>
<td>-ag+YYYYMMDD_</td>
<td>add current date in archive name</td>
</tr>
<tr>
<td>-k</td>
<td>protect archive from tamper or accidental modification</td>
</tr>
<tr>
<td>-m5</td>
<td>use best compression (also slowest)</td>
</tr>
<tr>
<td>-ms</td>
<td>Do not waste time in re-compressing compressed files [2]</td>
</tr>
<tr>
<td>-os</td>
<td>keep NTFS streams (recommended if your files are stored on NTFS)</td>
</tr>
<tr>
<td>-r</td>
<td>recurs subfolders</td>
</tr>
<tr>
<td>-ep1</td>
<td>strip base folder name</td>
</tr>
<tr>
<td>-rr3%</td>
<td>recovery record is 3%</td>
</tr>
</tbody>
</table>
<p>Additional</p>
<p>-md128</p>
<p>-mct -text compression</p>
<p>winrar.exe a -se -rr3% -ac -ag+YYYYMMDD_full_ -k -m5 -ms -os -r -ep1 -mc30:128t+ -md128 e:\ASUSsyncBU.rar @.\BackupPaths.txt</p>
<p>[1]- not recommended due to data loss risk on low quality media</p>
<p>[2]- such as ace, arj, bz2, cab, gz, jpeg, jpg, lha, lzh, mp3, rar, zip, taz, tgz, z</p>
<p>[3]- (alter as per the reliability of your media)</p>
<h5 id="incremental-backup">Incremental Backup</h5>
<p>Intro: Takes backup of the files modified since the last backup.</p>
<p>Comment: Takes very less time as only a small number of files are usually changed daily. These are the files backup up by this method.</p>
<p>Restoration: To restore a file, you need to first retrieve the last FULL backup, then ALL the incremental backups up to the date required in chronologically dated order, starting from the oldest to the latest.</p>
<p>Command Line: <code>winrar.exe a -se -rr3% -ac -ag+YYYYMMDD_incr_ -k -m4 -ms -os -r -ep1 -ac -ao e:\mydoc.rar @mydocpath.txt</code></p>
<p>Command/switches used with purpose:</p>
<table>
<thead>
<tr>
<th>command/switch</th>
<th>Purpose Used</th>
</tr>
</thead>
<tbody>
<tr>
<td>All from the FULL backup</td>
<td>As tabulate above</td>
</tr>
<tr>
<td>-ao</td>
<td>add only the files with archive bit on</td>
</tr>
<tr>
<td>-m4</td>
<td>Replaced -m5 with -m4 for faster daily backups</td>
</tr>
<tr>
<td>REMOVE -m5</td>
<td>Replaced -m5 with -m4 for faster daily backups</td>
</tr>
</tbody>
</table>
<h5 id="differential-backup">Differential Backup</h5>
<p>Intro: Takes backup of all files since the last FULL backup.</p>
<p>Comment: Takes more time to backup with time. This is because this backup backups up all files modified since the last FULL backup.</p>
<p>Restoration: To restore a file, retrieve the last FULL backup, and then the latest differential backup file.</p>
<p>Command Line: <code>winrar.exe a -se -rr3% -ag+YYYYMMDD_diff_ -k -m4 -ms -os -r -ep1 -ao e:\mydoc.rar @mydocpath.txt</code></p>
<p>Command/switches used with purpose:</p>
<table>
<thead>
<tr>
<th>command/switch</th>
<th>Purpose Used</th>
</tr>
</thead>
<tbody>
<tr>
<td>All from the FULL backup</td>
<td>As tabulate above</td>
</tr>
<tr>
<td>-ao</td>
<td>add only the files with archive bit on</td>
</tr>
<tr>
<td>REMOVE -ac</td>
<td>to prevent the archive bit from changing due to backup</td>
</tr>
<tr>
<td>-m4</td>
<td>Replaced -m5 with -m4 for faster daily backups</td>
</tr>
<tr>
<td>REMOVE -m5</td>
<td>Replaced -m5 with -m4 for faster daily backups</td>
</tr>
</tbody>
</table>
<h3 id="7zip">7zip</h3>
<p>7z.exe a -t7z backup.7z -mx5 -m0=lzma2 -ms=200f -mmt=8
&quot;%inkscapePath%&quot; --without-gui --file=&quot;%%cd%%%%i&quot; --export-png=&quot;%%cd%%\tmp%%j%%~ni-%%j.png&quot; --export-dpi=%%j
set /a innercount=innercount+1
7z a  %fileName%.7z &quot;.**.png&quot; -r -y -aoa -bse1 -bso0 -w&quot;.\tmp&quot; -m0=LZMAs=100f10m</p>
<p>-bsxy
comes in pairs x= (p - info, e- error, ? i forgot 3 debug maybe?) and y is 0 nowhere, 1 stdout 2 stderr the screen.</p>
<p><code>-bse1 &gt; Errorlog.txt</code> pipes out the error messages.
::-bse1 bs is redirect output and e is error and 1 is sted out
::-bso0 redirects standard output messages to 0 (off)</p>
<p>::setting methods is complicated af</p>
<p>methods
:: this is supposed to be the method  -m0=LZMA2s=100f10m
s=100f10m = solid format 100files or 10 Mb
-mx(1-9) sets default strength from store to ultra eg -mx1</p>
<p>Another example <code>7z.exe a -t7z backup.7z -mx1 -m0=lzma2:d=1024m:fb=273 -ms=16g -mmt=24</code>
-mmt=# is number of cpu threads
-ms=16g is solid, break into 16gb, can use b,k,m,g and f for files.
fb is fast bytes (IDK)
d: is directory size.T
There is a ton more.</p>
<p>-aoa - append and overwrite</p>
<p>-y dont ask</p>
<p>-r subfolders.</p>
<p>-w&quot;.\tmp&quot; workign directory?</p>
<p>format is always 7z. then command.  a for add.  then archive.  The rest can be allegely any order.  Its confusing as hell</p>
<h3 id="inkscape">Inkscape</h3>
<p><a href="https://inkscape.org/doc/inkscape-man.html">Inkscape Command Line</a></p>
<p>%inkscapePath%&quot; --without-gui --file=&quot;.%%i&quot; --export-png=&quot;.\tmp%%j%DirN%%%~ni-%%j.png&quot; --export-dpi=%%j</p>
<p>See the batch script in scripts</p>
<h3 id="imagemagick">ImageMagick</h3>
<p><a href="https://www.imagemagick.org/script/command-line-processing.php">Image Magic CLI Doc</a></p>
<p><a href="https://www.imagemagick.org/Usage/">Magick Examples</a></p>
<p><a href="https://www.imagemagick.org/Usage/thumbnails/#html">Magick Doc Thumbnails</a></p>
<p>Make sure its added to PATH</p>
<p>then its run with <code>magick.exe</code></p>
<p>The ImageMagick command-line consists of</p>
<p>one or more required input filenames.
zero, one, or more image settings.
zero, one, or more image operators.
zero, one, or more image sequence operators.
zero, one, or more image stacks.
zero or one output image filenames (required by convert, composite, montage, compare, import, conjure).</p>
<p><code>magick logo: gif:- | display gif:-</code>
magick.exe montage  -label '%f' -size 128x128 '.*.svg[128x128]' -auto-orient -caption &quot;scraping-166&quot;-geometry '100x100x10x10'-tile 8x &quot;index.png&quot;
magick.exe montage  -label '%f' -size 128x128 '.*.svg[128x128]' -auto-orient -title  &quot;Contents of %d &quot;-geometry '100x100x10x10'-tile 8x &quot;index.png&quot;</p>
<p>montage -label '%t\n%[width]x%[height]' <br>
-size 512x512 '../img_photos/<em>_orig.</em>[120x90]' -auto-orient <br>
-geometry +5+5 -tile 5x  -frame 5  -shadow  photo_index.html</p>
<p>montage -label '%t'  -size 128x128 './100/*.svg[128x128]' -auto-orient -geometry +5+5 -tile 5x  -frame 5  -shadow  photo_index-%d.html</p>
<pre><code>Title settings
    montage -pointsize 24  -background Lavender \
            -font Candice      -label Candice      label:Abc-123 \
            -font Corsiva      -label Corsiva      label:Abc-123 \
            -font SheerBeauty  -label SheerBeauty  label:Abc-123 \
            -font Ravie        -label Ravie        label:Abc-123 \
            -font Arial        -label Arial        label:Abc-123 \
            -font ArialI       -label ArialI       label:Abc-123 \
            -font ArialB       -label ArialB       label:Abc-123 \
            -font ArialBk      -label ArialBk      label:Abc-123 \
            -font CourierNew   -label CourierNew   label:Abc-123 \
            -font LokiCola     -label LokiCola     label:Abc-123 \
            -font Gecko        -label Gecko        label:Abc-123 \
            -font Wedgie       -label Wedgie       label:Abc-123 \
            -font WebDings     -label WebDings     label:Abc-123 \
            -font WingDings    -label WingDings    label:Abc-123 \
            -font WingDings2   -label WingDings2   label:Abc-123 \
            -font Zymbols      -label Zymbols      label:Abc-123 \
            \
            -frame 5  -geometry +2+2   -font Arial -pointsize 12 \
            -background none  -bordercolor SkyBlue  -mattecolor DodgerBlue \
            montage_fonts.gif
</code></pre>
<pre><code><div> convert image.png  -background white \
          \( -clone 0 -resize 16x16 -extent 16x16 \) \
          \( -clone 0 -resize 32x32 -extent 32x32 \) \
          \( -clone 0 -resize 48x48 -extent 48x48 \) \
          \( -clone 0 -resize 64x64 -extent 64x64 \) \
          -delete 0 -alpha off -colors 256 favicon.ico
</div></code></pre>
<p>Single Letter Attribute Percent Escapes
Here are common single letter escapes (short form) is used to report the most common attributes and properties of an image, such as: the image filename filename, type, width, height.</p>
<pre><code>        \n	newline
        \r	carriage return
        &lt;	less-than character.
        &gt;	greater-than character.
        &amp;	ampersand character.
        %%	a percent sign
        %b	file size of image read in (use -precision 16 to force results in B)
        %c	comment meta-data property
        %d	directory component of path
        %e	filename extension or suffix
        %f	filename (including suffix)
        %g	layer canvas page geometry (equivalent to &quot;%Wx%H%X%Y&quot;)
        %h	current image height in pixels
        %i	image filename (note: becomes output filename for &quot;info:&quot;)
        %k	CALCULATED: number of unique colors
        %l	label meta-data property
        %m	image file format (file magic)
        %n	number of images in current image sequence
        %o	output filename (used for delegates)
        %p	index of image in current image list
        %q	quantum depth (compile-time constant)
        %r	image class and colorspace
        %s	scene number (from input unless re-assigned)
        %t	filename without directory or extension (suffix)
        %u	unique temporary filename (used for delegates)
        %w	current width in pixels
        %x	x resolution (density)
        %y	y resolution (density)
        %z	image depth (as read in unless modified, image save depth)
        %A	image transparency channel enabled (true/false)
        %B	file size of image read in bytes
        %C	image compression type
        %D	image GIF dispose method
        %G	original image size (%wx%h; before any resizes)
        %H	page (canvas) height
        %M	Magick filename (original file exactly as given, including read mods)
        %O	page (canvas) offset ( = %X%Y )
        %P	page (canvas) size ( = %Wx%H )
        %Q	image compression quality ( 0 = default )
        %S	?? scenes ??
        %T	image time delay (in centi-seconds)
        %U	image resolution units
        %W	page (canvas) width
        %X	page (canvas) x offset (including sign)
        %Y	page (canvas) y offset (including sign)
        %Z	unique filename (used for delegates)
        %@	CALCULATED: trim bounding box (without actually trimming)
        %#	CALCULATED: 'signature' hash of image values
</code></pre>
<p>!!!code Convert an icon</p>
<pre><code>    convert *.png -define icon:auto-resize=256,128,64,48,32,16 %t.ico
    magick convert *.png -define icon:auto-resize=256,128,64,48,32,16 &quot;%t.ico&quot;
</code></pre>
<h3 id="pandoc">pandoc</h3>
<p>pandoc&quot; +RTS -K512m -RTS <a href="http://ECHOICU.utf8.md">ECHOICU.utf8.md</a> --to latex --from markdown+autolink_bare_uris+ascii_identifiers+tex_math_single_backslash --output ECHOICU.tex --template &quot;C:\Users\s163837\Documents\R\win-library\3.5\rmarkdown\rmd\latex\default-1.17.0.2.tex&quot; --highlight-style tango --pdf-engine pdflatex --variable graphics=yes --variable &quot;geometry:margin=1in&quot; --variable &quot;compact-title:yes&quot;
output file: <a href="http://ECHOICU.knit.md">ECHOICU.knit.md</a></p>
<h3 id="verifier">Verifier</h3>
<p><code>verifier</code> - Opens windows driver verifier.  Make sure to make a back up and be able to roll things back.</p>
<h3 id="set">Set</h3>
<p>to set variablsand have things expand.  Ess. like temp env vars.</p>
<p>Set /A VarName = Expression, where expression is a string, number or math
Set /P VarName = The Prompt to ask user.</p>
<h3 id="prompt">Prompt</h3>
<p>Changes the prompt.  Lots of fun</p>
<p>Default is <code>$P$G&gt;</code>.</p>
<p>Uses this table:</p>
<ul>
<li>$A  <code>&amp;</code>           (Ampersand)</li>
<li>$B  <code>|</code>           (pipe)</li>
<li>$C <code>(</code>           (Left parenthesis)</li>
<li>$D Current date</li>
<li>$E Escape code  (ASCII code 27)</li>
<li>$F  <code>)</code>           (Right parenthesis)</li>
<li>$G <code>&gt;</code>           (greater-than sign)</li>
<li>$H  Backspace   (erases previous character)</li>
<li>$L  <code>&lt;</code>           (less-than sign)</li>
<li>$M  Display the remote name for Network drives</li>
<li>$N  Current drive</li>
<li>$P  Current drive and path</li>
<li>$Q  <code>=</code>           (equal sign)</li>
<li>$S              (space)</li>
<li>$T  Current time</li>
<li>$V  Windows version number</li>
<li>$_  Carriage return and linefeed</li>
<li><code>$$ $</code>           (dollar sign)</li>
<li>$+  Will display plus signs (<code>+</code>) one for each level of the PUSHD directory stack</li>
<li></li>
</ul>
<h3 id="fix-dicom-errors">Fix DICOM Errors</h3>
<p>!!!Important
Need <a href="https://gallery.technet.microsoft.com/Grant-Revoke-Get-DCOM-22da5b96">Grant, Revoke, Get DCOM permissions using PowerShell</a>
It can be installed via ScriptBrowser</p>
<pre><code class="language-powershell"><div>cd <span class="hljs-string">"C:\Users\andyt\Documents\WindowsPowerShell\Scripts\Grant-Revoke-Get-DCOM-22da5b96\DCOMPermissions"</span>
<span class="hljs-built_in">Import-Module</span> .\DCOMPermissions.psm1
Grant-DComPermission -ApplicationID <span class="hljs-string">"{4839DDB7-58C2-48F5-8283-E1D1807D0D7D}"</span> -Account <span class="hljs-string">"SYSTEM"</span> -Type Launch -Permissions LocalLaunch,LocalActivation -OverrideConfigurationPermissions
</div></code></pre>
<h3 id="shimgen">Shimgen</h3>
<p>Using the .Net and Chocolatey Shimgen has been super useful.</p>
<p>First copy it from <code>%ChocolateyInstall%\tools</code> to <code>%ChocolateyInstall%\bin</code> so its on <strong>PATH</strong>.  (I cant remember if You need to add \bin to path or it comes that way?)  Anyway- Add <code>C:\ProgramData\Chocolatey\bin</code> to path.</p>
<p>Then run</p>
<pre><code class="language-batch"><div>cd /d %ChocolateyInstall%\tools
copy shimgen.exe ..\bin
shimgen -o=&quot;kdiff.exe&quot; -p=&quot;..\..\..\Program Files\Kdiff3\Kdiff3.exe&quot; -i=&quot;.\kdiff3.exe&quot; --gui
</div></code></pre>
<p>Somehow shimgen knows to put things in Chocolatey\bin, so paths are relative to that.  Even attempting to put it in another folder fails- by explicitly setting output.  Will work fine like this though  You hae to generate a a relative path from the <code>C:\ProgramData\Chocolatey\bin</code> back to the file.</p>
<p>!!!Note - The Easy Way- go to directory of SOURCE - in this case winrar
<code>c:\Program Files\WinRAR&gt;shimgen -o='WinRar.exe' -p=&quot;%cd%\WinRAR.exe&quot; -i=.\WinRAR.exe --gui</code></p>
<h2 id="other-notes">Other Notes</h2>
<h3 id="file-explorer">File Explorer</h3>
<p>Useful Categories to Add:
Type first
Name
Size
File Description
Product Name
Company</p>
<ul>
<li>Date Acceessed</li>
<li>Content created</li>
<li>Date Modified</li>
<li>Owner</li>
</ul>
<p>THen at the top- View -Options - Set to all Folders of that type'</p>
<p>In Windows</p>
<h3 id="correct-selection">Correct Selection</h3>
<ol>
<li>While on your desktop or in File Explorer, select one or more items you want to create shortcuts for.  Press and hold the Alt or Ctrl+Shift keys, drag and drop the selected item(s) to where you want to create the shortcut(s) at, and release the Alt or Ctrl+Shift keys.</li>
</ol>
<p>When you are moving things you should right click in the destination or right click driag.</p>
<h2 id="registry-changes">Registry Changes</h2>
<p>Syntax of .Reg Files
A .reg file has the following syntax:</p>
<pre><code class="language-txt"><div>RegistryEditorVersion
Blank line
[RegistryPath1]

&quot;DataItemName1&quot;=&quot;DataType1:DataValue1&quot;
DataItemName2&quot;=&quot;DataType2:DataValue2&quot;
Blank line
[RegistryPath2]

&quot;DataItemName3&quot;=&quot;DataType3:DataValue3&quot;
</div></code></pre>
<p>where:</p>
<p><code>RegistryEditorVersion</code> is either <code>&quot;Windows Registry Editor Version 5.00&quot;</code> for Windows 2000, Windows XP, and Windows Server 2003, or <code>&quot;REGEDIT4&quot;</code> for Windows 98 and Windows NT 4.0. The &quot;REGEDIT4&quot; header also works on Windows 2000-based, Windows XP-based, and Windows Server 2003-based computers.</p>
<p>Blank line is a blank line. This identifies the start of a new registry path. Each key or subkey is a new registry path. If you have several keys in your .reg file, blank lines can help you to examine and to troubleshoot the contents.
RegistryPathx is the path of the subkey that holds the first value you are importing. Enclose the path in square brackets, and separate each level of the hierarchy by a backslash. For example:
[HKEY_LOCAL_ MACHINE\SOFTWARE\Policies\Microsoft\Windows\System]
A .reg file can contain several registry paths. If the bottom of the hierarchy in the path statement does not exist in the registry, a new subkey is created. The contents of the registry files are sent to the registry in the order you enter them. Therefore, if you want to create a new subkey with another subkey below it, you must enter the lines in the correct order.</p>
<p>DataItemNamex is the name of the data item that you want to import. If a data item in your file does not exist in the registry, the .reg file adds it (with the value of the data item). If a data item does exist, the value in your .reg file overwrites the existing value. Quotation marks enclose the name of the data item. An equal sign (=) immediately follows the name of the data item.</p>
<p>DataTypex is the data type for the registry value and immediately follows the equal sign. For all the data types other than REG_SZ (a string value), a colon immediately follows the data type. If the data type is REG_SZ , do not include the data type value or colon. In this case, Regedit.exe assumes REG_SZ for the data type. The following table lists the typical registry data types:</p>
<ul>
<li>REG_BINARY - hexadecimal</li>
<li>REG_DWORD - dword</li>
<li>REG_EXPAND_SZ - hexadecimal(2)</li>
<li>REG_MULTI_SZ - hexadecimal(7)</li>
<li></li>
</ul>
<h3 id="adding-registry-subkeys-or-adding-and-changing-registry-values">Adding Registry Subkeys or Adding and Changing Registry Values</h3>
<p>To add a registry subkey or add or change a registry value, make the appropriate changes in the registry, and then export the appropriate subkey or subkeys. Exported registry subkeys are automatically saved as .reg files. To make changes to the registry and export your changes to a .reg file, follow these steps:</p>
<ol>
<li>Click Start, click Run, type regedit in the Open box, and then click OK.</li>
<li>Locate and then click the subkey that holds the registry item or items that you want to change.</li>
<li>Click File, and then click Export.</li>
</ol>
<p>This step backs up the subkey before you make any changes. You can import this file back into the registry later if your changes cause a problem. In the File name box, type a file name to use to save the .reg file with the original registry items, and then click Save.</p>
<p>!!!Note Use a file name that reminds you of the contents, such as a reference to the name of the subkey.
In the right pane, add or modify the registry items you want.
Repeat steps 3 and 4 to export the subkey again, but use a different file name for the .reg file. You can use this .reg file to make your registry changes on another computer.
Test your changes on the local computer. If they cause a problem, double-click the file that holds the backup of the original registry data to return the registry to its original state. If the changes work as expected, you can distribute the .reg you created in step 6 to other computers by using the methods in the &quot;Distributing Registry Changes&quot; section of this article.</p>
<h3 id="deleting-registry-keys-and-values">Deleting Registry Keys and Values</h3>
<p>To delete a registry key with a .reg file, put a hyphen (-) in front of the RegistryPath in the .reg file. For example, to delete the Test subkey from the following registry key:
<code>HKEY_LOCAL_MACHINE\Software</code>
put a hyphen in front of the following registry key in the .reg file:
<code>HKEY_LOCAL_MACHINE\Software\Test</code>
The following example has a .reg file that can perform this task.
<code>[-HKEY_LOCAL_MACHINE\Software\Test]</code>
To delete a registry value with a .reg file, put a hyphen (-) after the equals sign following the DataItemName in the .reg file. For example, to delete the TestValue registry value from the following registry key:
<code>HKEY_LOCAL_MACHINE\Software\Test</code>
put a hyphen after the &quot;TestValue&quot;= in the .reg file. The following example has a .reg file that can perform this task.
<code>HKEY_LOCAL_MACHINE\Software\Test</code></p>
<p><code>&quot;TestValue&quot;=-</code>
To create the .reg file, use Regedit.exe to export the registry key that you want to delete, and then use Notepad to edit the .reg file and insert the hyphen.</p>
<p>Renaming Registry Keys and Values
To rename a key or value, delete the key or value, and then create a new key or value with the new name.</p>
<h3 id="setting-explorer-to-my-pc-not-quick-access">Setting Explorer to My PC not Quick Access</h3>
<pre><code class="language-batch"><div>reg add &quot;HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot; /v &quot;LaunchTo&quot; /t REG_DWORD /d 1 /f
</div></code></pre>
<h3 id="batch-examples">Batch Examples</h3>
<pre><code class="language-batch"><div>@echo off
Setlocal EnableDelayedExpansion
:: strLen String [RtnVar]
::             -- String  The string to be measured, surround in quotes if it contains spaces.
::             -- RtnVar  An optional variable to be used to return the string length.
Set &quot;s=#%~1&quot;
Set &quot;len=0&quot;
For %%N in (4096 2048 1024 512 256 128 64 32 16 8 4 2 1) do (
  if &quot;!s:~%%N,1!&quot; neq &quot;&quot; (
    set /a &quot;len+=%%N&quot;
    set &quot;s=!s:~%%N!&quot;
  )
)
Endlocal&amp;if &quot;%~2&quot; neq &quot;&quot; (set %~2=%len%) else echo %len%
Exit /b

::Exaple Calling
@Echo off
Setlocal
Set _demo=&quot;hello world&quot;
Call strLen.cmd %_demo%
</div></code></pre>
<h2 id="useful-microsoft-addons">Useful Microsoft Addons</h2>
<p><a href="https://docs.microsoft.com/en-us/windows-hardware/get-started/adk-install">Microsoft Assessment and Deployment Toolkit</a></p>
<p><a href="">Microsoft Software Development Kit</a></p>
<p><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugger-download-tools">Microsoft Debugging Tools</a></p>
<p><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk">Windows Driver Kit (WDK)</a></p>
<p><a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk">Windows Hardware Kit WHK</a></p>
<p>Microsoft Messaging</p>
<p>Microsoft Network TMonitor</p>
<p>Microsoft Message Analyzer</p>
<h2 id="msi-executables">MSI Executables</h2>
<p>For example: <code>msiexec /a &quot;C:\users\altimmons\downloads\python-2.7.15.amd64.msi&quot; /lemox &quot;./temp.txt&quot;</code></p>
<p>The above command says using msiexec (windows installer), run as an admin <code>/a</code> this file, <code>/l</code> log it, and in the log put- I dont remember all the other letters e is errors. x is more info I think. Save it in the local directory <code>./temp.txt</code>.</p>
<p>you can say program /? for more info</p>
<h2 id="network">Network</h2>
<h3 id="proxy-management">Proxy Management</h3>
<p>? Cntlm: Fast NTLM Authentication Proxy in C - not sure if this is part of the work computer or if I installed this...</p>
<h3 id="firewall">FireWall</h3>
<p>Enable Remote desktop related rules.  Unclear which these are.</p>
<h3 id="reserved-ips">Reserved IPs</h3>
<h4 id="ipv4">IPv4</h4>
<p><a href="https://en.wikipedia.org/wiki/Reserved_IP_addresses">Source</a></p>
<ul>
<li><code>Address block</code>- Address range</li>
<li><code>------------------</code>- ---------------------------</li>
<li><code>0.0.0.0/8</code>- 0.0.0.0–0.255.255.255</li>
<li><code>10.0.0.0/8</code>- 10.0.0.0–10.255.255.255</li>
<li><code>100.64.0.0/10</code>- 100.64.0.0–100.127.255.255</li>
<li><code>127.0.0.0/8</code>- 127.0.0.0–127.255.255.255</li>
<li><code>169.254.0.0/16</code>- 169.254.0.0–169.254.255.255</li>
<li><code>172.16.0.0/12</code>- 172.16.0.0–172.31.255.255</li>
<li><code>192.0.0.0/24</code>- 192.0.0.0–192.0.0.255</li>
<li><code>192.0.2.0/24</code>- 192.0.2.0–192.0.2.255</li>
<li><code>192.88.99.0/24</code>- 192.88.99.0–192.88.99.255
| 192.168.0.0/16     | 192.168.0.0–192.168.255.255 | 65536               | Private network | Used for local communications within a private network.                                                                |
| 198.18.0.0/15      | 198.18.0.0–198.19.255.255   | 131072              | Private network | Used for benchmark testing of inter-network communications between two separate subnets.                               |
| 198.51.100.0/24    | 198.51.100.0–198.51.100.255 | 256                 | Documentation   | Assigned as TEST-NET-2, documentation and examples.                                                                    |
| 203.0.113.0/24     | 203.0.113.0–203.0.113.255   | 256                 | Documentation   | Assigned as TEST-NET-3, documentation and examples.                                                                    |
| 224.0.0.0/4        | 224.0.0.0–239.255.255.255   | 268435456           | Internet        | In use for IP multicast. (Former Class D network).                                                                     |
| 240.0.0.0/4        | 240.0.0.0–255.255.255.254   | 268435456           | Internet        | Reserved for future use. (Former Class E network).                                                                     |
| 255.255.255.255/32 | 255.255.255.255             | 1                   | Subnet          | Reserved for the &quot;limited broadcast&quot; destination address.                                                              |</li>
</ul>
<p>such as would have normally been retrieved from a DHCP server.</p>
<h4 id="ipv6">IPV6</h4>
<table>
<thead>
<tr>
<th>Address block (CIDR)</th>
<th>First address</th>
<th>Last address</th>
<th>Number of addresses</th>
<th>Usage</th>
<th>Purpose</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>::/0</td>
<td>::</td>
<td>ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff</td>
<td>2128</td>
<td>Routing</td>
<td>Default route.</td>
</tr>
<tr>
<td></td>
<td>::/128</td>
<td>::</td>
<td></td>
<td>1</td>
<td>Software</td>
<td>Unspecified address.</td>
</tr>
<tr>
<td></td>
<td>::1/128</td>
<td>::1</td>
<td></td>
<td>1</td>
<td>Host</td>
<td>Loopback address to the local host.</td>
</tr>
<tr>
<td></td>
<td>::ffff:0:0/96</td>
<td>::ffff:0.0.0.0</td>
<td>::ffff:255.255.255.255</td>
<td>2128−96 = 232</td>
<td>Software</td>
<td>IPv4 mapped addresses.</td>
</tr>
<tr>
<td></td>
<td>::ffff:0:0:0/96</td>
<td>::ffff:0:0.0.0.0</td>
<td>::ffff:0:255.255.255.255</td>
<td>232</td>
<td>Software</td>
<td>IPv4 translated addresses.</td>
</tr>
<tr>
<td></td>
<td>64:ff9b::/96</td>
<td>64:ff9b::0.0.0.0</td>
<td>64:ff9b::255.255.255.255</td>
<td>232</td>
<td>Global Internet</td>
<td>IPv4/IPv6 translation.</td>
</tr>
<tr>
<td></td>
<td>100::/64</td>
<td>100::</td>
<td>100::ffff:ffff:ffff:ffff</td>
<td>264</td>
<td>Routing</td>
<td>Discard prefix.</td>
</tr>
<tr>
<td></td>
<td>2001::/32</td>
<td>2001::</td>
<td>2001::ffff:ffff:ffff:ffff:ffff:ffff</td>
<td>296</td>
<td>Global Internet</td>
<td>Teredo tunneling.</td>
</tr>
<tr>
<td></td>
<td>2001:20::/28</td>
<td>2001:20::</td>
<td>2001:2f:ffff:ffff:ffff:ffff:ffff:ffff</td>
<td>2100</td>
<td>Software</td>
<td>ORCHIDv2.</td>
</tr>
<tr>
<td></td>
<td>2001:db8::/32</td>
<td>2001:db8::</td>
<td>2001:db8:ffff:ffff:ffff:ffff:ffff:ffff</td>
<td>296</td>
<td>Documentation</td>
<td>Addresses used in documentation and example source code.</td>
</tr>
<tr>
<td></td>
<td>2002::/16</td>
<td>2002::</td>
<td>2002:ffff:ffff:ffff:ffff:ffff:ffff:ffff</td>
<td>2112</td>
<td>Global Internet</td>
<td>The 6to4 addressing scheme (now deprecated).</td>
</tr>
<tr>
<td></td>
<td>fc00::/7</td>
<td>fc00::</td>
<td>fdff:ffff:ffff:ffff:ffff:ffff:ffff:ffff</td>
<td>2121</td>
<td>Private network</td>
<td>Unique local address.</td>
</tr>
<tr>
<td></td>
<td>fe80::/10</td>
<td>fe80::</td>
<td>febf:ffff:ffff:ffff:ffff:ffff:ffff:ffff</td>
<td>2118</td>
<td>Link</td>
<td>Link-local address.</td>
</tr>
<tr>
<td></td>
<td>ff00::/8</td>
<td>ff00::</td>
<td>ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff</td>
<td>2120</td>
<td>Global Internet</td>
<td>Multicast address.</td>
</tr>
</tbody>
</table>
<h2 id="setup-git">Setup Git</h2>
<p>First setup basics</p>
<pre><code class="language-bash"><div>git config --global user.name <span class="hljs-string">"altimmons"</span>
git config --global user.email <span class="hljs-string">"A.L.Timmons@gmail.com"</span>
</div></code></pre>
<p>Then generate an SSH key to upload to github</p>
<pre><code><div>ssh-keygen -t rsa -C &quot;A.L.Timmons@gmail.com&quot;
</div></code></pre>
<p>This is best done with wsl</p>
<p>7dfc369ea46474e9a0d8131d6c247c3229cfe58f</p>
<p><code>git show :.gitignore</code></p>
<p>git checkout master</p>
<p>git commit</p>
<h2 id="streamline-windows">Streamline Windows</h2>
<p>This is the source of two separate packages:</p>
<ul>
<li><a href="https://github.com/W4RH4WK/Debloat-Windows-10">Debloat Windows 10</a></li>
<li><a href="https://gist.githubusercontent.com/matthewjberger/2f4295887d6cb5738fa34e597f457b7f/raw/b23fa065febed8a2d7c2f030fba6da381f640997/Remove-Windows10-Bloat.bat">Remove-Windows10-Bloat.bat</a></li>
</ul>
<h2 id="vs-code-regexp">VS Code RegExp</h2>
<p><a href="https://stackoverflow.com/questions/42179046/what-flavor-of-regex-does-visual-studio-code-use/42184299#42184299">Reference 1</a></p>
<p>There are many flavors of RegExp- VS Code uses Rust <a href="https://docs.rs/regex/0.2.10/regex/">Rust RegExp</a> specifically <a href="https://docs.rs/regex/0.2.10/regex/#syntax">Here</a></p>
<p><a href="https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2012/2k3te2cs(v=vs.110)">Microsoft VS RegExp</a>
exe64=x64\(.*?)(</p>
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/base-types/substitutions-in-regular-expressions">Substitutions in Reg Exp</a></p>
<p><a href="..">File</a></p>
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference">GOOD- Quick Reference</a>
<a href="https://download.microsoft.com/download/D/2/4/D240EBF6-A9BA-4E4F-A63F-AEB6DA0B921C/Regular%20expressions%20quick%20reference.pdf">PDF Version</a></p>
<p>!!!Note Note- The link- <code>Microsoft VS RegExp</code> suggests an older easier form of RegExp thats worth checking out if this isnt working</p>
<ul>
<li>Wildcards
<ul>
<li><code>.</code> - 1   match a single char (any, except new line <code>\n</code>)</li>
<li><code>*</code> - 0+  - zero or more occurances.</li>
<li><code>+</code> - 1+  -one or more occurances.  Requires its occurance.</li>
<li><code>?</code> - match 0 or more, but as few characters as possible (?).
<ul>
<li><code>.+</code>  = one or more of any char <strong>As above- this is a (non-null) Wildcard</strong></li>
<li><code>.*</code> = zero or more of any char.  <strong>This is a wildcard functionally</strong></li>
<li><code>*?</code>,<code>+?</code>, <code>??</code>, <code>{#...}?</code> Lazy modifiers of the above.</li>
</ul>
</li>
<li>{#} - specify the number of times something <em>preceeding</em> should occur.  Goes after. <code>[0-9]{3} = 142 or 999</code>
<ul>
<li>{#,#} - specify a range of occurances.  e.g. [0-9]{2,4}  match 10 - 9999</li>
<li>{#,} - match at least # times</li>
</ul>
</li>
</ul>
</li>
<li>Anchors
<ul>
<li><code>^</code> - anchor to front</li>
<li><code>\r?$</code> -anchor to rear.  Old character was just <code>$</code></li>
</ul>
</li>
<li>Parens and brackets
<ul>
<li>[...] - give characters to match.
<ul>
<li>[], [c] - match a single char</li>
<li>[a-f], [0-9] - match a range</li>
<li>[pre], [.)-] - match a single character in a set. [abc] = a, b, c not d, matches a in aa.</li>
</ul>
</li>
<li>(...) - specify a string to search for
<ul>
<li>(...) -&gt; <code>\1</code> define a pattern then Reference it later (in the same pattern) with \1 (\2, \3) etc.  <code>({3}[x])z\1 = xxxzxxx</code></li>
<li>(...) -&gt; <code>$1</code> - in replacements, VS 2011+ replaced \1 with $1.</li>
</ul>
</li>
</ul>
</li>
<li>Logic
<ul>
<li><code>?!</code> = NOT , <code>real(?!ity)</code> matched real and really but not reality.</li>
<li>[^...] - NOT in set - as above for brackets, but invalidates <code>be[^abc]</code> does not match bear but would match bee.</li>
<li><code>|</code> = OR - Match either the sequence before or after. <code>([0-9]|[a-f]|[^g-z])</code> - to find hex <code>#([0-9]|[a-f]){6}</code> find hex colors</li>
</ul>
</li>
<li>Types
<ul>
<li><code>(\b\S+\s?){1,}</code>  USEFUL- find words - start at word boundary -repeat to go to non-space- find 0 or 1 space- then all of it {1,}- one or more words.</li>
<li><code>\p{...}</code> match a type</li>
<li><code>\b</code> -specifies a word boundary- usually a space <code>\bin</code> matches inside but not bin.</li>
<li><code>\r?\n</code> - line break carriage return.   This is system independent - 0 or more \r (returns), then \n.  Or at least Unix/Win</li>
<li><code>(?([^\r\n])\s)</code> Whitespace</li>
<li><code>\d</code> digit</li>
<li>\u#### -unicode (specific char)</li>
<li><code>((\&quot;.+?\&quot;)|('.+?'))</code> = quoted string</li>
<li><code>\b0[xX]([0-9a-fA-F])\b</code> matches hex- Matches &quot;0xc67f&quot; but not &quot;0xc67fc67f&quot;.</li>
<li><code>\b[0-9]*\.*[0-9]+\b</code> int and floats.</li>
</ul>
</li>
<li>Characters
<ul>
<li><code>\</code> -escape character - e.g. <code>\.</code> is a literal <code>.</code> not anychar.</li>
<li>\b - word boundary</li>
<li>\t tab character (\u0009)</li>
<li>\r carriage return \u000D</li>
<li>\v vert tab</li>
<li>\f form feed</li>
<li><code>\n</code> new line (\u000A)</li>
<li><code>\e</code> escape \u001b</li>
<li><code>\###</code> | <code>\##</code> matches an <strong>ASCII Character</strong> in Octal | Hex</li>
<li><code>\cC</code> matches CtrlC</li>
<li><code>\octal</code> 2-3 digit octal character code</li>
<li><code>\x</code> hex 2-digit hex character code</li>
<li><code>\u</code> hex 4-digit hex character code</li>
<li><code>\b</code> Backspace \u0008 NOTE-This is redundant with word boundry, not sure how it'd work.</li>
<li><code>\e</code> Escape \u001B</li>
</ul>
</li>
<li>Classes- generally UPPER CASE is NOT a category.
<ul>
<li>\S -any non-White-Space</li>
<li>\s - any whitespace character</li>
<li>\D - Matches a nondigit char - equiv to <code>\P{Nd}</code></li>
<li>\d - a decimal digit (e.g number 0-9)
<ul>
<li>\d{1,5}- Match from one to five decimal digits.</li>
</ul>
</li>
<li><code>\w</code> Alphanumeric ('Word character')</li>
<li>\W non wod character</li>
<li>\p{**} - is in a category</li>
<li>\P{**} is NOT in a category</li>
<li>Categories (more specific classes) (<code>\p{...}</code>)
<ul>
<li>Ll  -Letter, Lowercase</li>
<li>Lu  -Letter, Uppercase</li>
<li>Lt  -Letter, Titlecase</li>
<li>Lo  -Letter, Other</li>
<li>Lm  -Letter, Modifier</li>
<li>Mn  -Mark, Nonspacing</li>
<li>Nd  -Number, Decimal Digit</li>
<li>Pc  -Punctuation, Connector. This category includes ten characters, the most commonly used of which is the LOWLINE character (_), u+005F.</li>
<li>L -Any letter</li>
<li>Mn - Mark, Nonspacing</li>
<li>Mc - Mark, Spacing Combining</li>
<li>Me - Mark, Enclosing</li>
<li>M - All diacritic marks. This includes the Mn, Mc, and Me categories.</li>
<li>Nd - Number, Decimal Digit</li>
<li>Nl - Number, Letter</li>
<li>No - Number, Other</li>
<li>N - All numbers. This includes the Nd, Nl, and No categories.</li>
<li>Pc - Punctuation, Connector</li>
<li>Pd - Punctuation, Dash</li>
<li>Ps - Punctuation, Open</li>
<li>Pe - Punctuation, Close</li>
<li>Pi - Punctuation, Initial quote (may behave like Ps or Pe depending on usage)</li>
<li>Pf - Punctuation, Final quote (may behave like Ps or Pe depending on usage)</li>
<li>Po - Punctuation, Other</li>
<li>P - All punctuation characters. This includes the Pc, Pd, Ps, Pe, Pi, Pf, and Po categories.</li>
<li>Sm - Symbol, Math</li>
<li>Sc - Symbol, Currency</li>
<li>Sk - Symbol, Modifier</li>
<li>So - Symbol, Other</li>
<li>S - All symbols. This includes the Sm, Sc, Sk, and So categories.</li>
<li>Zs - Separator, Space</li>
<li>Zl - Separator, Line</li>
<li>Zp - Separator, Paragraph</li>
<li>Z - All separator characters. This includes the Zs, Zl, and Zp categories.</li>
<li>Cc - Other, Control</li>
<li>Cf - Other, Format</li>
<li>Cs - Other, Surrogate</li>
<li>Co - Other, Private Use</li>
<li>Cn - Other, Not Assigned (no characters have this property)</li>
<li>C - All control characters. This includes the Cc, Cf, Cs, Co, and Cn categories.</li>
</ul>
</li>
</ul>
</li>
<li>Anchors
<ul>
<li><code>^</code>  match must occur at the <em>beginning</em> of the string;
<ul>
<li>multiline mode, it must occur at the beginning of the line.</li>
</ul>
</li>
<li><code>$</code>  the match must occur at <em>the end of the string or before \n</em> at the end of the string;
<ul>
<li>in multiline mode, it must occur at the end of the line or before \n at the end of the line.</li>
</ul>
</li>
<li><code>\A</code>  The match must occur at the beginning of the string only (no multiline support).</li>
<li><code>\Z</code>  The match must occur at the end of the string, or before \n at the end of the string.</li>
<li><code>\z</code>  The match must occur at the end of the string only.</li>
<li><code>\G</code>  The match must start at the position where the previous match ended.</li>
<li><code>\b</code>  The match must occur on a <strong>word boundary.</strong></li>
<li><code>\B</code>  The match must not occur on a word boundary.
^()(\S+?)([ ]{2,}\t*[ ]{2,})(\b.*)
^()(\S+?)(([ ]{3,}|)\t*([ ]{3,}|))(\b.*)</li>
</ul>
</li>
</ul>
<p>Group Referencing (Reusing a previously used group)</p>
<ul>
<li><code>(exp)</code> Indexed group</li>
<li><code>(?&lt;name&gt;exp)</code> -  Named group</li>
<li><code>(?&lt;name1-name2&gt;exp)</code> - Balancing group</li>
<li><code>(?:exp)</code> - Noncapturing group</li>
<li><code>(?=exp)</code> - Zero-width positive lookahead</li>
<li><code>(?!exp)</code> - Zero-width negative lookahead</li>
<li><code>(?&lt;=exp)</code> - Zero-width positive lookbehind</li>
<li><code>(?&lt;!exp)</code> - Zero-width negative lookbehind</li>
<li><code>(?&gt;exp)</code> - Non-backtracking (greedy)</li>
</ul>
<p>Use To substitute</p>
<ul>
<li><code>$n</code> - Substring matched by group number n</li>
<li><code>${</code> - name}     Substring matched by group</li>
<li><code>$$</code> - Literal $ character</li>
<li><code>$&amp;</code> - Copy of whole match</li>
<li><code>$`</code> ([[DollarSign + Backtick]]- Text before the match</li>
<li><code>$'</code> - Text after the match</li>
<li><code>$+</code> - Last captured group</li>
<li><code>$</code> - _   Entire input string</li>
</ul>
<p>Conditionals</p>
<ul>
<li><code>a |b</code> - Either a or b</li>
<li><code>(?(exp) yes | no)</code> -&gt; <code>yes</code> if exp is matched and  =<code>no</code> if exp isn't matched</li>
<li><code>(?(name) yes | no)</code> -&gt; <code>yes</code> if name is matched  and  = <code>no</code> if name isn't matched</li>
</ul>
<p>Comments</p>
<ul>
<li><code>(?# comment)</code> Add inline comment</li>
<li><code>#</code> Add x-mode comment</li>
<li></li>
</ul>
<p>backreferencing</p>
<ul>
<li><code>\n</code> - Indexed group</li>
<li><code>\k&lt;name&gt;</code> - Named group</li>
<li>Options</li>
<li><code>(?imnsximnsx)</code> Set or disable the specified options</li>
<li><code>(?imnsximnsx:exp)</code> Set or disable the specified options within the expression
<ul>
<li><code>i</code> - Case-insensitive</li>
<li><code>m</code> - Multiline mode</li>
<li><code>n</code> - Explicit (named)</li>
<li><code>s</code> - Single-line mode</li>
<li><code>x</code> - Ignore white space</li>
</ul>
</li>
</ul>
<p>Greedy Lazy Matches
0 or more times | <code>*</code> Greedy <code>*?</code>  Lazy
1 or more times | <code>+</code> Greedy  <code>+?</code>  Lacy
<code>?</code> |  <code>??</code> Lazy 0 or 1 time |
<code>{n}</code> <code>{n}?</code> Exactly n times
<code>{n,}</code> <code>{n,}?</code> At least n times
<code>{n,m}</code> <code>{n,m}?</code> From n to m times</p>
<table>
<thead>
<tr>
<th>Greedy</th>
<th>Lazy</th>
<th>Matches</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td><code>*?</code></td>
<td>0 or more times</td>
</tr>
<tr>
<td><code>+</code></td>
<td><code>+?</code></td>
<td>1 or more times</td>
</tr>
<tr>
<td><code>?</code></td>
<td><code>??</code></td>
<td>0 or 1 time</td>
</tr>
<tr>
<td><code>{</code>n<code>}</code></td>
<td><code>{</code>n<code>}?</code></td>
<td>Exactly n times</td>
</tr>
<tr>
<td><code>{</code>n,<code>}</code></td>
<td><code>{</code>n,<code>}?</code></td>
<td>At least n times</td>
</tr>
<tr>
<td><code>{</code>n,m<code>}</code></td>
<td><code>{</code>n,m<code>}?</code></td>
<td>From n to m times</td>
</tr>
</tbody>
</table>
<p>Note- <code>{n,m}</code> and similar are recorded weird because they disappear from table when entered verbatim, it must be the format of the table code.</p>
<p>The regular expression pattern \b<code>(?&lt;n2&gt;\d{2}-)?``(?(n2)``\d{7}</code>|<code>\d{3}-\d{2}-\d{4}</code>)\b is interpreted as shown in the following table.</p>
<p>Pattern  Description</p>
<ul>
<li><code>\b</code>  Start at a word boundary.</li>
<li><code>(?&lt;n2&gt;\d{2}-)?</code> Match zero or one occurrence of two digits followed by a hyphen. Name this capturing group n2.</li>
<li><code>(?(n2)</code>  Test whether n2 was matched in the input string.</li>
<li><code>)\d{7}</code>   If n2 was matched, match seven decimal digits.</li>
<li><code>|\d{3}-\d{2}-\d{4}</code> If n2 was not matched, match three decimal digits, a hyphen, two decimal digits, another hyphen, and four decimal digits.</li>
<li><code>\b</code>  Match a word boundary.</li>
</ul>
<h3 id="examples">Examples</h3>
<p>Verifying Email:</p>
<pre><code class="language-c#"><div> <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Main</span>(<span class="hljs-params"></span>)</span>
   {
      Stopwatch sw;
      <span class="hljs-keyword">string</span>[] addresses = { <span class="hljs-string">"AAAAAAAAAAA@contoso.com"</span>,
                             <span class="hljs-string">"AAAAAAAAAAaaaaaaaaaa!@contoso.com"</span> };
      <span class="hljs-comment">// The following regular expression should not actually be used to</span>
      <span class="hljs-comment">// validate an email address.</span>
      <span class="hljs-keyword">string</span> pattern = <span class="hljs-string">@"^[0-9A-Z]([-.\w]*[0-9A-Z])*$"</span>;
      <span class="hljs-keyword">string</span> input;

      <span class="hljs-keyword">foreach</span> (<span class="hljs-keyword">var</span> address <span class="hljs-keyword">in</span> addresses) {
         <span class="hljs-keyword">string</span> mailBox = address.Substring(<span class="hljs-number">0</span>, address.IndexOf(<span class="hljs-string">"@"</span>));
         <span class="hljs-keyword">int</span> index = <span class="hljs-number">0</span>;
         <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> ctr = mailBox.Length - <span class="hljs-number">1</span>; ctr &gt;= <span class="hljs-number">0</span>; ctr--) {
            index++;

            input = mailBox.Substring(ctr, index);
            sw = Stopwatch.StartNew();
            Match m = Regex.Match(input, pattern, RegexOptions.IgnoreCase);
            sw.Stop();
            <span class="hljs-keyword">if</span> (m.Success)
               Console.WriteLine(<span class="hljs-string">"{0,2}. Matched '{1,25}' in {2}"</span>,
                                 index, m.Value, sw.Elapsed);
            <span class="hljs-keyword">else</span>
               Console.WriteLine(<span class="hljs-string">"{0,2}. Failed  '{1,25}' in {2}"</span>,
                                 index, input, sw.Elapsed);
         }
         Console.WriteLine();
      }
   }
</div></code></pre>
<p>Example with open and close paren- might need this someday.</p>
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference">https://docs.microsoft.com/en-us/dotnet/standard/base-types/regular-expression-language-quick-reference</a></p>
<p><a href="https://docs.microsoft.com/en-us/dotnet/standard/base-types/grouping-constructs-in-regular-expressions#balancing_group_definition">Better Source</a></p>
<p>(?&lt; name1 - name2 &gt; subexpression )</p>
<p>Defines a balancing group definition. For more information, see the &quot;Balancing Group Definition&quot; section in Grouping Constructs.</p>
<p><code>(((?'Open'\()[^\(\)]*)+((?'Close-Open'\))[^\(\)]*)+)*(?(Open)(?!))$</code></p>
<p>&quot;((1-3)<em>(3-1))&quot; in &quot;3+2^((1-3)</em>(3-1))&quot;</p>
<p><a href="https://stackoverflow.com/questions/18229939/regex-check-and-pad-string-to-ensure-certain-string-format-is-use">Parsing a string - Serial No Example in C#</a></p>
<h4 id="my-examples">My Examples</h4>
<p>(^[a-zA-Z]*?) Standard</p>
<p>Finding a table</p>
<p><code>(^\|)(.*?)(\|)(.*?)(\|$)</code></p>
<p>!!!example For parsing tables:
Intention is to find <code>^| ... | ... |$</code></p>
<pre><code>    `(^[\[\_.\:\+\*-\w]*)([\t]{2})(.*?$)` -
convert input from R into (- `xxxx` - xxxx)
</code></pre>
<p>!!!code Convert var: text -
(^[.$\w\s(;)]*)([:])</p>
<p>!!!note Bold betweem the parentheses (xxx) -&gt; <strong>(xxx)</strong>
([(])(.*?)([)])
<strong>$1$2$3</strong></p>
<p>!!!note   A series of entries like this:
It would not continue the match onto the following line for some reason.
encoding:
The name of an encoding, default &quot;native.enc&quot;. See connections.
encoding:
The name of an encoding, default &quot;native.enc&quot;. See connections.</p>
<pre><code>    (^[a-z.]+?)(:)([\n^.*])
and replace with    -

        `$1`

Or also, though I am not sure this wasnt something else:

      (^[\w]*?)([\n])(^.*?$)
replace with

        $1 $3
</code></pre>
<p>!!!attention Matches patterns with a single word, and then the next     line- like this
!!!quote
<strong>timeout</strong><br>
timeout in seconds, ignored if 0. This is a limit for the elapsed time running command in a separate process. Fractions of seconds are ignored.</p>
<pre><code>    **show.output.on.console**\
    logical (not NA), indicates whether to capture the output of the command and show it on the R console (not used by Rterm, which shows the output in the terminal unless wait is false).

    **invisible**\
    logical (not NA), indicates whether a command window should be visible on the screen.**

!!!done    Which returns text like this:
    - _timeout_ - timeout in seconds, ignored if 0. This is a limit for the elapsed time running command in a separate process. Fractions of seconds are ignored.
    - _show.output.on.console_ - logical (not NA), indicates whether to capture the output of the command and show it on the R console (not used by Rterm, which shows the output in the terminal unless wait is false).
    - _minimized_ - logical (not NA), indicates whether a command window should be displayed initially as a minimized window.

    !!!tip Use:

            (^[\b\w., ]+?)([\n]|[\t\n])(^.+?$)
            (^[\b\w., ]+?)([\n])(^.+?$)

        and replace with

                    - _$1_ - $3
                    - `$1` - $3
                    - **$1** - $3
</code></pre>
<p>!!!attention To match... TEMPLATE
!!!quote Input from
example</p>
<pre><code>!!!done    Which returns text like this:
    result

    !!!tip Use:
            &lt;code&gt;

        replace with

            &lt;code&gt;
</code></pre>
<p>!!!example  [[Replace]]
!!!quote [[Source]]
example<br>
example<br>
example<br>
example</p>
<pre><code>    !!!tip Use:
            &lt;code&gt;
            &lt;code&gt;
            &lt;code&gt;

        replace with

            &lt;code&gt;

        !!!done    Which returns text like this:
            - example
            - example
            - example
            - example
</code></pre>
<p>!!!example  [[Replace]]
!!!quote [[Source]]
example<br>
example<br>
example<br>
example</p>
<pre><code>!!!tip Use:
        &lt;code&gt;
        &lt;code&gt;
        &lt;code&gt;

    replace with

        &lt;code&gt;

    !!!done    Which returns text like this:
        - example
        - example
        - example
        - example
</code></pre>
<p>!!!example  [[Replace]]
!!!quote [[Source]]
example<br>
example<br>
example<br>
example</p>
<pre><code>    !!!tip Use:
            &lt;code&gt;
            &lt;code&gt;
            &lt;code&gt;

        replace with

            &lt;code&gt;

!!!done    Which returns text like this:
    - example
    - example
    - example
    - example
</code></pre>
<p>!!!example  [[Replace]]
!!!quote [[Source]]
example<br>
example<br>
example<br>
example</p>
<pre><code>!!!tip Use:
        &lt;code&gt;
        &lt;code&gt;
        &lt;code&gt;

    replace with

        &lt;code&gt;

!!!done    Which returns text like this:
    - example
    - example
    - example
    - example
</code></pre>
<p>!!!note   Replace 1 or two # with &gt;# (##, &gt;##) to remove comments in code blocks
(#)(#|)
(#)(#)([]|[ ])
replace with : version 2 removes the space after.</p>
<p>!!!note Replace literal <em>'tabular'</em> data into an unordered list with code indicators around the first col.  This is for items that are generally:
item    definition
item2   definition2
item3   definition3</p>
<pre><code>yields:

    - `item` - definition
    - `item2` - definition2
    - `item3` - definition3

Rex Exp - more general and dynamic moving down this list.  Right now the last one performs the best.

    1. (\S*?)(\t)(.*) -most specific
    2. ^()(\S*?)(\t)(.*)$ -add empty group to make replacements match.
    3. ^([\s]*?)([\S]*?)(\t| )(.*)$
    4. ^([\s\t ]*?)(\b[\S]+?)(\t|[ ]*)(\b.*)$
    5. (\S*?)(\t|[ ]*)(\b\S.*)$
    6. ^()(\S+?)([ ]*\t+[ ]*)(\b.*)$
    7. ^()(\S+?)(([ ]{3,}|)\t*([ ]{3,}|))(\b.*)$
</code></pre>
<p>!!!note   Replace 1 or two # with &gt;# (##, &gt;##) to remove comments in code blocks
(#)(#|)
(#)(#)([]|[ ])
replace with : version 2 removes the space after.</p>
<pre><code>        &gt;$1$2
</code></pre>
<h2 id="other-tips-tricks-and-hacks">Other Tips, Tricks and Hacks</h2>
<h3 id="get-any-programs-location-using-the-registry">Get any programs location using the registry.</h3>
<p>This is in powershell</p>
<pre><code class="language-ps1"><div>&gt;#get the path to 7-zip from the registry
$7zip = Join-Path (get-item HKLM:\SOFTWARE\7-Zip).GetValue('Path') '7z.exe'
</div></code></pre>
<p>The commandline has an equivalent (Reg)</p>
<pre><code class="language-batch"><div>&gt;reg Query HKLM\Software\7-Zip

HKEY_LOCAL_MACHINE\Software\7-Zip
    Path64    REG_SZ    C:\Program Files\7-Zip\
    Path    REG_SZ    C:\Program Files\7-Zip\
</div></code></pre>
<p>Not sure how youd parse the output</p>
<h3 id="norives">Norives</h3>
<p>Hide drive mappings in 'My Computer', Windows Explorer and the standard Open dialog box.</p>
<p>Each letter is one bit more in binary.</p>
<p>So drive A(1) = 1, drive B(2)=2, driveC(3)=4, D=8, E=16 and so on.</p>
<p>Copy the result into the registry to hide the drive letter(s)</p>
<p>User Key:
[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer]</p>
<p>System Key:
[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer]</p>
<p>Value Name: NoDrives
Data Type: DWORD</p>
<p>After changing the registry, logoff or reboot so that it takes effect.</p>
<p>Drive mappings hidden with a nodrives registry setting are still available, just type the drive letter into the explorer address bar.</p>
<h3 id="batch-file">Batch File</h3>
<pre><code class="language-batch"><div>@rem *** Disable Some Service ***
sc stop DiagTrack
sc stop diagnosticshub.standardcollector.service
sc stop dmwappushservice
sc stop WMPNetworkSvc
sc stop WSearch

sc config DiagTrack start= disabled
sc config diagnosticshub.standardcollector.service start= disabled
sc config dmwappushservice start= disabled
REM sc config RemoteRegistry start= disabled
REM sc config TrkWks start= disabled
sc config WMPNetworkSvc start= disabled
sc config WSearch start= disabled
REM sc config SysMain start= disabled

REM *** SCHEDULED TASKS tweaks ***
REM schtasks /Change /TN &quot;Microsoft\Windows\AppID\SmartScreenSpecific&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Windows\Application Experience\ProgramDataUpdater&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Windows\Application Experience\StartupAppTask&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Windows\Customer Experience Improvement Program\Consolidator&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Windows\Customer Experience Improvement Program\KernelCeipTask&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Windows\Customer Experience Improvement Program\UsbCeip&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Windows\Customer Experience Improvement Program\Uploader&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Windows\Shell\FamilySafetyUpload&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Office\OfficeTelemetryAgentLogOn&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Office\OfficeTelemetryAgentFallBack&quot; /Disable
schtasks /Change /TN &quot;Microsoft\Office\Office 15 Subscription Heartbeat&quot; /Disable

REM schtasks /Change /TN &quot;Microsoft\Windows\Autochk\Proxy&quot; /Disable
REM schtasks /Change /TN &quot;Microsoft\Windows\CloudExperienceHost\CreateObjectTask&quot; /Disable
REM schtasks /Change /TN &quot;Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector&quot; /Disable
REM schtasks /Change /TN &quot;Microsoft\Windows\DiskFootprint\Diagnostics&quot; /Disable *** Not sure if should be disabled, maybe related to S.M.A.R.T.
REM schtasks /Change /TN &quot;Microsoft\Windows\FileHistory\File History (maintenance mode)&quot; /Disable
REM schtasks /Change /TN &quot;Microsoft\Windows\Maintenance\WinSAT&quot; /Disable
REM schtasks /Change /TN &quot;Microsoft\Windows\NetTrace\GatherNetworkInfo&quot; /Disable
REM schtasks /Change /TN &quot;Microsoft\Windows\PI\Sqm-Tasks&quot; /Disable
REM The stubborn task Microsoft\Windows\SettingSync\BackgroundUploadTask can be Disabled using a simple bit change. I use a REG file for that (attached to this post).
REM schtasks /Change /TN &quot;Microsoft\Windows\Time Synchronization\ForceSynchronizeTime&quot; /Disable
REM schtasks /Change /TN &quot;Microsoft\Windows\Time Synchronization\SynchronizeTime&quot; /Disable
REM schtasks /Change /TN &quot;Microsoft\Windows\Windows Error Reporting\QueueReporting&quot; /Disable
REM schtasks /Change /TN &quot;Microsoft\Windows\WindowsUpdate\Automatic App Update&quot; /Disable


@rem *** Remove Telemetry &amp; Data Collection ***
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Metadata&quot; /v PreventDeviceMetadataFromNetwork /t REG_DWORD /d 1 /f
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection&quot; /v &quot;AllowTelemetry&quot; /t REG_DWORD /d 0 /f
reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\MRT&quot; /v DontOfferThroughWUAU /t REG_DWORD /d 1 /f
reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\SQMClient\Windows&quot; /v &quot;CEIPEnable&quot; /t REG_DWORD /d 0 /f
reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat&quot; /v &quot;AITEnable&quot; /t REG_DWORD /d 0 /f
reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat&quot; /v &quot;DisableUAR&quot; /t REG_DWORD /d 1 /f
reg add &quot;HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection&quot; /v &quot;AllowTelemetry&quot; /t REG_DWORD /d 0 /f
reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\WMI\AutoLogger\AutoLogger-Diagtrack-Listener&quot; /v &quot;Start&quot; /t REG_DWORD /d 0 /f
reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\WMI\AutoLogger\SQMLogger&quot; /v &quot;Start&quot; /t REG_DWORD /d 0 /f

@REM Settings -&gt; Privacy -&gt; General -&gt; Let apps use my advertising ID...
reg add &quot;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo&quot; /v Enabled /t REG_DWORD /d 0 /f
REM - SmartScreen Filter for Store Apps: Disable
reg add &quot;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost&quot; /v EnableWebContentEvaluation /t REG_DWORD /d 0 /f
REM - Let websites provide locally...
reg add &quot;HKCU\Control Panel\International\User Profile&quot; /v HttpAcceptLanguageOptOut /t REG_DWORD /d 1 /f

@REM WiFi Sense: HotSpot Sharing: Disable
reg add &quot;HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowWiFiHotSpotReporting&quot; /v value /t REG_DWORD /d 0 /f
@REM WiFi Sense: Shared HotSpot Auto-Connect: Disable
reg add &quot;HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowAutoConnectToWiFiSenseHotspots&quot; /v value /t REG_DWORD /d 0 /f

@REM Change Windows Updates to &quot;Notify to schedule restart&quot;
reg add &quot;HKLM\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings&quot; /v UxOption /t REG_DWORD /d 1 /f
@REM Disable P2P Update downlods outside of local network
reg add &quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config&quot; /v DODownloadMode /t REG_DWORD /d 0 /f


REM *** Hide the search box from taskbar. You can still search by pressing the Win key and start typing what you're looking for ***
REM 0 = hide completely, 1 = show only icon, 2 = show long search box
reg add &quot;HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search&quot; /v &quot;SearchboxTaskbarMode&quot; /t REG_DWORD /d 0 /f

REM *** Disable MRU lists (jump lists) of XAML apps in Start Menu ***
reg add &quot;HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot; /v &quot;Start_TrackDocs&quot; /t REG_DWORD /d 0 /f

REM *** Set Windows Explorer to start on This PC instead of Quick Access ***
REM 1 = This PC, 2 = Quick access
REM reg add &quot;HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot; /v &quot;LaunchTo&quot; /t REG_DWORD /d 1 /f

@rem Remove Apps
PowerShell -Command &quot;Get-AppxPackage *3DBuilder* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *Getstarted* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *WindowsAlarms* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *WindowsCamera* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *bing* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *MicrosoftOfficeHub* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *OneNote* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *people* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *WindowsPhone* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *photos* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *SkypeApp* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *solit* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *WindowsSoundRecorder* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *windowscommunicationsapps* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *zune* | Remove-AppxPackage&quot;
REM PowerShell -Command &quot;Get-AppxPackage *WindowsCalculator* | Remove-AppxPackage&quot;
REM PowerShell -Command &quot;Get-AppxPackage *WindowsMaps* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *Sway* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *CommsPhone* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *ConnectivityStore* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *Microsoft.Messaging* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *Facebook* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *Twitter* | Remove-AppxPackage&quot;
PowerShell -Command &quot;Get-AppxPackage *Drawboard PDF* | Remove-AppxPackage&quot;


@rem NOW JUST SOME TWEAKS
REM *** Show hidden files in Explorer ***
REM reg add &quot;HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot; /v &quot;Hidden&quot; /t REG_DWORD /d 1 /f

REM *** Show super hidden system files in Explorer ***
REM reg add &quot;HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot; /v &quot;ShowSuperHidden&quot; /t REG_DWORD /d 1 /f

REM *** Show file extensions in Explorer ***
reg add &quot;HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced&quot; /v &quot;HideFileExt&quot; /t  REG_DWORD /d 0 /f



REM *** Uninstall OneDrive ***
start /wait &quot;&quot; &quot;%SYSTEMROOT%\SYSWOW64\ONEDRIVESETUP.EXE&quot; /UNINSTALL
rd C:\OneDriveTemp /Q /S &gt;NUL 2&gt;&amp;1
rd &quot;%USERPROFILE%\OneDrive&quot; /Q /S &gt;NUL 2&gt;&amp;1
rd &quot;%LOCALAPPDATA%\Microsoft\OneDrive&quot; /Q /S &gt;NUL 2&gt;&amp;1
rd &quot;%PROGRAMDATA%\Microsoft OneDrive&quot; /Q /S &gt;NUL 2&gt;&amp;1
reg add &quot;HKEY_CLASSES_ROOT\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}\ShellFolder&quot; /f /v Attributes /t REG_DWORD /d 0 &gt;NUL 2&gt;&amp;1
reg add &quot;HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}\ShellFolder&quot; /f /v Attributes /t REG_DWORD /d 0 &gt;NUL 2&gt;&amp;1
echo OneDrive has been removed. Windows Explorer needs to be restarted.
pause
start /wait TASKKILL /F /IM explorer.exe
start explorer.exe
</div></code></pre>
<h3 id="powershell-files">PowerShell Files</h3>
<pre><code class="language-ps1"><div>#force-mkdir
function force-mkdir($path) {
    if (!(Test-Path $path)) {
        #Write-Host &quot;-- Creating full path to: &quot; $path -ForegroundColor White -BackgroundColor DarkGreen
        New-Item -ItemType Directory -Force -Path $path
    }
}
</div></code></pre>
<pre><code class="language-ps1"><div>function Takeown-Registry($key) {
    # TODO does not work for all root keys yet
    switch ($key.split('\')[0]) {
        &quot;HKEY_CLASSES_ROOT&quot; {
            $reg = [Microsoft.Win32.Registry]::ClassesRoot
            $key = $key.substring(18)
        }
        &quot;HKEY_CURRENT_USER&quot; {
            $reg = [Microsoft.Win32.Registry]::CurrentUser
            $key = $key.substring(18)
        }
        &quot;HKEY_LOCAL_MACHINE&quot; {
            $reg = [Microsoft.Win32.Registry]::LocalMachine
            $key = $key.substring(19)
        }
    }

    # get administraor group
    $admins = New-Object System.Security.Principal.SecurityIdentifier(&quot;S-1-5-32-544&quot;)
    $admins = $admins.Translate([System.Security.Principal.NTAccount])

    # set owner
    $key = $reg.OpenSubKey($key, &quot;ReadWriteSubTree&quot;, &quot;TakeOwnership&quot;)
    $acl = $key.GetAccessControl()
    $acl.SetOwner($admins)
    $key.SetAccessControl($acl)

    # set FullControl
    $acl = $key.GetAccessControl()
    $rule = New-Object System.Security.AccessControl.RegistryAccessRule($admins, &quot;FullControl&quot;, &quot;Allow&quot;)
    $acl.SetAccessRule($rule)
    $key.SetAccessControl($acl)
}

function Takeown-File($path) {
    takeown.exe /A /F $path
    $acl = Get-Acl $path

    # get administraor group
    $admins = New-Object System.Security.Principal.SecurityIdentifier(&quot;S-1-5-32-544&quot;)
    $admins = $admins.Translate([System.Security.Principal.NTAccount])

    # add NT Authority\SYSTEM
    $rule = New-Object System.Security.AccessControl.FileSystemAccessRule($admins, &quot;FullControl&quot;, &quot;None&quot;, &quot;None&quot;, &quot;Allow&quot;)
    $acl.AddAccessRule($rule)

    Set-Acl -Path $path -AclObject $acl
}

function Takeown-Folder($path) {
    Takeown-File $path
    foreach ($item in Get-ChildItem $path) {
        if (Test-Path $item -PathType Container) {
            Takeown-Folder $item.FullName
        } else {
            Takeown-File $item.FullName
        }
    }
}

function Elevate-Privileges {
    param($Privilege)
    $Definition = @&quot;
    using System;
    using System.Runtime.InteropServices;

    public class AdjPriv {
        [DllImport(&quot;advapi32.dll&quot;, ExactSpelling = true, SetLastError = true)]
            internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr prev, IntPtr rele);

        [DllImport(&quot;advapi32.dll&quot;, ExactSpelling = true, SetLastError = true)]
            internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

        [DllImport(&quot;advapi32.dll&quot;, SetLastError = true)]
            internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

        [StructLayout(LayoutKind.Sequential, Pack = 1)]
            internal struct TokPriv1Luid {
                public int Count;
                public long Luid;
                public int Attr;
            }

        internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
        internal const int TOKEN_QUERY = 0x00000008;
        internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

        public static bool EnablePrivilege(long processHandle, string privilege) {
            bool retVal;
            TokPriv1Luid tp;
            IntPtr hproc = new IntPtr(processHandle);
            IntPtr htok = IntPtr.Zero;
            retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
            tp.Count = 1;
            tp.Luid = 0;
            tp.Attr = SE_PRIVILEGE_ENABLED;
            retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
            retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
            return retVal;
        }
    }
&quot;@
    $ProcessHandle = (Get-Process -id $pid).Handle
    $type = Add-Type $definition -PassThru
    $type[0]::EnablePrivilege($processHandle, $Privilege)
}
</div></code></pre>
<p>block-telemetry.ps1</p>

    </body>
    </html>