# Windows Admin

/TODO Copy in OneNote notes

## Notes

Note for Windows users on 64-bit systems

- Progra~1 = 'Program Files'
- Progra~2 = 'Program Files(x86)'

## VS Code

code _ , where _ is

- `.`(period) Open Code in the Current dir

## Windows Functions

`msconfig` - get to **safe mode**



## Keyboard SHortcuts

### Windows Keys

Left Windows + ...

[T] = Cycle Task Bar Apps
[U] = Open Ease of Access Center
[=] = Open Magnifier
[M] = Minimize all Windows
[Tab] = Open Task View 
[R] = Run Dialogue
[K] = Open Quick Connect
[I] = Open Windows Settins
[E] = Open File Explorer
[L] = Lock
[G] = Windows Game Bar
[.] = Open Emoji Panel
[S] = Open Search
[A] = Open Action Center
[D] = Hide/Show Desktop
[X] = Open Quick Links
[Ctrl] + [Enter] = Open Narrator
[B] = Set Focus in Notification Area

[Ctrl] + [Shift] + [Esc] = Open Task Manager
[Ctrl] + [Esc] = Open Start
[Alt] + [Tab] = Switch Between Apps
[Alt] + [Esc] = Cycle Between Apps
[Alt] + [Left] = Go Back
[Alt] + [Right] = Go Forward

## Basic Commands


| Command       | Description                                                                                                                                                                                                |   |
| ------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | - |
| assoc         | Displays or modifies file name extension associations. Used alone, displays a list of all the current file name associations                                                                               |   |
| at            | Schedules commands and programs to run on a computer at a specified time and date. Requires the Schedule service. Superseded by schtasks                                                                   |   |
|               |                                                                                                                                                                                                            |   |
| attrib        | Configures file attributes read only, hidden, system                                                                                                                                                       |   |
| bootcfg       | Used to repair or edit the boot.ini file                                                                                                                                                                   |   |
| cd or chdir   | Displays the name of the current directory or changes the current folder                                                                                                                                   |   |
| chkdsk        | Checks hard drives for errors. With switches,does repairs.                                                                                                                                                 |   |
| cls           | Clears the screen                                                                                                                                                                                          |   |
| copy          | Copies a file from one location to another                                                                                                                                                                 |   |
| del           | Deletes one or more files                                                                                                                                                                                  |   |
| dir           | Displays a list of a folder's files and subfolders                                                                                                                                                         |   |
| diskpart      | Disk management shell. A suite of various commands                                                                                                                                                         |   |
| driverquery   | Displays a list of all installed device drivers and their properties. Requires administrator privileges. (Not available in Windows XP Home)                                                                |   |
| echo          | Used to display a message or to turn off/on messages in batch scripts                                                                                                                                      |   |
|               |                                                                                                                                                                                                            |   |
| exit          | Exits batch script or current command control                                                                                                                                                              |   |
| fc            | Compares two files and displays the differences between them                                                                                                                                               |   |
| find          | Searches for a text string in a file or files. Can also be used with output from another command.                                                                                                          |   |
| findstr       | Searches for text string patterns in a file using regular expressions                                                                                                                                      |   |
| for           | Runs a specified command for each item in a set                                                                                                                                                            |   |
| fsutil        | Displays and configures certain file system properties. A suite of various commands                                                                                                                        |   |
| ftype         | Displays or modifies file types used in file name extension associations                                                                                                                                   |   |
| getmac        | Returns the media access control (MAC) address for your network card                                                                                                                                       |   |
| goto          | Directs the Windows command interpreter to a labeled line in a batch program                                                                                                                               |   |
| if            | Performs conditional processing in batch programs                                                                                                                                                          |   |
| ipconfig      | Displays all current TCP/IP network configuration values and refreshes Dynamic Host Configuration Protocol (DHCP) and Domain Name System (DNS) settings                                                    |   |
| md or mkdir   | Creates a directory (folder) or subdirectory (subfolder)                                                                                                                                                   |   |
| more          | Displays one screen of output at a time. Used with another command that has extensive output                                                                                                               |   |
| move          | Moves a file from one folder to another                                                                                                                                                                    |   |
| net           | A suite of various networking and service commands                                                                                                                                                         |   |
| netsh         | Network services shell . Complex suite of commands.                                                                                                                                                        |   |
| netstat       | Displays active TCP connections, ports on which the computer is listening, Ethernet statistics, the IP routing table, statistics for the IP, ICMP, TCP, and UDP protocols                                  |   |
| path          | Sets the command path in the PATH environment variable, which is the set of directories used to search for executable files                                                                                |   |
| pathping      | Provides information about network performance and conditions at intermediate hops between a source and destination                                                                                        |   |
| pause         | Used in batch scripts                                                                                                                                                                                      |   |
| ping          | Checks connectivity to other networked computers, routers, or Internet sites                                                                                                                               |   |
| popd, pushd   | Changes the directory being referenced in a command prompt. Pushd changes the directory and stores the previous directory. Popd changes the current directory to the directory stored by the pushd command |   |
| powercfg      | Manages the power settings such as hibernation. Has numerous switches                                                                                                                                      |   |
| reg           | Adds, changes, and displays registry entries. A suite of various commands                                                                                                                                  |   |
| rd or rmdir   | Deletes a directory (folder)                                                                                                                                                                               |   |
| ren or rename | Changes the name of a file or a set of files                                                                                                                                                               |   |
| sc            | Used to obtain information about services and to configure them. A suite of various commands                                                                                                               |   |
| schtasks      | Schedules commands and programs to run periodically or at a specific time                                                                                                                                  |   |
| set           | Displays, sets, or removes environment variables                                                                                                                                                           |   |
| sfc           | System file checker scans and verifies the versions of all protected system files                                                                                                                          |   |
| shutdown      | Shuts down or restarts a computer                                                                                                                                                                          |   |
| sort          | Alphabetizes strings from a text file or the output of a command.                                                                                                                                          |   |
| start         | Starts an application or opens a new command window                                                                                                                                                        |   |
| subst         | Associates a folder with a drive letter                                                                                                                                                                    |   |
| systeminfo    | Displays detailed configuration information about a computer and its operating system                                                                                                                      |   |
| taskkill      | Ends one or more tasks or processes                                                                                                                                                                        |   |
| tasklist      | Displays a list of applications and services with their Process ID (PID) for all tasks running                                                                                                             |   |
| tree          | Graphically displays the directory structure of a folder or drive                                                                                                                                          |   |
|               |                                                                                                                                                                                                            |   |
| type          | Displays the contents of a text file                                                                                                                                                                       |   |
| vssadmin      | For administering and configuring volume shadow copies                                                                                                                                                     |   |
| xcopy         | Powerful command with many switches for copying and backing up files and folders                                                                                                                           |   |


=======

- `Command`- Description|
- `-------------`- ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
- `assoc`- Displays or modifies file name extension associations. Used alone, displays a list of all the current file name associations
- `at`- Schedules commands and programs to run on a computer at a specified time and date. Requires the Schedule service. Superseded by schtasks
- ` `-  
- `attrib`- Configures file attributes read only, hidden, system
- `bootcfg`- Used to repair or edit the boot.ini file
- `cd or chdir`- Displays the name of the current directory or changes the current folder
- `chkdsk`- Checks hard drives for errors. With switches,does repairs.
- `cls`- Clears the screen
- `copy`- Copies a file from one location to another
- `del`- Deletes one or more files
- `dir`- Displays a list of a folder's files and subfolders
- `diskpart`- Disk management shell. A suite of various commands
- `driverquery`- Displays a list of all installed device drivers and their properties. Requires administrator privileges. (Not available in Windows XP Home)
- `echo`- Used to display a message or to turn off/on messages in batch scripts
- ` `-  
- `exit`- Exits batch script or current command control
- `fc`- Compares two files and displays the differences between them
- `find`- Searches for a text string in a file or files. Can also be used with output from another command.
- `findstr`- Searches for text string patterns in a file using regular expressions
- `for`- Runs a specified command for each item in a set
- `fsutil`- Displays and configures certain file system properties. A suite of various commands
- `ftype`- Displays or modifies file types used in file name extension associations
- `getmac`- Returns the media access control (MAC) address for your network card
- `goto`- Directs the Windows command interpreter to a labeled line in a batch program
- `if`- Performs conditional processing in batch programs
- `ipconfig`- Displays all current TCP/IP network configuration values and refreshes Dynamic Host Configuration Protocol (DHCP) and Domain Name System (DNS) settings
- `md or mkdir`- Creates a directory (folder) or subdirectory (subfolder)
- `more`- Displays one screen of output at a time. Used with another command that has extensive output
- `move`- Moves a file from one folder to another
- `net`- A suite of various networking and service commands
- `netsh`- Network services shell . Complex suite of commands.
- `netstat`- Displays active TCP connections, ports on which the computer is listening, Ethernet statistics, the IP routing table, statistics for the IP, ICMP, TCP, and UDP protocols
- `path`- Sets the command path in the PATH environment variable, which is the set of directories used to search for executable files
- `pathping`- Provides information about network performance and conditions at intermediate hops between a source and destination
- `pause`- Used in batch scripts
- `ping`- Checks connectivity to other networked computers, routers, or Internet sites
- `popd, pushd`- Changes the directory being referenced in a command prompt. Pushd changes the directory and stores the previous directory. Popd changes the current directory to the directory stored by the pushd command
- `powercfg`- Manages the power settings such as hibernation. Has numerous switches
- `reg`- Adds, changes, and displays registry entries. A suite of various commands
- `rd or rmdir`- Deletes a directory (folder)
- `ren or rename`- Changes the name of a file or a set of files
- `sc`- Used to obtain information about services and to configure them. A suite of various commands
- `schtasks`- Schedules commands and programs to run periodically or at a specific time
- `set`- Displays, sets, or removes environment variables
- `sfc`- System file checker scans and verifies the versions of all protected system files
- `shutdown`- Shuts down or restarts a computer
- `sort`- Alphabetizes strings from a text file or the output of a command.
- `start`- Starts an application or opens a new command window
- `subst`- Associates a folder with a drive letter
- `systeminfo`- Displays detailed configuration information about a computer and its operating system
- `taskkill`- Ends one or more tasks or processes
- `tasklist`- Displays a list of applications and services with their Process ID (PID) for all tasks running
- `tree`- Graphically displays the directory structure of a folder or drive
- ` `-  
- `type`- Displays the contents of a text file
- `vssadmin`- For administering and configuring volume shadow copies
- `xcopy`- Powerful command with many switches for copying and backing up files and folders





### List COM interfaces

Where can I find all of the COM objects that can be created in Powershell?

gci HKLM:\Software\Classes -ea 0| ? {$_.PSChildName -match '^\w+\.\w+$' -and
(gp "$($\_.PSPath)\CLSID" -ea 0)} | ft PSChildName

From <https://stackoverflow.com/questions/660319/where-can-i-find-all-of-the-com-objects-that-can-be-created-in-powershell>

How to get a list of COM objects via WMI & PowerShell
Posted: October 26th, 2013 | Tags: COM, wmi | Category: PowerShell | § 
Let’s see what WMI can tell us about COM objects on the system.
Get a list of all WMI classes with the word “COM” in them (doing a case sensitive match to avoid entries like “computer”).

```ps1
1   PS> gwmi -list | ?{ $_.Name -cmatch "COM" }
2    
3      NameSpace: ROOT\cimv2
4    
5   Name                                Methods              Properties
6   ----                                -------              ----------
7   MSFT_WMI_GenericNonCOMEvent         {}                   {ProcessId, PropertyNames, PropertyValues, ProviderName...}
8   Win32_COMApplication                {}                   {Caption, Description, InstallDate, Name...}
9   Win32_DCOMApplication               {}                   {AppID, Caption, Description, InstallDate...}
10  Win32_COMClass                      {}                   {Caption, Description, InstallDate, Name...}
11  Win32_ClassicCOMClass               {}                   {Caption, ComponentId, Description, InstallDate...}
12  Win32_COMSetting                    {}                   {Caption, Description, SettingID}
13  Win32_ClassicCOMClassSetting        {}                   {AppID, AutoConvertToClsid, AutoTreatAsClsid, Caption...}
14  Win32_DCOMApplicationSetting        {GetLaunchSecurit... {AppID, AuthenticationLevel, Caption, CustomSurrogate...}
15  Win32_ClassicCOMClassSettings       {}                   {Element, Setting}
16  Win32_COMApplicationSettings        {}                   {Element, Setting}
17  Win32_DCOMApplicationAccessAllow... {}                   {Element, Setting}
18  Win32_COMApplicationClasses         {}                   {GroupComponent, PartComponent}
19  Win32_ClassicCOMApplicationClasses  {}                   {GroupComponent, PartComponent}
20  Win32_DCOMApplicationLaunchAllow... {}                   {Element, Setting}
```

## Command Line

[SS64 Batch Help](https://ss64.com/nt/for.html)
C:\temp$ fsutil
---- Commands Supported ----
8dot3name       8dot3name management
behavior        Control file system behavior
dirty           Manage volume dirty bit
file            File specific commands
fsinfo          File system information
hardlink        Hardlink management
objectid        Object ID management
quota           Quota management
repair          Self healing management
reparsepoint    Reparse point management
resource        Transactional Resource Manager management
sparse          Sparse file control
tiering         Storage tiering property management
transaction     Transaction management
usn             USN management
volume          Volume management
wim             Transparent wim hosting management

remote desktop command line (use /console if all slots full)
c:\> mstsc /v:SERVERNAME [/console]
list other RDP sessions on the server
c:\> query session
kick someone off -- useful when paired with sysinternals psexec, or powershell remoting
c:\> logoff SESSIONID

use mstsc /admin instead. Use mstsc /? for a list of commands.

Never knew aboput clip, and while investigating a problem yesterday I found another command I knew nothing about, the "where" command, it displays the location of a file.

where dotnet.exe
C:\Program Files\dotnet\dotnet.exe

 Create a text file
copy con lazydog.txt
The quick brown fox jumps over the lazy dog
Ctrl-z

cd \win*
type *.log[tab][tab][tab][tab]
cd syste[tab][tab]

Command prompt also supports drag and drop: If you want to copy the exact path to a folder or file to run the file or change the present working directory, you can simply drag and drop the file or the folder on the command prompt.
And there are more command history features available via function keys:
F1: Pastes per character last used command
F2: Pastes last used command only to a specified command character
F3: Pastes Last used command
F4: Delete command only to a specified command character
F5: Pastes last used command without cycling
F6: Pastes ^Z
F7: Provides a list of already used commands (selectable)
F8: Pastes cycleable used commands
F9: Will let you paste command from the list of recently used commands

I didn't know about clip, but then I've been using the UnxUtils collection for years and that has gclip, which does the same thing. I would probably have discovered clip by now if it wasn't for that.
Someone mentioned pushd and popd; there's a good use case for these that people may not be aware of. While you can navigate to a UNC path in File Explorer you can't cd to one on the command line, but you can use pushd to achieve the same thing. It will actually map a drive to the share with the next available drive letter, before changing to the directory. When the previous directory is popped off the stack with popd, the mapped drive is released.
I find Rob van der Woude's Scripting Pages to be a great resource for researching command line and batch language stuff. Look under Scripting Languages | Batch Files in the sidebar. There is info on a number of other scripting languages there too.
http://www.robvanderwoude.com/

copy con autoexec.bat
prompt $p$g
win
^Z

Redirecting output to txtfile always handy
Like:
dir /b | find ".exe" > findlist.txt | notepad findlist.txt
https://technet.microsoft.com/en-us/library/bb490982.aspx

SET /A for integer arithmetic, including bitwise operators.
The FOR command, for, well, just about anything. FORFILES.EXE, for one special case thereof.
DOSKEY.EXE for command prompt macros, and also macros for any command-line application.
GETMAC.EXE for getting adapter MAC addresses on the command line.
The CMD batch language itself.
And many, many more...


@echo off
setlocal
if "%echo%" neq "" echo %echo%
pushd %~dp0
What it does:
turn off output of commands.
make changes to the environment local to the script
check if the env-var echo contains something. by doing "set echo=on" before calling the script I can switch on output of commands for debugging.
Set the current directory to the scripts directory. this is optional, but most of my scripts assume relative path (My old saying: The absolute path is the singleton of config management)


Catching errors:
dir I-do-not-exist || goto :error
goto :eof
:error
echo ERROR in %~dpnx0 %*
exit /b 1
Explanation:
"||" executes the follwing command if the first fails
skip the ":error" block
echo the file in which the error occured (full path) and all the parameters
return some error code

Something I always have to do on new machines is create a new environment variable DIRCMD and set to /ogn
setx DIRCMD /ogn
Then output from 'dir' is always sorted correctly with directories grouped at the top, can't believe it's not the default


I often use findstr to locate strings in files. A 'memory helper' for parameters is 'sin' to search for sub directories, case insensitive, display line number. Example to find foobar in txt files:
findstr /s /i /n foobar *.txt

doskey.exe can clear, set the size of, and list the command history of an executable that's attached to the current console. The implementation uses the following undocumented console APIs:
doskey /reinstall /exename=[ExeName]
  VOID ExpungeConsoleCommandHistory(LPTSTR ExeName)
doskey /listsize=[Number] /exename=[ExeName]
  BOOL SetConsoleNumberOfCommands(DWORD Number, 
                                  LPTSTR ExeName)
doskey /history /exename=[ExeName]
  DWORD GetConsoleCommandHistoryLength(LPTSTR ExeName)
  DWORD GetConsoleCommandHistory(LPTSTR CommandBuffer, 
                                 DWORD CommandBufferLength, 
                                 LPTSTR ExeName)
I can't be the only person frustrated by how opening a new console doesn't load the command history from previous (not current) instances of console applications. The console needs a SetConsoleCommandHistory function. Please ask the team that owns the console subsystem (conhost.exe, conhostv2.dll, condrv.sys) and doskey.exe to implement something like this -- and to document these functions as public APIs. A doskey "/historyfile" option could support [ExeName] sections, like the current "/macrofile" option.
cmd.exe supports an AutoRun registry value, which would allow running doskey.exe to load command history, but it doesn't allow automatically saving history. I'd prefer that cmd.exe handled this automatically (but only for its own history) by appending to a per-user history file stored in "%APPDATA%\Microsoft\Command Processor\history.txt", which reflects the location of its registry key, "HKCU\SOFTWARE\Microsoft\Command Processor".



Sorry, one more favorite of mine
start .
Open a File Explorer for the current directory. Because sometimes dir doesn't cut it.


dir /s | more
for pausing output per page


dir /a,
Hidden dir parameter - shows all files (hidden, system, etc) without have to specify the full list of things to unhide. (note that is a comma after the "/a")


"mklink" is a good use of "cmd". I prefer symbolic links to shortcuts. I haven't seen a way to make symbolic links in the file manager.



Try this on command line on NTFS drive:
echo hidden > test.txt:hidden
echo hidden2 >> test.txt:hidden
do a dir test.txt , what's the file size?
do a type test.txt or use notepad to edit , it's empty
do a more < test.txt:hidden
you see what you have echo and pipe and append into the test.txt section hidden ;-)


hostname
whoami


Don't forget pushd and popd.
'Pushd' changes directory to the parameter and remembers the current directory on a stack. It's a little better than 'cd' because you can also change folders and drive letters in one command.
'Popd' pops the directory off the stack and changes to it -- including changing drive letters.
So with pushd and popd you can really drill in and then pop back. I use a DOSKEY macrofile that makes 'cd' a macro for pushd and '.' a macro for popd. This turns the '.' key into a back button.



'Call' for subroutines
To execute a set of custom commands based on command line arguments
1. Parse/validate command line arguments
2. Use ECHO to write .bat file to execute the sequence of commands
3. Call that batch file
This provides equivalent function call functionality to bash.
Current command set:
- The built in dos batch commands
- gnuwin32 - most of the basic unix commands
- sysinternals suite
- image processing
- optipng - compress and fix badly formatted png files
- imagej - open dicom and lots of basic image formats, image processing, opens source
- xpdf - extract text from pdf, render pdf pages to 300 or higher dpi image files, extrac images from pdf, split pdf into individual pages, concatenate pdf files into a single pdf, ...
- jpegtran - optimize jpeg files, drop partial blocks from edge of file
- imagemagick
- gnuwin32's tiff2pdf convert a multipage tiff file to a single pdf
- media
- mplayer
- videolan
- audio
- lame
That's let me watch/convert from most video and audio formats, convert/extract/build pdf files, ...
If VS would only add one thing.....tell the actual DLL that was not found when it reports a DLL or one of its dependencies could not be loaded........................
The OS has the information since it could not find/load the DLL and should have a way to report it back to VS in debug mode.....

### Command Line Commands


   ADDUSERS Add or list users to/from a CSV file
   ADmodcmd Active Directory Bulk Modify
   ARP      Address Resolution Protocol
   ASSOC    Change file extension associations•
   ATTRIB   Change file attributes
b
   BCDBOOT  Create or repair a system partition
   BCDEDIT  Manage Boot Configuration Data
   BITSADMIN Background Intelligent Transfer Service
   BROWSTAT Get domain, browser and PDC info
c
   CACLS    Change file permissions
   CALL     Call one batch program from another•
   CERTREQ  Request certificate from a certification authority
   CERTUTIL Utility for certification authority (CA) files and services
   CD       Change Directory - move to a specific Folder•
   CHANGE   Change Terminal Server Session properties
   CHCP     Change the active console Code Page
   CHKDSK   Check Disk - check and repair disk problems
   CHKNTFS  Check the NTFS file system
   `CHOICE`   Accept keyboard input to a batch file
   CIPHER   Encrypt or Decrypt files/folders
   CleanMgr Automated cleanup of Temp files, recycle bin
   CLIP     Copy STDIN to the Windows clipboard
   CLS      Clear the screen•
   CMD      Start a new CMD shell
   CMDKEY   Manage stored usernames/passwords
   COLOR    Change colors of the CMD window•
   COMP     Compare the contents of two files or sets of files
   COMPACT  Compress files or folders on an NTFS partition
   COMPRESS Compress one or more files
   CONVERT  Convert a FAT drive to NTFS
   COPY     Copy one or more files to another location•
   Coreinfo Show the mapping between logical & physical processors
   CSCcmd   Client-side caching (Offline Files)
   CSVDE    Import or Export Active Directory data 
d
   DATE     Display or set the date•
   DEFRAG   Defragment hard drive
   DEL      Delete one or more files•
   DELPROF  Delete user profiles
   DELTREE  Delete a folder and all subfolders
   DevCon   Device Manager Command Line Utility 
   DIR      Display a list of files and folders•
   DIRQUOTA File Server Resource Manager Disk quotas
   DIRUSE   Display disk usage
   DISKPART Disk Administration
   DISKSHADOW Volume Shadow Copy Service
   DISKUSE  Show the space used in folders
   DISM     Deployment Image Servicing and Management
   DNSCMD   Manage DNS servers
   DOSKEY   Edit command line, recall commands, and create macros
   DriverQuery Display installed device drivers
   DSACLs   Active Directory ACLs
   DSAdd    Add items to active directory (user group computer) 
   DSGet    View items in active directory (user group computer)
   DSQuery  Search for items in active directory (user group computer)
   DSMod    Modify items in active directory (user group computer)
   DSMove   Move an Active directory Object
   DSRM     Remove items from Active Directory
   Dsmgmt   Directory Service Management
e
   ECHO     Display message on screen•
   ENDLOCAL End localisation of environment changes in a batch file•
   ERASE    Delete one or more files•
   EVENTCREATE Add a message to the Windows event log
   EXIT     Quit the current script/routine and set an errorlevel•
   EXPAND   Uncompress CAB files
   EXPLORER Open Windows Explorer
   EXTRACT  Uncompress CAB files
f
   FC       Compare two files
   FIND     Search for a text string in a file
   FINDSTR  Search for strings in files
   FLTMC    Manage MiniFilter drivers
   FOR /F   Loop command: against a set of files•
   FOR /F   Loop command: against the results of another command•
   FOR      Loop command: all options Files, Directory, List•
   FORFILES Batch process multiple files
   FORMAT   Format a disk
   FREEDISK Check free disk space
   FSUTIL   File and Volume utilities
   FTP      File Transfer Protocol
   FTYPE    File extension file type associations•
g
   GETMAC   Display the Media Access Control (MAC) address
   GOTO     Direct a batch program to jump to a labelled line•
   GPRESULT Display Resultant Set of Policy information
   GPUPDATE Update Group Policy settings
h
   HELP     Online Help
   HOSTNAME Display the host name of the computer
i
   iCACLS   Change file and folder permissions
   IEXPRESS Create a self extracting ZIP file archive
   IF       Conditionally perform a command•
   IFMEMBER Is the current user a member of a group
   IPCONFIG Configure IP
   INUSE    Replace files that are in use by the OS
l
   LABEL    Edit a disk label
   LGPO     Local Group Policy Object utility
   LODCTR   Load PerfMon performance counters
   LOGMAN   Manage Performance Monitor logs
   LOGOFF   Log a user off
   LOGTIME  Log the date and time in a file
m
   MAKECAB  Create .CAB files
   MAPISEND Send email from the command line
   MBSAcli  Baseline Security Analyzer
   MEM      Display memory usage
   MD       Create new folders•
   MKLINK   Create a symbolic link (linkd) •
   MODE     Configure a system device COM/LPT/CON
   MORE     Display output, one screen at a time
   MOUNTVOL Manage a volume mount point
   MOVE     Move files from one folder to another•
   MOVEUSER Move a user from one domain to another
   MSG      Send a message
   MSIEXEC  Microsoft Windows Installer
   MSINFO32 System Information
   MSTSC    Terminal Server Connection (Remote Desktop Protocol)
n
   NET      Manage network resources
   NETDOM   Domain Manager
   NETSH    Configure Network Interfaces, Windows Firewall & Remote access
   NBTSTAT  Display networking statistics (NetBIOS over TCP/IP)
   NETSTAT  Display networking statistics (TCP/IP)
   NLSINFO  Display locale information (reskit).
   NLTEST   Network Location Test (AD)
   NOW      Display the current Date and Time 
   NSLOOKUP Name server lookup
   NTBACKUP Windows Backup folders to tape
   NTDSUtil Active Directory Domain Services management
   NTRIGHTS Edit user account rights
   NVSPBIND Modify network bindings
o
   OPENFILES Query or display open files
p
   PATH     Display or set a search path for executable files•
   PATHPING Trace route plus network latency and packet loss
   PAUSE    Suspend processing of a batch file and display a message•
   PERMS    Show permissions for a user
   PERFMON  Performance Monitor
   PING     Test a network connection
   POPD     Return to a previous directory saved by PUSHD•
   PORTQRY  Display the status of ports and services
   POWERCFG Configure power settings
   PRINT    Print a text file
   PRINTBRM Print queue Backup/Recovery
   PRNCNFG  Configure or rename a printer
   PRNMNGR  Add, delete, list printers and printer connections
   ProcDump Monitor an application for CPU spikes
   PROMPT   Change the command prompt•
   PsExec     Execute process remotely
   PsFile     Show files opened remotely
   PsGetSid   Display the SID of a computer or a user
   PsInfo     List information about a system
   PsKill     Kill processes by name or process ID
   PsList     List detailed information about processes
   PsLoggedOn Who's logged on (locally or via resource sharing)
   PsLogList  Event log records
   PsPasswd   Change account password
   PsPing     Measure network performance
   PsService  View and control services
   PsShutdown Shutdown or reboot a computer
   PsSuspend  Suspend processes
   PUSHD    Save and then change the current directory•
q
   QGREP    Search file(s) for lines that match a given pattern
   Query Process / QPROCESS  Display processes
   Query Session / QWinsta   Display all sessions (TS/Remote Desktop)
   Query TermServer /QAppSrv List all servers (TS/Remote Desktop)
   Query User    / QUSER     Display user sessions (TS/Remote Desktop)
r
   RASDIAL  Manage RAS connections
   RASPHONE Manage RAS connections
   RD       Delete folder(s)•
   RECOVER  Recover a damaged file from a defective disk
   REG      Registry: Read, Set, Export, Delete keys and values
   REGEDIT  Import or export registry settings
   REGSVR32 Register or unregister a DLL
   REGINI   Change Registry Permissions
   REM      Record comments (remarks) in a batch file•
   REN      Rename a file or files•
   REPLACE  Replace or update one file with another
   Reset Session  Delete a Remote Desktop Session
   RMTSHARE Share a folder or a printer
   ROBOCOPY Robust File and Folder Copy
   ROUTE    Manipulate network routing tables
   RUN      Start | RUN commands
   RUNAS    Execute a program under a different user account
   RUNDLL32 Run a DLL command (add/remove print connections)

s
   SC       Service Control
   SCHTASKS Schedule a command to run at a specific time
   SET      Display, set, or remove session environment variables•
   SETLOCAL Control the visibility of environment variables•
   SetSPN   Edit Service Principal Names
   SETX     Set environment variables
   SFC      System File Checker 
   SHARE    List or edit a file share or print share
   ShellRunAs Run a command under a different user account
   SHIFT    Shift the position of batch file parameters•
   SHORTCUT Create a windows shortcut (.LNK file)
   SHUTDOWN Shutdown the computer
   SIGCHECK Display file version no. VirusTotal status & timestamp
   SLEEP    Wait for x seconds
   SLMGR    Software Licensing Management (Vista/2008)
   SORT     Sort input
   START    Start a program, command or batch file•
   STRINGS  Search for ANSI and UNICODE strings in binary files
   SUBINACL Edit file and folder Permissions, Ownership and Domain
   SUBST    Associate a path with a drive letter
   SYSMON   Monitor and log system activity to the Windows event log
   SYSTEMINFO List system configuration
t
   TAKEOWN  Take ownership of a file
   TASKLIST List running applications and services
   TASKKILL End a running process
   TELNET   Communicate with another host using the TELNET protocol
   TIME     Display or set the system time•
   TIMEOUT  Delay processing of a batch file/command
   TITLE    Set the window title for a CMD.EXE session•
~~TLIST    Task list with full path~~
   TOUCH    Change file timestamps    
   TRACERT  Trace route to a remote host
   TREE     Graphical display of folder structure
   TSDISCON Disconnect a Remote Desktop Session
   TSKILL   End a running process
   TYPE     Display the contents of a text file•
   TypePerf Write performance data to a log file
   TZUTIL   Time Zone Utility
v
   VER      Display version information•
   VERIFY   Verify that files have been saved•
   VMConnect Connect to a Hyper-V Virtual Machine
   VOL      Display a disk label•
   VSSADMIN Display volume shadow copy backups and shadow copy writers/providers. 
w
   W32TM    Time Service
   WAITFOR  Wait for or send a signal
   WBADMIN  Windows Backup Admin
   WECUTIL  Windows Event Collector Utility
   WEVTUTIL Clear event logs, enable/disable/query logs
   WHERE    Locate and display files in a directory tree
   WHOAMI   Output the current UserName and domain
   WINDIFF  Compare the contents of two files or sets of files
   WINRM    Windows Remote Management
   WINRS    Windows Remote Shell
   WMIC     WMI Commands
   WPEUTIL  Run WinPE commands
   WPR      Windows Performance Recorder
   WUSA     Windows Update Standalone Installer
   WUAUCLT  Windows Update
x
   XCACLS   Change file and folder permissions
   XCOPY    Copy files and folders
   ::       Comment / Remark•

ARP
AT *deprecated*
A
### clip

PIPE COMMAND OUTPUT TO THE CLIPBOARD
In Vista they added clip.exe. It captures any standard input and puts in the clipboard.

That means you can

```bat
dir /s | clip
ver | clip
ipconfig /all | clip
```

### type

type followed by the filename prints the contents of the file. Use the pipe (|) and clip to copy to the clipboard. Works in the same way cat does in PowerShell.

type somefile.txt | clip


### F7

F7 GIVES YOU A GRAPHICAL (TEXT) HISTORY

If you have already typed a few commands, you can press F7 to get an ANSI popup with a list of commands you've typed. 4DOS anyone?

F11 or "ALT-ENTER" in the command prompt (any prompt, cmd, powershell, or bash) will make it full screen. I like to put my command prompt on another virtual desktop and then use CTRL-WIN-ARROWS to move between them.


###  ?

cd | clip
dir /b /s | clip
mode con rate=32 delay=1
echo AT&F&C1&D2M1L3S11=33 > COM

### mpcmdrun.exe (Windows Defen


`MpCmdRun.exe` - Runs the Windows Defender Commandline tool, but it is not on path.

Usage: MpCmdRun.exe [command] [-options]

```bat
cd "%ProgramFiles%\Windows Defender\"
MpCmdRun.exe -?
#or better yet- just use:
"%ProgramFiles%\Windows Defender\MpCmdRun.exe" -?
```

| Command                                   | Description                                                |
| ----------------------------------------- | ---------------------------------------------------------- |
| -? or -h                                  | Displays all available options for this tool               |
| -Scan  [^Scan]                            | Scans for malicious software                               |
| -Trace [^Trace]                           | Starts diagnostic tracing                                  |
| -GetFiles                                 | Collects support information                               |
| -GetFilesDiagTrack                        | Same as Getfiles but outputs to temporary DiagTrack folder |
| -RemoveDefinitions                        | See details below for each [^Remove]                       |
| -SignatureUpdate                          | Checks for new Security intelligence updates               |
| -Restore [^Restore]                       | Restores or lists quarantined item(s)                      |
| -AddDynamicSignature [-Path]              | Loads dynamic Security intelligence                        |
| -ListAllDynamicSignatures                 | Lists the loaded dynamic Security intelligence             |
| -RemoveDynamicSignature [-SignatureSetID] | Removes dynamic Security intelligence                      |
| -CheckExclusion -path                     | Checks whether a path is excluded                          |


**Scan** has the following sub options
[^Scan]: [-ScanType #] [-File [-DisableRemediation] [-BootSectorScan]] [-Timeout ] [-Cancel]

Restore has the folloing options
 [^Restore]:  [-ListAll \| [[-Name ] [-All] \| [-FilePath ]] [-Path ]] 

[^Trace]: [-Grouping #] [-Level #]   

[^SignatureUpdate]: [-UNC \| -MMPC]
To run, use: 


[^Remove]: RemoveDefinitions 
  [-All] Restores the installed Security intelligence to a previous backup copy or to the original default set
 [-DynamicSignatures] Removes only the dynamically downloaded Security intelligence  
 [-Engine]  Restores the previous installed engine       
`"%ProgramFiles%\Windows Defender\MpCmdRun.exe" -scan -scantype 3 -File <Path> -DisableRemediation`

Scantype 3 means a specific directory/file. File gives the file, and disabling remediation prevents any outcomes except to terminal (deleting, logging, attempting clean.)

### taskkill

Kill a task, then immediately restart it.

```bat
taskkill /f /im explorer.exe & start explorer.exe
```

Taskkill:

```bat
TASKKILL [/S system [/U username [/P [password]]]]
         { [/FI filter] [/PID processid | /IM imagename] } [/T] [/F]

Description:
    This tool is used to terminate tasks by process id (PID) or image name.

Parameter List:
    /S    system           Specifies the remote system to connect to.

    /U    [domain\]user    Specifies the user context under which the
                           command should execute.

    /P    [password]       Specifies the password for the given user
                           context. Prompts for input if omitted.

    /FI   filter           Applies a filter to select a set of tasks.
                           Allows "*" to be used. ex. imagename eq acme*

    /PID  processid        Specifies the PID of the process to be terminated.
                           Use TaskList to get the PID.

    /IM   imagename        Specifies the image name of the process
                           to be terminated. Wildcard '*' can be used
                           to specify all tasks or image names.

    /T                     Terminates the specified process and any
                           child processes which were started by it.

    /F                     Specifies to forcefully terminate the process(es).

    /?                     Displays this help message.

Filters:
    Filter Name   Valid Operators           Valid Value(s)
    -----------   ---------------           -------------------------
    STATUS        eq, ne                    RUNNING |
                                            NOT RESPONDING | UNKNOWN
    IMAGENAME     eq, ne                    Image name
    PID           eq, ne, gt, lt, ge, le    PID value
    SESSION       eq, ne, gt, lt, ge, le    Session number.
    CPUTIME       eq, ne, gt, lt, ge, le    CPU time in the format
                                            of hh:mm:ss.
                                            hh - hours,
                                            mm - minutes, ss - seconds
    MEMUSAGE      eq, ne, gt, lt, ge, le    Memory usage in KB
    USERNAME      eq, ne                    User name in [domain\]user
                                            format
    MODULES       eq, ne                    DLL name
    SERVICES      eq, ne                    Service name
    WINDOWTITLE   eq, ne                    Window title

    NOTE
    ----
    1) Wildcard '*' for /IM switch is accepted only when a filter is applied.
    2) Termination of remote processes will always be done forcefully (/F).
    3) "WINDOWTITLE" and "STATUS" filters are not considered when a remote
       machine is specified.

Examples:
    TASKKILL /IM notepad.exe
    TASKKILL /PID 1230 /PID 1241 /PID 1253 /T
    TASKKILL /F /IM cmd.exe /T
    TASKKILL /F /FI "PID ge 1000" /FI "WINDOWTITLE ne untitle*"
    TASKKILL /F /FI "USERNAME eq NT AUTHORITY\SYSTEM" /IM notepad.exe
    TASKKILL /S system /U domain\username /FI "USERNAME ne NT*" /IM *
    TASKKILL /S system /U username /P password /FI "IMAGENAME eq note*"
```

See also:

### Tasklist

```bat
TASKLIST [/S system [/U username [/P [password]]]]
         [/M [module] | /SVC | /V] [/FI filter] [/FO format] [/NH]

Description:
    This tool displays a list of currently running processes on
    either a local or remote machine.

Parameter List:
   /S     system           Specifies the remote system to connect to.

   /U     [domain\]user    Specifies the user context under which
                           the command should execute.

   /P     [password]       Specifies the password for the given
                           user context. Prompts for input if omitted.

   /M     [module]         Lists all tasks currently using the given
                           exe/dll name. If the module name is not
                           specified all loaded modules are displayed.

   /SVC                    Displays services hosted in each process.

   /APPS                   Displays Store Apps and their associated processes.

   /V                      Displays verbose task information.

   /FI    filter           Displays a set of tasks that match a
                           given criteria specified by the filter.

   /FO    format           Specifies the output format.
                           Valid values: "TABLE", "LIST", "CSV".

   /NH                     Specifies that the "Column Header" should
                           not be displayed in the output.
                           Valid only for "TABLE" and "CSV" formats.

   /?                      Displays this help message.

Filters:
    Filter Name     Valid Operators           Valid Value(s)
    -----------     ---------------           --------------------------
    STATUS          eq, ne                    RUNNING | SUSPENDED
                                              NOT RESPONDING | UNKNOWN
    IMAGENAME       eq, ne                    Image name
    PID             eq, ne, gt, lt, ge, le    PID value
    SESSION         eq, ne, gt, lt, ge, le    Session number
    SESSIONNAME     eq, ne                    Session name
    CPUTIME         eq, ne, gt, lt, ge, le    CPU time in the format
                                              of hh:mm:ss.
                                              hh - hours,
                                              mm - minutes, ss - seconds
    MEMUSAGE        eq, ne, gt, lt, ge, le    Memory usage in KB
    USERNAME        eq, ne                    User name in [domain\]user
                                              format
    SERVICES        eq, ne                    Service name
    WINDOWTITLE     eq, ne                    Window title
    MODULES         eq, ne                    DLL name

NOTE: "WINDOWTITLE" and "STATUS" filters are not supported when querying
      a remote machine.

Examples:
    TASKLIST
    TASKLIST /M
    TASKLIST /V /FO CSV
    TASKLIST /SVC /FO LIST
    TASKLIST /APPS /FI "STATUS eq RUNNING"
    TASKLIST /M wbem*
    TASKLIST /S system /FO LIST
    TASKLIST /S system /U domain\username /FO CSV /NH
    TASKLIST /S system /U username /P password /FO TABLE /NH
    TASKLIST /FI "USERNAME ne NT AUTHORITY\SYSTEM" /FI "STATUS eq running"
```

### RunDll and its command

Can be run in AHK - from Help on RUn

If Target contains any commas, they must be escaped as shown three times in the following example:

        Run rundll32.exe shell32.dll`,Control_RunDLL desk.cpl`,`, 3  ; Opens Control Panel > Display Properties > Settings

When running a program via ComSpec (cmd.exe) -- perhaps because you need to redirect the program's input or output -- if the path or name of the executable contains spaces, the entire string should be enclosed in an outer pair of quotes. In the following example, the outer quotes are shown in red and all the inner quotes are shown in black:

        Run %ComSpec% /c ""C:\My Utility.exe" "param 1" "second param" >"C:\My File.txt""

If Target cannot be launched, an error window is displayed and the current thread is exited, unless the string UseErrorLevel is included in the third parameter or the error is caught by a Try/Catch statement.

Performance may be slightly improved if Target is an exact path, e.g. Run, C:\Windows\Notepad.exe "C:\My Documents\Test.txt" rather than Run, C:\My Documents\Test.txt.

Special CLSID folders may be opened via Run. For example:

        Run ::{20d04fe0-3aea-1069-a2d8-08002b30309d}  ; Opens the "My Computer" folder.
        Run ::{645ff040-5081-101b-9f08-00aa002f954e}  ; Opens the Recycle Bin.



| Function                                                              | Rundll32 command                                                                              |
| --------------------------------------------------------------------- | --------------------------------------------------------------------------------------------- |
| About Windows                                                         | Rundll32.exe shell32.dll,ShellAbout                                                           |
| Add Network Location Wizard                                           | Rundll32 %SystemRoot%\\system32\\shwebsvc.dll,AddNetPlaceRunDll                               |
| Add Printer Wizard                                                    | Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL AddPrinter                                    |
| Add Standard TCP/IP Printer Port Wizard                               | Rundll32.exe tcpmonui.dll,LocalAddPortUI                                                      |
| Control Panel                                                         | Rundll32.exe shell32.dll,Control_RunDLL                                                       |
| Date and Time                                                         | Rundll32.exe shell32.dll,Control_RunDLL timedate.cpl                                          |
| Date and Time - Additional Clocks tab                                 | Rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,1                                       |
| Desktop Icon Settings                                                 | Rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,0                                           |
| Device Installation Settings                                          | Rundll32.exe %SystemRoot%\\System32\\newdev.dll,DeviceInternetSettingUi                       |
| Device Manager                                                        | Rundll32.exe devmgr.dll DeviceManager_Execute                                                 |
| Display Settings                                                      | Rundll32.exe shell32.dll,Control_RunDLL desk.cpl                                              |
| Ease of Access Center                                                 | Rundll32.exe shell32.dll,Control_RunDLL access.cpl                                            |
| Environment Variables                                                 | Rundll32.exe sysdm.cpl,EditEnvironmentVariables                                               |
| File Explorer Options - General tab                                   | Rundll32.exe shell32.dll,Options_RunDLL 0                                                     |
| File Explorer Options - Search tab                                    | Rundll32.exe shell32.dll,Options_RunDLL 2                                                     |
| File Explorer Options - View tab                                      | Rundll32.exe shell32.dll,Options_RunDLL 7                                                     |
| Fonts folder                                                          | Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL FontsFolder                                   |
| Forgotten Password Wizard                                             | Rundll32.exe keymgr.dll,PRShowSaveWizardExW                                                   |
| Game Controllers                                                      | Rundll32.exe shell32.dll,Control_RunDLL joy.cpl                                               |
| Hibernate or Sleep                                                    | Rundll32.exe powrprof.dll,SetSuspendState                                                     |
| Indexing Options                                                      | Rundll32.exe shell32.dll,Control_RunDLL srchadmin.dll                                         |
| Infared                                                               | Rundll32.exe shell32.dll,Control_RunDLL irprops.cpl                                           |
| Internet Explorer - delete all browsing history                       | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 255                                           |
| Internet Explorer - delete all browsing history and add-ons history   | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 4351                                          |
| Internet Explorer - delete cookies and website data                   | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 2                                             |
| Internet Explorer - delete download history                           | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 16384                                         |
| Internet Explorer - delete form data                                  | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 16                                            |
| Internet Explorer - delete history                                    | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 1                                             |
| Internet Explorer - delete passwords                                  | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 32                                            |
| Internet Explorer - delete temporary Internet files and website files | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 8                                             |
| Internet Explorer - Organize Favorites                                | Rundll32.exe shdocvw.dll,DoOrganizeFavDlg                                                     |
| Internet Properties - General tab                                     | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl                                           |
| Internet Properties - Security tab                                    | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,1                                        |
| Internet Properties - Privacy tab                                     | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,2                                        |
| Internet Properties - Content tab                                     | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,3                                        |
| Internet Properties - Connections tab                                 | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,4                                        |
| Internet Properties - Programs tab                                    | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,5                                        |
| Internet Properties - Advanced tab                                    | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,6                                        |
| Keyboard Properties                                                   | Rundll32.exe shell32.dll,Control_RunDLL main.cpl @1                                           |
| Lock PC                                                               | Rundll32.exe user32.dll,LockWorkStation                                                       |
| Map Network Drive wizard                                              | Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL Connect                                       |
| Mouse Button swap left and right button function                      | Rundll32.exe user32.dll,SwapMouseButton                                                       |
| Mouse Properties - Buttons tab                                        | Rundll32.exe shell32.dll,Control_RunDLL main.cpl                                              |
| Mouse Properties - Pointers tab                                       | Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,1                                           |
| Mouse Properties - Pointer Options tab                                | Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,2                                           |
| Mouse Properties - Wheel tab                                          | Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,3                                           |
| Mouse Properties - Hardware tab                                       | Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,4                                           |
| Network Connections                                                   | Rundll32.exe shell32.dll,Control_RunDLL ncpa.cpl                                              |
| ODBC Data Source Administrator                                        | Rundll32.exe shell32.dll,Control_RunDLL odbccp32.cpl                                          |
| Offline Files (General tab)                                           | Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,0                                          |
| Offline Files (Disk Usage tab)                                        | Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,1                                          |
| Offline Files (Encryption tab)                                        | Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,2                                          |
| Offline Files (Network tab)                                           | Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,3                                          |
| Pen and Touch                                                         | Rundll32.exe shell32.dll,Control_RunDLL tabletpc.cpl                                          |
| Personalization - Background Settings                                 | Rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,2                                           |
| Power Options                                                         | Rundll32.exe shell32.dll,Control_RunDLL powercfg.cpl                                          |
| Printer User Interface                                                | Rundll32.exe Printui.dll,PrintUIEntry /?                                                      |
| Printers folder                                                       | Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL PrintersFolder                                |
| Process idle tasks                                                    | Rundll32.exe advapi32.dll,ProcessIdleTasks                                                    |
| Programs and Features                                                 | Rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,0                                         |
| Region - Formats tab                                                  | Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,0                                           |
| Region - Location tab                                                 | Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,1                                           |
| Region - Administrative tab                                           | Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,2                                           |
| Safely Remove Hardware                                                | Rundll32.exe shell32.dll,Control_RunDLL HotPlug.dll                                           |
| Screen Saver Settings                                                 | Rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,1                                           |
| Security and Maintenance                                              | Rundll32.exe shell32.dll,Control_RunDLL wscui.cpl                                             |
| Set Program Access and Computer Defaults                              | Rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,3                                         |
| Set Up a Network wizard                                               | Rundll32.exe shell32.dll,Control_RunDLL NetSetup.cpl                                          |
| Sleep or Hibernate                                                    | Rundll32.exe powrprof.dll,SetSuspendState                                                     |
| Sound - Playback tab                                                  | Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,0                                          |
| Sound - Recording tab                                                 | Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,1                                          |
| Sound - Sounds tab                                                    | Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,2                                          |
| Sound - Communications tab                                            | Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,3                                          |
| Speech Properties - Text to Speech tab                                | Rundll32.exe shell32.dll,Control_RunDLL %SystemRoot%\\System32\\Speech\\SpeechUX\\sapi.cpl,,1 |
| Start Settings                                                        | Rundll32.exe shell32.dll,Options_RunDLL 3                                                     |
| Stored User Names and Passwords                                       | Rundll32.exe keymgr.dll,KRShowKeyMgr                                                          |
| System Properties - Computer Name tab                                 | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,1                                          |
| System Properties - Hardware tab                                      | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,2                                          |
| System Properties - Advanced tab                                      | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,3                                          |
| System Properties - System Protection tab                             | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,4                                          |
| System Properties - Remote tab                                        | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,5                                          |
| Taskbar Settings                                                      | Rundll32.exe shell32.dll,Options_RunDLL 1                                                     |
| Text Services and Input Languages                                     | Rundll32.exe Shell32.dll,Control_RunDLL input.dll,,{C07337D3-DB2C-4D0B-9A93-B722A6C106E2}     |
| User Accounts                                                         | Rundll32.exe shell32.dll,Control_RunDLL nusrmgr.cpl                                           |
| Windows Features                                                      | Rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,2                                         |
| Windows Firewall                                                      | Rundll32.exe shell32.dll,Control_RunDLL firewall.cpl                                          |
| Windows To Go Startup Options                                         | Rundll32.exe pwlauncher.dll,ShowPortableWorkspaceLauncherConfigurationUX                      |

### Shell:: Commands

| Shell Command                         | Opens                                                                                    |
| ------------------------------------- | ---------------------------------------------------------------------------------------- |
| shell:3D Objects                      | %UserProfile%\\3D Objects                                                                |
| shell:AccountPictures                 | %AppData%\\Microsoft\\Windows\\AccountPictures                                           |
| shell:AddNewProgramsFolder            | Control Panel\\All Control Panel Items\\Get Programs                                     |
| shell:Administrative Tools            | %AppData%\\Microsoft\\Windows\\Start Menu\\Programs\\Administrative Tools                |
| shell:AppData                         | %AppData%                                                                                |
| shell:Application Shortcuts           | %LocalAppData%\\Microsoft\\Windows\\Application Shortcuts                                |
| shell:AppsFolder                      | Applications                                                                             |
| shell:AppUpdatesFolder                | Installed Updates                                                                        |
| shell:Cache                           | %LocalAppData%\\Microsoft\\Windows\\INetCache                                            |
| shell:Camera Roll                     | %UserProfile%\\Pictures\\Camera Roll                                                     |
| shell:CD Burning                      | %LocalAppData%\\Microsoft\\Windows\\Burn\\Burn                                           |
| shell:ChangeRemoveProgramsFolder      | Control Panel\\All Control Panel Items\\Programs and Features                            |
| shell:Common Administrative Tools     | %ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Administrative Tools            |
| shell:Common AppData                  | %ProgramData%                                                                            |
| shell:Common Desktop                  | %Public%\\Desktop                                                                        |
| shell:Common Documents                | %Public%\\Documents                                                                      |
| shell:CommonDownloads                 | %Public%\\Downloads                                                                      |
| shell:CommonMusic                     | %Public%\\Music                                                                          |
| shell:CommonPictures                  | %Public%\\Pictures                                                                       |
| shell:Common Programs                 | %ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs                                  |
| shell:CommonRingtones                 | %ProgramData%\\Microsoft\\Windows\\Ringtones                                             |
| shell:Common Start Menu               | %ProgramData%\\Microsoft\\Windows\\Start Menu                                            |
| shell:Common Startup                  | %ProgramData%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup                         |
| shell:Common Templates                | %ProgramData%\\Microsoft\\Windows\\Templates                                             |
| shell:CommonVideo                     | %Public%\\Videos                                                                         |
| shell:ConflictFolder                  | Control Panel\\All Control Panel Items\\Sync Center\\Conflicts                           |
| shell:ConnectionsFolder               | Control Panel\\All Control Panel Items\\Network Connections                              |
| shell:Contacts                        | %UserProfile%\\Contacts                                                                  |
| shell:ControlPanelFolder              | Control Panel\\All Control Panel Items                                                   |
| shell:Cookies                         | %LocalAppData%\\Microsoft\\Windows\\INetCookies                                          |
| shell:Cookies\\Low                    | %LocalAppData%\\Microsoft\\Windows\\INetCookies\\Low                                     |
| shell:CredentialManager               | %AppData%\\Microsoft\\Credentials                                                        |
| shell:CryptoKeys                      | %AppData%\\Microsoft\\Crypto                                                             |
| shell:desktop                         | Desktop                                                                                  |
| shell:device Metadata Store           | %ProgramData%\\Microsoft\\Windows\\DeviceMetadataStore                                   |
| shell:documentsLibrary                | Libraries\\Documents                                                                     |
| shell:downloads                       | %UserProfile%\\Downloads                                                                 |
| shell:dpapiKeys                       | %AppData%\\Microsoft\\Protect                                                            |
| shell:Favorites                       | %UserProfile%\\Favorites                                                                 |
| shell:Fonts                           | %WinDir%\\Fonts                                                                          |
| shell:Games (removed in version 1803) | Games                                                                                    |
| shell:GameTasks                       | %LocalAppData%\\Microsoft\\Windows\\GameExplorer                                         |
| shell:History                         | %LocalAppData%\\Microsoft\\Windows\\History                                              |
| shell:HomeGroupCurrentUserFolder      | Homegroup\\(user-name)                                                                   |
| shell:HomeGroupFolder                 | Homegroup                                                                                |
| shell:ImplicitAppShortcuts            | %AppData%\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned\\ImplicitAppShortcuts |
| shell:InternetFolder                  | Internet Explorer                                                                        |
| shell:Libraries                       | Libraries                                                                                |
| shell:Links                           | %UserProfile%\\Links                                                                     |
| shell:Local AppData                   | %LocalAppData%                                                                           |
| shell:LocalAppDataLow                 | %UserProfile%\\AppData\\LocalLow                                                         |
| shell:MusicLibrary                    | Libraries\\Music                                                                         |
| shell:MyComputerFolder                | This PC                                                                                  |
| shell:My Music                        | %UserProfile%\\Music                                                                     |
| shell:My Pictures                     | %UserProfile%\\Pictures                                                                  |
| shell:My Video                        | %UserProfile%\\Videos                                                                    |
| shell:NetHood                         | %AppData%\\Microsoft\\Windows\\Network Shortcuts                                         |
| shell:NetworkPlacesFolder             | Network                                                                                  |
| shell:OneDrive                        | OneDrive                                                                                 |
| shell:OneDriveCameraRoll              | %UserProfile%\\OneDrive\\Pictures\\Camera Roll                                           |
| shell:OneDriveDocuments               | %UserProfile%\\OneDrive\\Documents                                                       |
| shell:OneDriveMusic                   | %UserProfile%\\OneDrive\\Music                                                           |
| shell:OneDrivePictures                | %UserProfile%\\OneDrive\\Pictures                                                        |
| shell:Personal                        | %UserProfile%\\Documents                                                                 |
| shell:PicturesLibrary                 | Libraries\\Pictures                                                                      |
| shell:PrintersFolder                  | All Control Panel Items\\Printers                                                        |
| shell:PrintHood                       | %AppData%\\Microsoft\\Windows\\Printer Shortcuts                                         |
| shell:Profile                         | %UserProfile%                                                                            |
| shell:ProgramFiles                    | %ProgramFiles%                                                                           |
| shell:ProgramFilesCommon              | %ProgramFiles%\\Common Files                                                             |
| shell:ProgramFilesCommonX64           | %ProgramFiles%\\Common Files (64-bit Windows only)                                       |
| shell:ProgramFilesCommonX86           | %ProgramFiles(x86)%\\Common Files (64-bit Windows only)                                  |
| shell:ProgramFilesX64                 | %ProgramFiles% (64-bit Windows only)                                                     |
| shell:ProgramFilesX86                 | %ProgramFiles(x86)% (64-bit Windows only)                                                |
| shell:Programs                        | %AppData%\\Microsoft\\Windows\\Start Menu\\Programs                                      |
| shell:Public                          | %Public%                                                                                 |
| shell:PublicAccountPictures           | %Public%\\AccountPictures                                                                |
| shell:PublicGameTasks                 | %ProgramData%\\Microsoft\\Windows\\GameExplorer                                          |
| shell:PublicLibraries                 | %Public%\\Libraries                                                                      |
| shell:Quick Launch                    | %AppData%\\Microsoft\\Internet Explorer\\Quick Launch                                    |
| shell:Recent                          | %AppData%\\Microsoft\\Windows\\Recent                                                    |
| shell:RecordedTVLibrary               | Libraries\\Recorded TV                                                                   |
| shell:RecycleBinFolder                | Recycle Bin                                                                              |
| shell:ResourceDir                     | %WinDir%\\Resources                                                                      |
| shell:Ringtones                       | %ProgramData%\\Microsoft\\Windows\\Ringtones                                             |
| shell:Roamed Tile Images              | %LocalAppData%\\Microsoft\\Windows\\RoamedTileImages                                     |
| shell:Roaming Tiles                   | %AppData%\\Microsoft\\Windows\\RoamingTiles                                              |
| shell:SavedGames                      | %UserProfile%\\Saved Games                                                               |
| shell:Screenshots                     | %UserProfile%\\Pictures\\Screenshots                                                     |
| shell:Searches                        | %UserProfile%\\Searches                                                                  |
| shell:SearchHistoryFolder             | %LocalAppData%\\Microsoft\\Windows\\ConnectedSearch\\History                             |
| shell:SearchHomeFolder                | search-ms:                                                                               |
| shell:SearchTemplatesFolder           | %LocalAppData%\\Microsoft\\Windows\\ConnectedSearch\\Templates                           |
| shell:SendTo                          | %AppData%\\Microsoft\\Windows\\SendTo                                                    |
| shell:Start Menu                      | %AppData%\\Microsoft\\Windows\\Start Menu                                                |
| shell:StartMenuAllPrograms            | StartMenuAllPrograms                                                                     |
| shell:Startup                         | %AppData%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup                             |
| shell:SyncCenterFolder                | Control Panel\\All Control Panel Items\\Sync Center                                      |
| shell:SyncResultsFolder               | Control Panel\\All Control Panel Items\\Sync Center\\Sync Results                        |
| shell:SyncSetupFolder                 | Control Panel\\All Control Panel Items\\Sync Center\\Sync Setup                          |
| shell:System                          | %WinDir%\\System32                                                                       |
| shell:SystemCertificates              | %AppData%\\Microsoft\\SystemCertificates                                                 |
| shell:SystemX86                       | %WinDir%\\SysWOW64                                                                       |
| shell:Templates                       | %AppData%\\Microsoft\\Windows\\Templates                                                 |
| shell:ThisPCDesktopFolder             | Desktop                                                                                  |
| shell:UsersFilesFolder                | %UserProfile%                                                                            |
| shell:User Pinned                     | %AppData%\\Microsoft\\Internet Explorer\\Quick Launch\\User Pinned                       |
| shell:UserProfiles                    | %HomeDrive%\\Users                                                                       |
| shell:UserProgramFiles                | %LocalAppData%\\Programs                                                                 |
| shell:UserProgramFilesCommon          | %LocalAppData%\\Programs\\Common                                                         |
| shell:UsersLibrariesFolder            | Libraries                                                                                |
| shell:VideosLibrary                   | Libraries\\Videos                                                                        |
| shell:Windows                         | %WinDir%                                                                                 |

### RunDll Commands

List  of Rundll32 Commands in Windows 10                                                                                 |
| Function                                                              | Rundll32 command                                                                          |
| --------------------------------------------------------------------- | ----------------------------------------------------------------------------------------- |
| About Windows                                                         | Rundll32.exe shell32.dll,ShellAbout                                                       |
| Add Network Location Wizard                                           | Rundll32 %SystemRoot%\system32\shwebsvc.dll,AddNetPlaceRunDll                             |
| Add Printer Wizard                                                    | Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL AddPrinter                                |
| Add Standard TCP/IP Printer Port Wizard                               | Rundll32.exe tcpmonui.dll,LocalAddPortUI                                                  |
| Control Panel                                                         | Rundll32.exe shell32.dll,Control_RunDLL                                                   |
| Date and Time                                                         | Rundll32.exe shell32.dll,Control_RunDLL timedate.cpl                                      |
| Date and Time - Additional Clocks tab                                 | Rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,1                                   |
| Desktop Icon Settings                                                 | Rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,0                                       |
| Device Installation Settings                                          | Rundll32.exe %SystemRoot%\System32\newdev.dll,DeviceInternetSettingUi                     |
| Device Manager                                                        | Rundll32.exe devmgr.dll DeviceManager_Execute                                             |
| Display Settings                                                      | Rundll32.exe shell32.dll,Control_RunDLL desk.cpl                                          |
| Ease of Access Center                                                 | Rundll32.exe shell32.dll,Control_RunDLL access.cpl                                        |
| Environment Variables                                                 | Rundll32.exe sysdm.cpl,EditEnvironmentVariables                                           |
| File Explorer Options - General tab                                   | Rundll32.exe shell32.dll,Options_RunDLL 0                                                 |
| File Explorer Options - Search tab                                    | Rundll32.exe shell32.dll,Options_RunDLL 2                                                 |
| File Explorer Options - View tab                                      | Rundll32.exe shell32.dll,Options_RunDLL 7                                                 |
| Fonts folder                                                          | Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL FontsFolder                               |
| Forgotten Password Wizard                                             | Rundll32.exe keymgr.dll,PRShowSaveWizardExW                                               |
| Game Controllers                                                      | Rundll32.exe shell32.dll,Control_RunDLL joy.cpl                                           |
| Hibernate or Sleep                                                    | Rundll32.exe powrprof.dll,SetSuspendState                                                 |
| Indexing Options                                                      | Rundll32.exe shell32.dll,Control_RunDLL srchadmin.dll                                     |
| Infared                                                               | Rundll32.exe shell32.dll,Control_RunDLL irprops.cpl                                       |
| Internet Explorer - delete all browsing history                       | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 255                                       |
| Internet Explorer - delete all browsing history and add-ons history   | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 4351                                      |
| Internet Explorer - delete cookies and website data                   | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 2                                         |
| Internet Explorer - delete download history                           | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 16384                                     |
| Internet Explorer - delete form data                                  | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 16                                        |
| Internet Explorer - delete history                                    | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 1                                         |
| Internet Explorer - delete passwords                                  | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 32                                        |
| Internet Explorer - delete temporary Internet files and website files | Rundll32.exe InetCpl.cpl,ClearMyTracksByProcess 8                                         |
| Internet Explorer - Organize Favorites                                | Rundll32.exe shdocvw.dll,DoOrganizeFavDlg                                                 |
| Internet Properties - General tab                                     | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl                                       |
| Internet Properties - Security tab                                    | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,1                                    |
| Internet Properties - Privacy tab                                     | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,2                                    |
| Internet Properties - Content tab                                     | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,3                                    |
| Internet Properties - Connections tab                                 | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,4                                    |
| Internet Properties - Programs tab                                    | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,5                                    |
| Internet Properties - Advanced tab                                    | Rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,6                                    |
| Keyboard Properties                                                   | Rundll32.exe shell32.dll,Control_RunDLL main.cpl @1                                       |
| Lock PC                                                               | Rundll32.exe user32.dll,LockWorkStation                                                   |
| Map Network Drive wizard                                              | Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL Connect                                   |
| Mouse Button swap left and right button function                      | Rundll32.exe user32.dll,SwapMouseButton                                                   |
| Mouse Properties - Buttons tab                                        | Rundll32.exe shell32.dll,Control_RunDLL main.cpl                                          |
| Mouse Properties - Pointers tab                                       | Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,1                                       |
| Mouse Properties - Pointer Options tab                                | Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,2                                       |
| Mouse Properties - Wheel tab                                          | Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,3                                       |
| Mouse Properties - Hardware tab                                       | Rundll32.exe shell32.dll,Control_RunDLL main.cpl,,4                                       |
| Network Connections                                                   | Rundll32.exe shell32.dll,Control_RunDLL ncpa.cpl                                          |
| ODBC Data Source Administrator                                        | Rundll32.exe shell32.dll,Control_RunDLL odbccp32.cpl                                      |
| Offline Files (General tab)                                           | Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,0                                      |
| Offline Files (Disk Usage tab)                                        | Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,1                                      |
| Offline Files (Encryption tab)                                        | Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,2                                      |
| Offline Files (Network tab)                                           | Rundll32.exe Shell32.dll,Control_RunDLL cscui.dll,,3                                      |
| Pen and Touch                                                         | Rundll32.exe shell32.dll,Control_RunDLL tabletpc.cpl                                      |
| Personalization - Background Settings                                 | Rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,2                                       |
| Power Options                                                         | Rundll32.exe shell32.dll,Control_RunDLL powercfg.cpl                                      |
| Printer User Interface                                                | Rundll32.exe Printui.dll,PrintUIEntry /?                                                  |
| Printers folder                                                       | Rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL PrintersFolder                            |
| Process idle tasks                                                    | Rundll32.exe advapi32.dll,ProcessIdleTasks                                                |
| Programs and Features                                                 | Rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,0                                     |
| Region - Formats tab                                                  | Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,0                                       |
| Region - Location tab                                                 | Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,1                                       |
| Region - Administrative tab                                           | Rundll32.exe shell32.dll,Control_RunDLL Intl.cpl,,2                                       |
| Safely Remove Hardware                                                | Rundll32.exe shell32.dll,Control_RunDLL HotPlug.dll                                       |
| Screen Saver Settings                                                 | Rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,1                                       |
| Security and Maintenance                                              | Rundll32.exe shell32.dll,Control_RunDLL wscui.cpl                                         |
| Set Program Access and Computer Defaults                              | Rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,3                                     |
| Set Up a Network wizard                                               | Rundll32.exe shell32.dll,Control_RunDLL NetSetup.cpl                                      |
| Sleep or Hibernate                                                    | Rundll32.exe powrprof.dll,SetSuspendState                                                 |
| Sound - Playback tab                                                  | Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,0                                      |
| Sound - Recording tab                                                 | Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,1                                      |
| Sound - Sounds tab                                                    | Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,2                                      |
| Sound - Communications tab                                            | Rundll32.exe shell32.dll,Control_RunDLL Mmsys.cpl,,3                                      |
| Speech Properties - Text to Speech tab                                | Rundll32.exe shell32.dll,Control_RunDLL %SystemRoot%\System32\Speech\SpeechUX\sapi.cpl,,1 |
| Start Settings                                                        | Rundll32.exe shell32.dll,Options_RunDLL 3                                                 |
| Stored User Names and Passwords                                       | Rundll32.exe keymgr.dll,KRShowKeyMgr                                                      |
| System Properties - Computer Name tab                                 | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,1                                      |
| System Properties - Hardware tab                                      | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,2                                      |
| System Properties - Advanced tab                                      | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,3                                      |
| System Properties - System Protection tab                             | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,4                                      |
| System Properties - Remote tab                                        | Rundll32.exe shell32.dll,Control_RunDLL Sysdm.cpl,,5                                      |
| Taskbar Settings                                                      | Rundll32.exe shell32.dll,Options_RunDLL 1                                                 |
| Text Services and Input Languages                                     | Rundll32.exe Shell32.dll,Control_RunDLL input.dll,,{C07337D3-DB2C-4D0B-9A93-B722A6C106E2} |
| User Accounts                                                         | Rundll32.exe shell32.dll,Control_RunDLL nusrmgr.cpl                                       |
| Windows Features                                                      | Rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,2                                     |
| Windows Firewall                                                      | Rundll32.exe shell32.dll,Control_RunDLL firewall.cpl                                      |
| Windows To Go Startup Options                                         | Rundll32.exe pwlauncher.dll,ShowPortableWorkspaceLauncherConfigurationUX                  |

### MMC Syntax


| Admin Snap-in                             | Command                        |
| ----------------------------------------- | ------------------------------ |
| Services Management                       | Services.msc                   |
| Performance Monitor                       | PerfMon.msc                    |
| Task Scheduler                            | TaskSchd.msc                   |
| Server Roles, Features                    | ServerManager.msc              |
| Component Services                        | Comexp.msc                     |
| Computer Management                       | Compmgmt.msc                   |
|  Win Mangement Instrum         | WmiMgmt.msc                    |
| Notifications/Start menu/pol           | DevModeRunAsUserConfig.msc     |
| SQL Server configuration Man          | SQLServerManager11.msc         |
| Event Viewer                              | Eventvwr.msc                   |
| AD Domains and Trusts                     | Domain.msc                     |
| AD Sites and Services                     | DSsite.msc                     |
| ADSI Edit                                 | ADSIedit.msc                   |
| **_Disc, File_**                                |                                |
| Win Local Backup                      | WLBadmin.msc                   |
| Disk Manager                              | DiskMgmt.msc                   |
| Failover cluster Manager                  | Cluadmin.exe                   |
| Storage Mgmt                              | StorageMgmt.msc                |
| Win Server Backup (Local+Rem)      | WBadmin.msc                    |
| Disk Defragmenter                         | Defrag.exe (formerly Dfrg.msc) |
| Distributed File Service Mgmt             | DFSmgmt.msc                    |
| Shared Folders open files                 | FSmgmt.msc                     |
| File Server Resource manager              | FSRM.msc                       |
| **_Hardware_**                                  |                                |
| Device Manager                            | Devmgmt.msc                    |
| DNS Manager                               | DNSmgmt.msc                    |
| NAP client configuration                  | NapCLCfg                       |
| Quality of Service Control Man    | ACSsnap.msc                    |
| Telephony Management                      | TAPImgmt.msc                   |
| **_Policy_**                                    |                                |
| Local Group Policy Editor                 | GPedit.msc                     |
| Group Policy Management                   | GPmc.msc                       |
| Local Security Settings Manager           | SecPol.msc                     |
| Group Policy Management Editor            | GPme.msc                       |
| Group Policy Starter GPO Editor           | GPTedit.msc                    |
| Resultant Set of Policy                   | RSOP.msc                       |
| Print Management                          | PrintManagement.msc            |
| **_Remote Access_**                             |                                |
| Win Firewall                          | WF.msc                         |
| Teminal Services RDP                      | MSTSC                          |
| Remote Desktop                            | TSmmc.msc                      |
| Terminal Server Manager                   | TSadmin.exe                    |
| Teminal Services RDP to Console           | MSTSC /v:[server] /console     |
| **_Security_**                                  |                                |
| Certificate Templates                     | Certtmpl.msc                   |
| AD Users and Computers                    | DSA.msc                        |
| Trusted Platform Module                   | TPM.msc                        |
| Embedded Lockdown Manager                 | EmbeddedLockdown.msc           |
| Local Users and Groups Manager            | LUsrMgr.msc                    |
| Certificates Management Cur user    | Certmgr.msc                    |
| Certificates Management Local mach   | Certlm.msc                     |
| Authorization manager                     | AZman.msc                      |
| Certification Authority Management        | Certsrv.msc                    |
|                                           |                                |
| From <https://ss64.com/nt/syntax-mmc.html |                                |

### Control Panel

!!!Note To create a shortcut:
    1) Right click or press and hold on your desktop, click/tap on New, and click/tap on Shortcut.

    2) Copy the command you want from the table below as the "location", and click/tap on Next.

    3) Type a name you want for this shortcut, and click/tap on Finish.

    4) If you like, you can Pin to Start, Pin to taskbar, add to All apps, add to Quick Launch, assign a keyboard shortcut to, or move this shortcut to where you like for easy use.

(Open Control Panel in last used view)  `%windir%\System32\control.exe`

OR

(Always Open Control Panel in category view) `%windir%\explorer.exe shell:::{26EE0668-A00A-44D7-9371-BEB064C98683}`

OR

(Always Open Control Panel in icons view) - x1`%windir%\explorer.exe shell:::{21EC2020-3AEA-1069-A2DD-08002B30309D}`




| Control Panel Item                | Commands                                                                                             |
| --------------------------------- | ---------------------------------------------------------------------------------------------------- |
| Add a Device wizard               | %windir%\\System32\\DevicePairingWizard.exe                                                          |
| Add Hardware wizard               | %windir%\\System32\\hdwwiz.exe                                                                       |
| Add a Printer wizard              | rundll32.exe shell32.dll,SHHelpShortcuts_RunDLL AddPrinter                                           |
| Additional Clocks                 | rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,1                                              |
| Administrative Tools              | control /name Microsoft.AdministrativeTools                                                          |
|                                   |                                                                                                      |
|                                   | control admintools                                                                                   |
| AutoPlay                          | control /name Microsoft.AutoPlay                                                                     |
| Backup and Restore (Win 7)        | control /name Microsoft.BackupAndRestoreCenter                                                       |
| BitLocker Drive Encryption        | control /name Microsoft.BitLockerDriveEncryption                                                     |
| Color and Appearance              | explorer shell:::{ED834ED6-4B5A-4bfe-8F11-A626DCB6A921} -Microsoft.Personalization\\pageColorization |
| Color Management                  | control /name Microsoft.ColorManagement                                                              |
| Credential Manager                | control /name Microsoft.CredentialManager                                                            |
| Date and Time (Date and Time)     | control /name Microsoft.DateAndTime                                                                  |
|                                   |                                                                                                      |
|                                   | control timedate.cpl                                                                                 |
|                                   |                                                                                                      |
|                                   | control date/time                                                                                    |
|                                   |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,0                                              |
| Date and Time (Additional Clocks) | rundll32.exe shell32.dll,Control_RunDLL timedate.cpl,,1                                              |
| Default Programs                  | control /name Microsoft.DefaultPrograms                                                              |
| Desktop Background                | explorer shell:::{ED834ED6-4B5A-4bfe-8F11-A626DCB6A921} -Microsoft.Personalization\\pageWallpaper    |
| Desktop Icon Settings             | rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,0                                                  |
| Device Manager                    | control /name Microsoft.DeviceManager                                                                |
|                                   |                                                                                                      |
|                                   | control hdwwiz.cpl                                                                                   |
|                                   |                                                                                                      |
|                                   | devmgmt.msc                                                                                          |
| Devices and Printers              | control /name Microsoft.DevicesAndPrinters                                                           |
|                                   |                                                                                                      |
|                                   | control printers                                                                                     |
| Ease of Access Center             | control /name Microsoft.EaseOfAccessCenter                                                           |
|                                   |                                                                                                      |
|                                   | control access.cpl                                                                                   |
| File Explorer Opts (General tab)  | control /name Microsoft.FolderOpts                                                                   |
|                                   |                                                                                                      |
|                                   | control folders                                                                                      |
|                                   |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Options_RunDLL 0                                                            |
| File Explorer Opts (View tab)     | rundll32.exe shell32.dll,Options_RunDLL 7                                                            |
| File Explorer Opts (Search tab)   | rundll32.exe shell32.dll,Options_RunDLL 2                                                            |
| File History                      | control /name Microsoft.FileHistory                                                                  |
| Fonts                             | control /name Microsoft.Fonts                                                                        |
|                                   |                                                                                                      |
|                                   | control fonts                                                                                        |
| Game Controllers                  | control /name Microsoft.GameControllers                                                              |
|                                   |                                                                                                      |
|                                   | control joy.cpl                                                                                      |
| Get Programs                      | control /name Microsoft.GetPrograms                                                                  |
|                                   |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,1                                                |
| HomeGroup                         | control /name Microsoft.HomeGroup                                                                    |
| Indexing Opts                     | control /name Microsoft.IndexingOptions                                                              |
|                                   |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL srchadmin.dll                                                |
| Infrared                          | control /name Microsoft.Infrared                                                                     |
|                                   |                                                                                                      |
|                                   | control irprops.cpl                                                                                  |
|                                   |                                                                                                      |
|                                   | control /name Microsoft.InfraredOptions                                                              |
| Internet Prop (General tab)       | control /name Microsoft.InternetOptions                                                              |
|                                   |                                                                                                      |
|                                   | control inetcpl.cpl                                                                                  |
|                                   |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,0                                               |
| Internet Prop (Security tab)      | rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,1                                               |
| Internet Prop (Privacy tab)       | rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,2                                               |
| Internet Prop (Content tab)       | rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,3                                               |
| Internet Prop (Connections tab)   | rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,4                                               |
| Internet Prop (Programs tab)      | rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,5                                               |
| Internet Prop (Advanced tab)      | rundll32.exe shell32.dll,Control_RunDLL inetcpl.cpl,,6                                               |
| iSCSI Initiator                   | control /name Microsoft.iSCSIInitiator                                                               |
| Keyboard                          | control /name Microsoft.Keyboard                                                                     |
|                                   |                                                                                                      |
|                                   | control keyboard                                                                                     |
| Language                          | control /name Microsoft.Language                                                                     |
| Mouse Prop                        | control /name Microsoft.Mouse                                                                        |
| (Buttons tab 0)                   |                                                                                                      |
|                                   | control main.cpl                                                                                     |
|                                   |                                                                                                      |
|                                   | control mouse                                                                                        |
|                                   |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL main.cpl,,0                                                  |
| Mouse Prop                        | control main.cpl,,1                                                                                  |
| (Pointers tab 1)                  |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL main.cpl,,1                                                  |
| Mouse Prop                        | control main.cpl,,2                                                                                  |
| (Pointer Opt tab 2)               |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL main.cpl,,2                                                  |
| Mouse Prop                        | control main.cpl,,3                                                                                  |
| (Wheel tab 3)                     |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL main.cpl,,3                                                  |
| Mouse Prop (Hardware tab 4)       | control main.cpl,,4                                                                                  |
|                                   |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL main.cpl,,4                                                  |
| Network and Sharing Center        | control /name Microsoft.NetworkAndSharingCenter                                                      |
| Network Connections               | control ncpa.cpl                                                                                     |
|                                   |                                                                                                      |
|                                   | control netconnections                                                                               |
| Network Setup Wizard              | control netsetup.cpl                                                                                 |
| Notification Area Icons           | explorer shell:::{05d7b0f4-2121-4eff-bf6b-ed3f69b894d9}                                              |
| ODBC Data Source Administrator    | control odbccp32.cpl                                                                                 |
| Offline Files                     | control /name Microsoft.OfflineFiles                                                                 |
| Perf Opts (Vis Effects)           | %windir%\\system32\\SystemPropertiesPerformance.exe                                                  |
| Perf Opts (DEP)                   | %windir%\\system32\\SystemPropertiesDataExecutionPrevention.exe                                      |
| Personalization                   | explorer shell:::{ED834ED6-4B5A-4bfe-8F11-A626DCB6A921}                                              |
| Phone and Modem                   | control /name Microsoft.PhoneAndModem                                                                |
|                                   |                                                                                                      |
|                                   | control telephon.cpl                                                                                 |
| Power Opts                        | control /name Microsoft.PowerOptions                                                                 |
|                                   |                                                                                                      |
| _Power Opts_                      | control powercfg.cpl                                                                                 |
| - Advanced settings               | control powercfg.cpl,,1                                                                              |
| - Create a Power Plan             | control /name Microsoft.PowerOptions /page pageCreateNewPlan                                         |
| - Edit Plan Settings              | control /name Microsoft.PowerOptions /page pagePlanSettings                                          |
| - System Settings                 | control /name Microsoft.PowerOptions /page pageGlobalSettings                                        |
| Presentation Settings             | %windir%\\system32\\PresentationSettings.exe                                                         |
| Programs and Features             | control /name Microsoft.ProgramsAndFeatures                                                          |
|                                   |                                                                                                      |
|                                   | control appwiz.cpl                                                                                   |
| Recovery                          | control /name Microsoft.Recovery                                                                     |
| Region (Formats tab)              | control /name Microsoft.RegionAndLanguage                                                            |
|                                   |                                                                                                      |
|                                   | control /name Microsoft.RegionalAndLanguageOptions /page /p:"Formats"                                |
|                                   |                                                                                                      |
|                                   | control intl.cpl                                                                                     |
|                                   |                                                                                                      |
|                                   | control international                                                                                |
| Region (Location tab)             | control /name Microsoft.RegionalAndLanguageOptions /page /p:"Location"                               |
| Region (Administrative tab)       | control /name Microsoft.RegionalAndLanguageOptions /page /p:"Administrative"                         |
| RemoteApp and Desktop Connections | control /name Microsoft.RemoteAppAndDesktopConnections                                               |
| Scanners and Cameras              | control /name Microsoft.ScannersAndCameras                                                           |
|                                   |                                                                                                      |
|                                   | control sticpl.cpl                                                                                   |
| Screen Saver Settings             | rundll32.exe shell32.dll,Control_RunDLL desk.cpl,,1                                                  |
| Security and Maintenance          | control /name Microsoft.ActionCenter                                                                 |
|                                   |                                                                                                      |
|                                   | control wscui.cpl                                                                                    |
| Set Associations                  | control /name Microsoft.DefaultPrograms /page pageFileAssoc                                          |
| Set Default Programs              | control /name Microsoft.DefaultPrograms /page pageDefaultProgram                                     |
| Set Program Acc and Defaults      | rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,3                                                |
| Sound (Playback tab)              | control /name Microsoft.Sound                                                                        |
|                                   |                                                                                                      |
|                                   | control mmsys.cpl                                                                                    |
|                                   |                                                                                                      |
|                                   | %windir%\\System32\\rundll32.exe shell32.dll,Control_RunDLL mmsys.cpl,,0                             |
| Sound (Recording tab)             | %windir%\\System32\\rundll32.exe shell32.dll,Control_RunDLL mmsys.cpl,,1                             |
| Sound (Sounds tab)                | %windir%\\System32\\rundll32.exe shell32.dll,Control_RunDLL mmsys.cpl,,2                             |
| Sound (Communications tab)        | %windir%\\System32\\rundll32.exe shell32.dll,Control_RunDLL mmsys.cpl,,3                             |
| Speech Recognition                | control /name Microsoft.SpeechRecognition                                                            |
| Storage Spaces                    | control /name Microsoft.StorageSpaces                                                                |
| Sync Center                       | control /name Microsoft.SyncCenter                                                                   |
| System                            | control /name Microsoft.System                                                                       |
|                                   |                                                                                                      |
|                                   | control sysdm.cpl                                                                                    |
| System Icons                      | explorer shell:::{05d7b0f4-2121-4eff-bf6b-ed3f69b894d9} \\SystemIcons,,0                             |
| System Prop (Computer Name)       | %windir%\\System32\\SystemPropertiesComputerName.exe                                                 |
| System Prop (Hardware)            | %windir%\\System32\\SystemPropertiesHardware.exe                                                     |
| System Prop (Advanced)            | %windir%\\System32\\SystemPropertiesAdvanced.exe                                                     |
| System Prop (System Protection)   | %windir%\\System32\\SystemPropertiesProtection.exe                                                   |
| System Prop (Remote)              | %windir%\\System32\\SystemPropertiesRemote.exe                                                       |
| Tablet PC Settings                | control /name Microsoft.TabletPCSettings                                                             |
| Text to Speech                    | control /name Microsoft.TextToSpeech                                                                 |
| Troubleshooting                   |                                                                                                      |
| User Accounts                     | control /name Microsoft.UserAccounts                                                                 |
|                                   |                                                                                                      |
|                                   | control userpasswords                                                                                |
| User Accounts (netplwiz)          | netplwiz                                                                                             |
|                                   |                                                                                                      |
|                                   | control userpasswords2                                                                               |
| Windows Defender Antivirus        | %ProgramFiles%\\Windows Defender\\MSASCui.exe                                                        |
| Windows Defender Firewall         | control /name Microsoft.WindowsFirewall                                                              |
|                                   |                                                                                                      |
|                                   | control firewall.cpl                                                                                 |
| Windows Features                  | %windir%\\System32\\OptionalFeatures.exe                                                             |
|                                   |                                                                                                      |
|                                   | rundll32.exe shell32.dll,Control_RunDLL appwiz.cpl,,2                                                |
| Windows Mobility Center           | control /name Microsoft.MobilityCenter                                                               |
| Windows To Go                     | %windir%\\System32\\pwcreator.exe                                                                    |
| Work Folders                      | %windir%\\System32\\WorkFolders.exe                                                                  |

*[DEP]: Data Execution Prevention

### Turn off the monitors

```powershell
#PS
Add-Type '[DllImport("user32.dll")] public static extern int SendMessage(int hWnd, int hMsg, int wParam, int lParam);' -Name a -Pas)::SendMessage(-1,0x0112,0xF170,2)
```

```batch
powershell (Add-Type '[DllImport(\"user32.dll\")]^public static extern int SendMessage(int hWnd, int hMsg, int wParam, int lParam);' -Name a -Pas)::SendMessage(-1,0x0112,0xF170,2)
```

Seems to leave a process running though. It doesn't end on its own. May be worth investigating.

### SFC

```bat
SFC /scannow
findstr /c:"[SR]" %windir%\Logs\CBS\CBS.log >%userprofile%\Desktop\sfcdetails.txt && notepad.exe "%userprofile%\Desktop\sfcdetails.txt"
```

### DISM

```bat
Dism /Online /Cleanup-Image /CheckHealth
Dism /Online /Cleanup-Image /ScanHealth
Dism /Online /Cleanup-Image /RestoreHealth
```

### reg

reg is a command line function to edit the registry.  An example from elsewhere in the document.

```batch
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "LaunchTo" /t REG_DWORD /d 1 /f
```

REG Operation [Parameter List]

  Operation =  [ QUERY | ADD | DELETE | COPY | SAVE | LOAD | UNLOAD | RESTORE | COMPARE | EXPORT | IMPORT  | FLAGS ]

Return Code: (Except for REG COMPARE)   0 - Successful, 1 - Failed

For help on a specific operation type:  `REG Operation /?`. Examples:

  REG QUERY /?
  REG ADD /?
  REG DELETE /?
  REG COPY /?
  REG SAVE /?
  REG RESTORE /?
  REG LOAD /?
  REG UNLOAD /?
  REG COMPARE /?
  REG EXPORT /?
  REG IMPORT /?
  REG FLAGS /?

C:\Windows\system32>reg add /?

- REG ADD KeyName [/v ValueName | /ve] [/t Type] [/s Separator] [/d Data] [/f] [/reg:32 | /reg:64]
  - KeyName  [\\Machine\]FullKey
    - Machine  Name of remote machine - omitting defaults to the current machine. Only HKLM and HKU are available on remote machines.
    - FullKey  ROOTKEY\SubKey
    - ROOTKEY  [ HKLM | HKCU | HKCR | HKU | HKCC ]
      - SubKey   The full name of a registry key under the selected ROOTKEY.

- /v       The value name, under the selected Key, to add.
- /ve      adds an empty value name (Default) for the key.
- /t       RegKey data types
  -   [ REG_SZ | REG_MULTI_SZ | REG_EXPAND_SZ | REG_DWORD | REG_QWORD | REG_BINARY | REG_NONE ] If omitted, REG_SZ is assumed.
- /s       Specify one character that you use as the separator in your data string for REG_MULTI_SZ. If omitted, use "\0" as the separator.
- /d       The data to assign to the registry ValueName being added.
- /f       Force overwriting the existing registry entry without prompt.
- /reg:32  Specifies the key should be accessed using the 32-bit registry view.
- /reg:64  Specifies the key should be accessed using the 64-bit registry view.

Examples:

- `REG ADD \\ABC\HKLM\Software\MyCo` - Adds a key HKLM\Software\MyCo on remote machine ABC
- `REG ADD HKLM\Software\MyCo /v Data /t REG_BINARY /d fe340ead` - Adds a value (name: Data, type: REG_BINARY, data: fe340ead)
- `REG ADD HKLM\Software\MyCo /v MRU /t REG_MULTI_SZ /d fax\0mail` - Adds a value (name: MRU, type: REG_MULTI_SZ, data: fax\0mail\0\0)
- `REG ADD HKLM\Software\MyCo /v Path /t REG_EXPAND_SZ /d ^%systemroot^%` - Adds a value (name: Path, type: REG_EXPAND_SZ, data: %systemroot%)   Notice:  Use the caret symbol ( ^ ) inside the expand string


### Powercfg

Edit the power configuration settings

- `powercfg /list` - list the power profiles
- `powercfg /query` -display the current power settings.
- `powercfg /export C:\somefile.POW {GUID of profile}`
- `powercfg /change [option]`
monitor-timeout-ac
monitor-timeout-dc
disk-timeout-ac
disk-timeout-dc
standby-timeout-ac
standby-timeout-dc
hibernate-timeout-ac
hibernate-timeout-dc

### netsh

View the Windows Network Config Script:

This shows all the settings

```batch
netsh
>dump
```

### BCDEdit

#### Safemode

Re-allow the **F8** menu upon startup. May not work with Windows 10.

```batch
bcdedit /set {bootmgr} displaybootmenu yes
echo to turn off
bcdedit /set {bootmgr} displaybootmenu no
```

### WMIC Windows Management Instrumentation Console

`wmic diskdrive list brief`

### Takeown

`takeown /r /f c:\windows\csc`

### Diskpart

To make it stop trying to connect to a dead drive

```batch
diskpart
    automount disable
    automount scrub
```

### Services (sc)

See the [Streamline Windows Batch File](#Batch-File) for more examples?

```bat
sc start vmms
sc queryex eventlog vmms
```

### schtasks

Description: Enables an administrator to create, delete, query, change, run and end scheduled tasks on a local or remote system.

SCHTASKS /parameter [arguments]

Parameter List:
- /Create         Creates a new scheduled task.
- /Delete         Deletes the scheduled task(s).
- /Query          Displays all scheduled tasks.
- /Change         Changes the properties of scheduled task.
- /Run            Runs the scheduled task on demand.
- /End            Stops the currently running scheduled task.
- /ShowSid        Shows the security identifier corresponding to a scheduled task name.
- /?              Displays this help message.

Examples:
- SCHTASKS
- SCHTASKS /?
- SCHTASKS /Run /?
- SCHTASKS /End /?
- SCHTASKS /Create /?
- SCHTASKS /Delete /?
- SCHTASKS /Query  /?
- SCHTASKS /Change /?
- SCHTASKS /ShowSid /?

Just typing `schtasks` will list all the scheduled and disabled tasks.

See the [Streamline Windows Batch File](#Batch-File) for more examples?

### Install Windows Feature (WSL)

```powershell
Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
```

### Winrar

Program is contained in "C:\Program Files\WinRar\WinRAR.exe" usually

```batch
"C:\Program Files\WinRar\WinRAR.exe"
#To Add
cd d:\SaveDirectory
"C:\Program Files\WinRar\WinRAR.exe" a fileName.rar "D:\ASUSsync\VS Code\md\*

#Append date to filename with -ag
mkdir d:\asussync\backups\
"C:\Program Files\WinRar\WinRAR.exe" a -ag+YYMMDD "D:\ASUSsync\Backups\vsCodeBackUp.rar" "D:\ASUSsync\VS Code\md\*"  "D:\ASUSsync\ASUSVS-WorkSpace.code-workspace" "D:\ASUSsync\VS Code\.vscode\*"

#Using a file list and using version numbers and month string
"C:\Program Files\WinRar\WinRAR.exe" a -ag+YYMMM{v}nn-- -@+ "D:\ASUSsync\Backups\vsCodeBackUp.rar" @"D:\Asussync\backups\backups.txt"
```

### 7zip
 
 
 7z.exe a -t7z backup.7z -mx5 -m0=lzma2 -ms=200f -mmt=8
    "%inkscapePath%" --without-gui --file="%%cd%%\%%i" --export-png="%%cd%%\tmp\%%j\%%~ni-%%j.png" --export-dpi=%%j
    set /a innercount=innercount+1
7z a  \%fileName%.7z ".\*\*.png" -r -y -aoa -bse1 -bso0 -w".\tmp\" -m0=LZMAs=100f10m

-bsxy
comes in pairs x= (p - info, e- error, ? i forgot 3 debug maybe?) and y is 0 nowhere, 1 stdout 2 stderr the screen.

`-bse1 > Errorlog.txt` pipes out the error messages.
::-bse1 bs is redirect output and e is error and 1 is sted out
::-bso0 redirects standard output messages to 0 (off)

::setting methods is complicated af  

methods
:: this is supposed to be the method  -m0=LZMA2s=100f10m
s=100f10m = solid format 100files or 10 Mb
-mx(1-9) sets default strength from store to ultra eg -mx1

Another example `7z.exe a -t7z backup.7z -mx1 -m0=lzma2:d=1024m:fb=273 -ms=16g -mmt=24`
-mmt=# is number of cpu threads
-ms=16g is solid, break into 16gb, can use b,k,m,g and f for files.
fb is fast bytes (IDK)
d: is directory size.T
There is a ton more.

 -aoa - append and overwrite

 -y dont ask
 
 -r subfolders.

 -w".\tmp\" workign directory?

 format is always 7z. then command.  a for add.  then archive.  The rest can be allegely any order.  Its confusing as hell

### Converting SVG

[Inkscape Command Line](https://inkscape.org/doc/inkscape-man.html)

%inkscapePath%" --without-gui --file=".\%%i" --export-png=".\tmp\%%j\%DirN%\%%~ni-%%j.png" --export-dpi=%%j

See the batch script in scripts

### Verifier

`verifier` - Opens windows driver verifier.  Make sure to make a back up and be able to roll things back.

### Set

to set variablsand have things expand.  Ess. like temp env vars.

Set /A VarName = Expression, where expression is a string, number or math
Set /P VarName = The Prompt to ask user.

### Prompt 

Changes the prompt.  Lots of fun

Default is `$P$G>`. 

Uses this table:

- $A  `&`           (Ampersand) 
- $B  `|`           (pipe) 
- $C `(`           (Left parenthesis) 
- $D Current date 
- $E Escape code  (ASCII code 27) 
- $F  `)`           (Right parenthesis) 
- $G ` >`           (greater-than sign) 
- $H  Backspace   (erases previous character) 
- $L  `<`           (less-than sign) 
- $M  Display the remote name for Network drives
- $N  Current drive 
- $P  Current drive and path 
- $Q  `=`           (equal sign) 
- $S              (space) 
- $T  Current time 
- $V  Windows version number 
- $_  Carriage return and linefeed 
- `$$  $`           (dollar sign)
- $+  Will display plus signs (`+`) one for each level of the PUSHD directory stack
- 
### Fix DICOM Errors

!!!Important
Need [Grant, Revoke, Get DCOM permissions using PowerShell](https://gallery.technet.microsoft.com/Grant-Revoke-Get-DCOM-22da5b96)
It can be installed via ScriptBrowser

```powershell
cd "C:\Users\andyt\Documents\WindowsPowerShell\Scripts\Grant-Revoke-Get-DCOM-22da5b96\DCOMPermissions"
Import-Module .\DCOMPermissions.psm1
Grant-DComPermission -ApplicationID "{4839DDB7-58C2-48F5-8283-E1D1807D0D7D}" -Account "SYSTEM" -Type Launch -Permissions LocalLaunch,LocalActivation -OverrideConfigurationPermissions
```

### Shimgen

Using the .Net and Chocolatey Shimgen has been super useful.

First copy it from `%ChocolateyInstall%\tools` to `%ChocolateyInstall%\bin` so its on **PATH**.  (I cant remember if You need to add \bin to path or it comes that way?)  Anyway- Add `C:\ProgramData\Chocolatey\bin` to path.

Then run 

```batch
cd /d %ChocolateyInstall%\tools
copy shimgen.exe ..\bin
shimgen -o="kdiff.exe" -p="..\..\..\Program Files\Kdiff3\Kdiff3.exe" -i=".\kdiff3.exe" --gui
```

Somehow shimgen knows to put things in Chocolatey\bin, so paths are relative to that.  Even attempting to put it in another folder fails- by explicitly setting output.  Will work fine like this though  You hae to generate a a relative path from the `C:\ProgramData\Chocolatey\bin` back to the file.

## Other Notes

### File Explorer

Useful Categories to Add:
Type first
Name
Size
File Description
Product Name
Company

- Date Acceessed
- Content created
- Date Modified
- Owner

THen at the top- View -Options - Set to all Folders of that type'

In Windows


### Correct Selection

1. While on your desktop or in File Explorer, select one or more items you want to create shortcuts for.  Press and hold the Alt or Ctrl+Shift keys, drag and drop the selected item(s) to where you want to create the shortcut(s) at, and release the Alt or Ctrl+Shift keys. 

When you are moving things you should right click in the destination or right click driag. 

## Registry Changes

Syntax of .Reg Files
A .reg file has the following syntax:

```txt
RegistryEditorVersion
Blank line
[RegistryPath1]

"DataItemName1"="DataType1:DataValue1"
DataItemName2"="DataType2:DataValue2"
Blank line
[RegistryPath2]

"DataItemName3"="DataType3:DataValue3"
```

where:

`RegistryEditorVersion` is either `"Windows Registry Editor Version 5.00"` for Windows 2000, Windows XP, and Windows Server 2003, or `"REGEDIT4"` for Windows 98 and Windows NT 4.0. The "REGEDIT4" header also works on Windows 2000-based, Windows XP-based, and Windows Server 2003-based computers.

Blank line is a blank line. This identifies the start of a new registry path. Each key or subkey is a new registry path. If you have several keys in your .reg file, blank lines can help you to examine and to troubleshoot the contents.
RegistryPathx is the path of the subkey that holds the first value you are importing. Enclose the path in square brackets, and separate each level of the hierarchy by a backslash. For example:
[HKEY_LOCAL_ MACHINE\SOFTWARE\Policies\Microsoft\Windows\System]
A .reg file can contain several registry paths. If the bottom of the hierarchy in the path statement does not exist in the registry, a new subkey is created. The contents of the registry files are sent to the registry in the order you enter them. Therefore, if you want to create a new subkey with another subkey below it, you must enter the lines in the correct order.

DataItemNamex is the name of the data item that you want to import. If a data item in your file does not exist in the registry, the .reg file adds it (with the value of the data item). If a data item does exist, the value in your .reg file overwrites the existing value. Quotation marks enclose the name of the data item. An equal sign (=) immediately follows the name of the data item.

DataTypex is the data type for the registry value and immediately follows the equal sign. For all the data types other than REG_SZ (a string value), a colon immediately follows the data type. If the data type is REG_SZ , do not include the data type value or colon. In this case, Regedit.exe assumes REG_SZ for the data type. The following table lists the typical registry data types:

- REG_BINARY - hexadecimal
- REG_DWORD - dword
- REG_EXPAND_SZ - hexadecimal(2)
- REG_MULTI_SZ - hexadecimal(7)

### Adding Registry Subkeys or Adding and Changing Registry Values

To add a registry subkey or add or change a registry value, make the appropriate changes in the registry, and then export the appropriate subkey or subkeys. Exported registry subkeys are automatically saved as .reg files. To make changes to the registry and export your changes to a .reg file, follow these steps:

1. Click Start, click Run, type regedit in the Open box, and then click OK.
2. Locate and then click the subkey that holds the registry item or items that you want to change.
3. Click File, and then click Export.

This step backs up the subkey before you make any changes. You can import this file back into the registry later if your changes cause a problem. In the File name box, type a file name to use to save the .reg file with the original registry items, and then click Save.

!!!Note Use a file name that reminds you of the contents, such as a reference to the name of the subkey.
In the right pane, add or modify the registry items you want.
Repeat steps 3 and 4 to export the subkey again, but use a different file name for the .reg file. You can use this .reg file to make your registry changes on another computer.
Test your changes on the local computer. If they cause a problem, double-click the file that holds the backup of the original registry data to return the registry to its original state. If the changes work as expected, you can distribute the .reg you created in step 6 to other computers by using the methods in the "Distributing Registry Changes" section of this article.

### Deleting Registry Keys and Values

To delete a registry key with a .reg file, put a hyphen (-) in front of the RegistryPath in the .reg file. For example, to delete the Test subkey from the following registry key:
`HKEY_LOCAL_MACHINE\Software`
put a hyphen in front of the following registry key in the .reg file:
`HKEY_LOCAL_MACHINE\Software\Test`
The following example has a .reg file that can perform this task.
`[-HKEY_LOCAL_MACHINE\Software\Test]`
To delete a registry value with a .reg file, put a hyphen (-) after the equals sign following the DataItemName in the .reg file. For example, to delete the TestValue registry value from the following registry key:
`HKEY_LOCAL_MACHINE\Software\Test`
put a hyphen after the "TestValue"= in the .reg file. The following example has a .reg file that can perform this task.
`HKEY_LOCAL_MACHINE\Software\Test`

`"TestValue"=-`
To create the .reg file, use Regedit.exe to export the registry key that you want to delete, and then use Notepad to edit the .reg file and insert the hyphen.

Renaming Registry Keys and Values
To rename a key or value, delete the key or value, and then create a new key or value with the new name.

### Setting Explorer to My PC not Quick Access

```batch
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "LaunchTo" /t REG_DWORD /d 1 /f
```


### Batch Examples

```batch
@echo off
Setlocal EnableDelayedExpansion
:: strLen String [RtnVar]
::             -- String  The string to be measured, surround in quotes if it contains spaces.
::             -- RtnVar  An optional variable to be used to return the string length.
Set "s=#%~1"
Set "len=0"
For %%N in (4096 2048 1024 512 256 128 64 32 16 8 4 2 1) do (
  if "!s:~%%N,1!" neq "" (
    set /a "len+=%%N"
    set "s=!s:~%%N!"
  )
)
Endlocal&if "%~2" neq "" (set %~2=%len%) else echo %len%
Exit /b

::Exaple Calling
@Echo off
Setlocal
Set _demo="hello world"
Call strLen.cmd %_demo%
```

## Useful Microsoft Addons

[Microsoft Assessment and Deployment Toolkit](https://docs.microsoft.com/en-us/windows-hardware/get-started/adk-install)

[Microsoft Software Development Kit]()

[Microsoft Debugging Tools](https://docs.microsoft.com/en-us/windows-hardware/drivers/debugger/debugger-download-tools)

[Windows Driver Kit (WDK)](https://docs.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk)

[Windows Hardware Kit WHK](https://docs.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk)

Microsoft Messaging

Microsoft Network TMonitor

Microsoft Message Analyzer

## MSI Executables

For example: `msiexec /a "C:\users\altimmons\downloads\python-2.7.15.amd64.msi" /lemox "./temp.txt"`

The above command says using msiexec (windows installer), run as an admin `/a` this file, `/l` log it, and in the log put- I dont remember all the other letters e is errors. x is more info I think. Save it in the local directory `./temp.txt`.

you can say program /? for more info

## Network

### Proxy Management

? Cntlm: Fast NTLM Authentication Proxy in C - not sure if this is part of the work computer or if I installed this...

### FireWall

Enable Remote desktop related rules.  Unclear which these are.

### Reserved IPs

#### IPv4

[Source](https://en.wikipedia.org/wiki/Reserved_IP_addresses)

- `Address block`- Address range
- `------------------`- ---------------------------
- `0.0.0.0/8`- 0.0.0.0–0.255.255.255
- `10.0.0.0/8`- 10.0.0.0–10.255.255.255
- `100.64.0.0/10`- 100.64.0.0–100.127.255.255
- `127.0.0.0/8`- 127.0.0.0–127.255.255.255
- `169.254.0.0/16`- 169.254.0.0–169.254.255.255
- `172.16.0.0/12`- 172.16.0.0–172.31.255.255
- `192.0.0.0/24`- 192.0.0.0–192.0.0.255
- `192.0.2.0/24`- 192.0.2.0–192.0.2.255
- `192.88.99.0/24`- 192.88.99.0–192.88.99.255
| 192.168.0.0/16     | 192.168.0.0–192.168.255.255 | 65536               | Private network | Used for local communications within a private network.                                                                |
| 198.18.0.0/15      | 198.18.0.0–198.19.255.255   | 131072              | Private network | Used for benchmark testing of inter-network communications between two separate subnets.                               |
| 198.51.100.0/24    | 198.51.100.0–198.51.100.255 | 256                 | Documentation   | Assigned as TEST-NET-2, documentation and examples.                                                                    |
| 203.0.113.0/24     | 203.0.113.0–203.0.113.255   | 256                 | Documentation   | Assigned as TEST-NET-3, documentation and examples.                                                                    |
| 224.0.0.0/4        | 224.0.0.0–239.255.255.255   | 268435456           | Internet        | In use for IP multicast. (Former Class D network).                                                                     |
| 240.0.0.0/4        | 240.0.0.0–255.255.255.254   | 268435456           | Internet        | Reserved for future use. (Former Class E network).                                                                     |
| 255.255.255.255/32 | 255.255.255.255             | 1                   | Subnet          | Reserved for the "limited broadcast" destination address.                                                              |

such as would have normally been retrieved from a DHCP server. 

#### IPV6

| Address block (CIDR) | First address   | Last address     | Number of addresses                     | Usage         | Purpose         |                                                          |
| -------------------- | --------------- | ---------------- | --------------------------------------- | ------------- | --------------- | -------------------------------------------------------- |
|                      | ::/0            | ::               | ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff | 2128          | Routing         | Default route.                                           |
|                      | ::/128          | ::               |                                         | 1             | Software        | Unspecified address.                                     |
|                      | ::1/128         | ::1              |                                         | 1             | Host            | Loopback address to the local host.                      |
|                      | ::ffff:0:0/96   | ::ffff:0.0.0.0   | ::ffff:255.255.255.255                  | 2128−96 = 232 | Software        | IPv4 mapped addresses.                                   |
|                      | ::ffff:0:0:0/96 | ::ffff:0:0.0.0.0 | ::ffff:0:255.255.255.255                | 232           | Software        | IPv4 translated addresses.                               |
|                      | 64:ff9b::/96    | 64:ff9b::0.0.0.0 | 64:ff9b::255.255.255.255                | 232           | Global Internet | IPv4/IPv6 translation.                                   |
|                      | 100::/64        | 100::            | 100::ffff:ffff:ffff:ffff                | 264           | Routing         | Discard prefix.                                          |
|                      | 2001::/32       | 2001::           | 2001::ffff:ffff:ffff:ffff:ffff:ffff     | 296           | Global Internet | Teredo tunneling.                                        |
|                      | 2001:20::/28    | 2001:20::        | 2001:2f:ffff:ffff:ffff:ffff:ffff:ffff   | 2100          | Software        | ORCHIDv2.                                                |
|                      | 2001:db8::/32   | 2001:db8::       | 2001:db8:ffff:ffff:ffff:ffff:ffff:ffff  | 296           | Documentation   | Addresses used in documentation and example source code. |
|                      | 2002::/16       | 2002::           | 2002:ffff:ffff:ffff:ffff:ffff:ffff:ffff | 2112          | Global Internet | The 6to4 addressing scheme (now deprecated).             |
|                      | fc00::/7        | fc00::           | fdff:ffff:ffff:ffff:ffff:ffff:ffff:ffff | 2121          | Private network | Unique local address.                                    |
|                      | fe80::/10       | fe80::           | febf:ffff:ffff:ffff:ffff:ffff:ffff:ffff | 2118          | Link            | Link-local address.                                      |
|                      | ff00::/8        | ff00::           | ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff | 2120          | Global Internet | Multicast address.                                       |


## Setup Git

First setup basics

```bash
git config --global user.name "altimmons"
git config --global user.email "A.L.Timmons@gmail.com"
```

Then generate an SSH key to upload to github

```
ssh-keygen -t rsa -C "A.L.Timmons@gmail.com"
```

This is best done with wsl

 7dfc369ea46474e9a0d8131d6c247c3229cfe58f

`git show :.gitignore`

git checkout master

git commit

## Streamline Windows

This is the source of two separate packages:

- [Debloat Windows 10](https://github.com/W4RH4WK/Debloat-Windows-10)
- [Remove-Windows10-Bloat.bat](https://gist.githubusercontent.com/matthewjberger/2f4295887d6cb5738fa34e597f457b7f/raw/b23fa065febed8a2d7c2f030fba6da381f640997/Remove-Windows10-Bloat.bat)

### Batch File

```batch
@rem *** Disable Some Service ***
sc stop DiagTrack
sc stop diagnosticshub.standardcollector.service
sc stop dmwappushservice
sc stop WMPNetworkSvc
sc stop WSearch

sc config DiagTrack start= disabled
sc config diagnosticshub.standardcollector.service start= disabled
sc config dmwappushservice start= disabled
REM sc config RemoteRegistry start= disabled
REM sc config TrkWks start= disabled
sc config WMPNetworkSvc start= disabled
sc config WSearch start= disabled
REM sc config SysMain start= disabled

REM *** SCHEDULED TASKS tweaks ***
REM schtasks /Change /TN "Microsoft\Windows\AppID\SmartScreenSpecific" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\Microsoft Compatibility Appraiser" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\ProgramDataUpdater" /Disable
schtasks /Change /TN "Microsoft\Windows\Application Experience\StartupAppTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\Consolidator" /Disable
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\KernelCeipTask" /Disable
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\UsbCeip" /Disable
schtasks /Change /TN "Microsoft\Windows\Customer Experience Improvement Program\Uploader" /Disable
schtasks /Change /TN "Microsoft\Windows\Shell\FamilySafetyUpload" /Disable
schtasks /Change /TN "Microsoft\Office\OfficeTelemetryAgentLogOn" /Disable
schtasks /Change /TN "Microsoft\Office\OfficeTelemetryAgentFallBack" /Disable
schtasks /Change /TN "Microsoft\Office\Office 15 Subscription Heartbeat" /Disable

REM schtasks /Change /TN "Microsoft\Windows\Autochk\Proxy" /Disable
REM schtasks /Change /TN "Microsoft\Windows\CloudExperienceHost\CreateObjectTask" /Disable
REM schtasks /Change /TN "Microsoft\Windows\DiskDiagnostic\Microsoft-Windows-DiskDiagnosticDataCollector" /Disable
REM schtasks /Change /TN "Microsoft\Windows\DiskFootprint\Diagnostics" /Disable *** Not sure if should be disabled, maybe related to S.M.A.R.T.
REM schtasks /Change /TN "Microsoft\Windows\FileHistory\File History (maintenance mode)" /Disable
REM schtasks /Change /TN "Microsoft\Windows\Maintenance\WinSAT" /Disable
REM schtasks /Change /TN "Microsoft\Windows\NetTrace\GatherNetworkInfo" /Disable
REM schtasks /Change /TN "Microsoft\Windows\PI\Sqm-Tasks" /Disable
REM The stubborn task Microsoft\Windows\SettingSync\BackgroundUploadTask can be Disabled using a simple bit change. I use a REG file for that (attached to this post).
REM schtasks /Change /TN "Microsoft\Windows\Time Synchronization\ForceSynchronizeTime" /Disable
REM schtasks /Change /TN "Microsoft\Windows\Time Synchronization\SynchronizeTime" /Disable
REM schtasks /Change /TN "Microsoft\Windows\Windows Error Reporting\QueueReporting" /Disable
REM schtasks /Change /TN "Microsoft\Windows\WindowsUpdate\Automatic App Update" /Disable


@rem *** Remove Telemetry & Data Collection ***
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Device Metadata" /v PreventDeviceMetadataFromNetwork /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\MRT" /v DontOfferThroughWUAU /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\SQMClient\Windows" /v "CEIPEnable" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "AITEnable" /t REG_DWORD /d 0 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\AppCompat" /v "DisableUAR" /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Policies\Microsoft\Windows\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\AutoLogger\AutoLogger-Diagtrack-Listener" /v "Start" /t REG_DWORD /d 0 /f
reg add "HKLM\SYSTEM\CurrentControlSet\Control\WMI\AutoLogger\SQMLogger" /v "Start" /t REG_DWORD /d 0 /f

@REM Settings -> Privacy -> General -> Let apps use my advertising ID...
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AdvertisingInfo" /v Enabled /t REG_DWORD /d 0 /f
REM - SmartScreen Filter for Store Apps: Disable
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\AppHost" /v EnableWebContentEvaluation /t REG_DWORD /d 0 /f
REM - Let websites provide locally...
reg add "HKCU\Control Panel\International\User Profile" /v HttpAcceptLanguageOptOut /t REG_DWORD /d 1 /f

@REM WiFi Sense: HotSpot Sharing: Disable
reg add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowWiFiHotSpotReporting" /v value /t REG_DWORD /d 0 /f
@REM WiFi Sense: Shared HotSpot Auto-Connect: Disable
reg add "HKLM\Software\Microsoft\PolicyManager\default\WiFi\AllowAutoConnectToWiFiSenseHotspots" /v value /t REG_DWORD /d 0 /f

@REM Change Windows Updates to "Notify to schedule restart"
reg add "HKLM\SOFTWARE\Microsoft\WindowsUpdate\UX\Settings" /v UxOption /t REG_DWORD /d 1 /f
@REM Disable P2P Update downlods outside of local network
reg add "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\DeliveryOptimization\Config" /v DODownloadMode /t REG_DWORD /d 0 /f


REM *** Hide the search box from taskbar. You can still search by pressing the Win key and start typing what you're looking for ***
REM 0 = hide completely, 1 = show only icon, 2 = show long search box
reg add "HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Search" /v "SearchboxTaskbarMode" /t REG_DWORD /d 0 /f

REM *** Disable MRU lists (jump lists) of XAML apps in Start Menu ***
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Start_TrackDocs" /t REG_DWORD /d 0 /f

REM *** Set Windows Explorer to start on This PC instead of Quick Access ***
REM 1 = This PC, 2 = Quick access
REM reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "LaunchTo" /t REG_DWORD /d 1 /f

@rem Remove Apps
PowerShell -Command "Get-AppxPackage *3DBuilder* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *Getstarted* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *WindowsAlarms* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *WindowsCamera* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *bing* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *MicrosoftOfficeHub* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *OneNote* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *people* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *WindowsPhone* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *photos* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *SkypeApp* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *solit* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *WindowsSoundRecorder* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *windowscommunicationsapps* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *zune* | Remove-AppxPackage"
REM PowerShell -Command "Get-AppxPackage *WindowsCalculator* | Remove-AppxPackage"
REM PowerShell -Command "Get-AppxPackage *WindowsMaps* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *Sway* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *CommsPhone* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *ConnectivityStore* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *Microsoft.Messaging* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *Facebook* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *Twitter* | Remove-AppxPackage"
PowerShell -Command "Get-AppxPackage *Drawboard PDF* | Remove-AppxPackage"


@rem NOW JUST SOME TWEAKS
REM *** Show hidden files in Explorer ***
REM reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "Hidden" /t REG_DWORD /d 1 /f

REM *** Show super hidden system files in Explorer ***
REM reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "ShowSuperHidden" /t REG_DWORD /d 1 /f

REM *** Show file extensions in Explorer ***
reg add "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced" /v "HideFileExt" /t  REG_DWORD /d 0 /f



REM *** Uninstall OneDrive ***
start /wait "" "%SYSTEMROOT%\SYSWOW64\ONEDRIVESETUP.EXE" /UNINSTALL
rd C:\OneDriveTemp /Q /S >NUL 2>&1
rd "%USERPROFILE%\OneDrive" /Q /S >NUL 2>&1
rd "%LOCALAPPDATA%\Microsoft\OneDrive" /Q /S >NUL 2>&1
rd "%PROGRAMDATA%\Microsoft OneDrive" /Q /S >NUL 2>&1
reg add "HKEY_CLASSES_ROOT\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}\ShellFolder" /f /v Attributes /t REG_DWORD /d 0 >NUL 2>&1
reg add "HKEY_CLASSES_ROOT\Wow6432Node\CLSID\{018D5C66-4533-4307-9B53-224DE2ED1FE6}\ShellFolder" /f /v Attributes /t REG_DWORD /d 0 >NUL 2>&1
echo OneDrive has been removed. Windows Explorer needs to be restarted.
pause
start /wait TASKKILL /F /IM explorer.exe
start explorer.exe
```

### PowerShell Files

```ps1
#force-mkdir
function force-mkdir($path) {
    if (!(Test-Path $path)) {
        #Write-Host "-- Creating full path to: " $path -ForegroundColor White -BackgroundColor DarkGreen
        New-Item -ItemType Directory -Force -Path $path
    }
}
```

```ps1
function Takeown-Registry($key) {
    # TODO does not work for all root keys yet
    switch ($key.split('\')[0]) {
        "HKEY_CLASSES_ROOT" {
            $reg = [Microsoft.Win32.Registry]::ClassesRoot
            $key = $key.substring(18)
        }
        "HKEY_CURRENT_USER" {
            $reg = [Microsoft.Win32.Registry]::CurrentUser
            $key = $key.substring(18)
        }
        "HKEY_LOCAL_MACHINE" {
            $reg = [Microsoft.Win32.Registry]::LocalMachine
            $key = $key.substring(19)
        }
    }

    # get administraor group
    $admins = New-Object System.Security.Principal.SecurityIdentifier("S-1-5-32-544")
    $admins = $admins.Translate([System.Security.Principal.NTAccount])

    # set owner
    $key = $reg.OpenSubKey($key, "ReadWriteSubTree", "TakeOwnership")
    $acl = $key.GetAccessControl()
    $acl.SetOwner($admins)
    $key.SetAccessControl($acl)

    # set FullControl
    $acl = $key.GetAccessControl()
    $rule = New-Object System.Security.AccessControl.RegistryAccessRule($admins, "FullControl", "Allow")
    $acl.SetAccessRule($rule)
    $key.SetAccessControl($acl)
}

function Takeown-File($path) {
    takeown.exe /A /F $path
    $acl = Get-Acl $path

    # get administraor group
    $admins = New-Object System.Security.Principal.SecurityIdentifier("S-1-5-32-544")
    $admins = $admins.Translate([System.Security.Principal.NTAccount])

    # add NT Authority\SYSTEM
    $rule = New-Object System.Security.AccessControl.FileSystemAccessRule($admins, "FullControl", "None", "None", "Allow")
    $acl.AddAccessRule($rule)

    Set-Acl -Path $path -AclObject $acl
}

function Takeown-Folder($path) {
    Takeown-File $path
    foreach ($item in Get-ChildItem $path) {
        if (Test-Path $item -PathType Container) {
            Takeown-Folder $item.FullName
        } else {
            Takeown-File $item.FullName
        }
    }
}

function Elevate-Privileges {
    param($Privilege)
    $Definition = @"
    using System;
    using System.Runtime.InteropServices;

    public class AdjPriv {
        [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
            internal static extern bool AdjustTokenPrivileges(IntPtr htok, bool disall, ref TokPriv1Luid newst, int len, IntPtr prev, IntPtr rele);

        [DllImport("advapi32.dll", ExactSpelling = true, SetLastError = true)]
            internal static extern bool OpenProcessToken(IntPtr h, int acc, ref IntPtr phtok);

        [DllImport("advapi32.dll", SetLastError = true)]
            internal static extern bool LookupPrivilegeValue(string host, string name, ref long pluid);

        [StructLayout(LayoutKind.Sequential, Pack = 1)]
            internal struct TokPriv1Luid {
                public int Count;
                public long Luid;
                public int Attr;
            }

        internal const int SE_PRIVILEGE_ENABLED = 0x00000002;
        internal const int TOKEN_QUERY = 0x00000008;
        internal const int TOKEN_ADJUST_PRIVILEGES = 0x00000020;

        public static bool EnablePrivilege(long processHandle, string privilege) {
            bool retVal;
            TokPriv1Luid tp;
            IntPtr hproc = new IntPtr(processHandle);
            IntPtr htok = IntPtr.Zero;
            retVal = OpenProcessToken(hproc, TOKEN_ADJUST_PRIVILEGES | TOKEN_QUERY, ref htok);
            tp.Count = 1;
            tp.Luid = 0;
            tp.Attr = SE_PRIVILEGE_ENABLED;
            retVal = LookupPrivilegeValue(null, privilege, ref tp.Luid);
            retVal = AdjustTokenPrivileges(htok, false, ref tp, 0, IntPtr.Zero, IntPtr.Zero);
            return retVal;
        }
    }
"@
    $ProcessHandle = (Get-Process -id $pid).Handle
    $type = Add-Type $definition -PassThru
    $type[0]::EnablePrivilege($processHandle, $Privilege)
}
```

block-telemetry.ps1
